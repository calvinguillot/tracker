import{l as e,m as d,n as r,t as a}from"./DXU5jnQ_.js";import{s as l}from"./BW5xtwr9.js";class k{#t=e(d([]));get tasks(){return r(this.#t)}set tasks(t){a(this.#t,t,!0)}#i=e(d([]));get dailyTracking(){return r(this.#i)}set dailyTracking(t){a(this.#i,t,!0)}#s=e(d([]));get projects(){return r(this.#s)}set projects(t){a(this.#s,t,!0)}#e=e(d([]));get notes(){return r(this.#e)}set notes(t){a(this.#e,t,!0)}#r=e(d([]));get artCalls(){return r(this.#r)}set artCalls(t){a(this.#r,t,!0)}#a=e(!0);get isLoading(){return r(this.#a)}set isLoading(t){a(this.#a,t,!0)}#n=e(!1);get isInitialized(){return r(this.#n)}set isInitialized(t){a(this.#n,t,!0)}initPromise=null;constructor(){}reset(){this.tasks=[],this.dailyTracking=[],this.projects=[],this.notes=[],this.artCalls=[],this.isLoading=!0,this.isInitialized=!1,this.initPromise=null}async init(){if(!this.isInitialized){if(this.initPromise)return this.initPromise;this.initPromise=this._doInit();try{await this.initPromise}finally{this.initPromise=null}}}async _doInit(){this.isLoading=!0;const[{data:t,error:i},{data:s,error:n},{data:o,error:h},{data:c,error:f},{data:g,error:u}]=await Promise.all([l.from("tasks").select("*").order("deadline_at",{ascending:!0}),l.from("dailyTracking").select("*").order("created_at",{ascending:!1}),l.from("projects").select("*").order("created_at",{ascending:!1}),l.from("notes").select("*").order("created_at",{ascending:!1}),l.from("artCalls").select("*").order("deadline",{ascending:!0})]);t&&(this.tasks=t),i&&console.error("Error fetching tasks:",i),s&&(this.dailyTracking=s),n&&console.error("Error fetching dailyTracking:",n),o&&(this.projects=o),h&&console.error("Error fetching projects:",h),c&&(this.notes=c),f&&console.error("Error fetching notes:",f),g&&(this.artCalls=g),u&&console.error("Error fetching artCalls:",u),this.isLoading=!1,this.isInitialized=!0}addTask(t){this.tasks.push(t),this.tasks.sort((i,s)=>{const n=i.deadline_at?new Date(i.deadline_at).getTime():1/0,o=s.deadline_at?new Date(s.deadline_at).getTime():1/0;return n-o})}updateTask(t){const i=this.tasks.findIndex(s=>s.id===t.id);i!==-1&&(this.tasks[i]=t)}deleteTask(t){this.tasks=this.tasks.filter(i=>i.id!==t)}addDailyEntry(t){this.dailyTracking=[t,...this.dailyTracking]}updateDailyEntry(t){const i=this.dailyTracking.findIndex(s=>s.id===t.id);i!==-1&&(this.dailyTracking[i]=t)}deleteDailyEntry(t){this.dailyTracking=this.dailyTracking.filter(i=>i.id!==t)}addProject(t){this.projects=[t,...this.projects]}updateProject(t){const i=this.projects.findIndex(s=>s.id===t.id);i!==-1&&(this.projects[i]=t)}deleteProject(t){this.projects=this.projects.filter(i=>i.id!==t)}addNote(t){this.notes=[t,...this.notes]}updateNote(t){const i=this.notes.findIndex(s=>s.id===t.id);i!==-1&&(this.notes[i]=t)}deleteNote(t){this.notes=this.notes.filter(i=>i.id!==t)}addArtCall(t){this.artCalls.push(t),this.artCalls.sort((i,s)=>{const n=new Date(i.deadline).getTime(),o=new Date(s.deadline).getTime();return n-o})}updateArtCall(t){const i=this.artCalls.findIndex(s=>s.id===t.id);i!==-1&&(this.artCalls[i]=t)}deleteArtCall(t){this.artCalls=this.artCalls.filter(i=>i.id!==t)}}const T=new k;export{T as d};
