import{b as ye,d as Re,c as se,a as b,f as w}from"../chunks/7NWlc7Su.js";import{D as A,h as ze,b as ke,W as qe,X as Fe,i as Ce,C as Pe,e as Ie,Y as Ye,Z as Ke,f as Ve,g as ae,p as Ne,v as k,w as Ae,x as We,y as l,k as B,a as Se,z as a,A as o,B as n,F as Xe,m as t,o as Ze,I as Ee}from"../chunks/BVFz32Il.js";import{d as Me,s as Q,e as Ge}from"../chunks/pKnFB2my.js";import{i as C}from"../chunks/Ds4RlZDk.js";import{e as _e,s as ie,i as he}from"../chunks/CP7c8dVT.js";import{r as De,g as Je,a as H,d as O,e as Qe,L as Ue,f as $e,c as et}from"../chunks/RPGm4AHo.js";import{s as T}from"../chunks/BW5xtwr9.js";import{t as tt,f as rt}from"../chunks/DbLlv7u-.js";import{b as ge,P as ot}from"../chunks/CX8rbiYm.js";import{A as at}from"../chunks/D9mXmw9u.js";import{A as st}from"../chunks/CgHzHeUi.js";function it(L,c,i=!1,x=!1,E=!1){var g=L,_="";A(()=>{var h=qe;if(_===(_=c()??"")){ze&&ke();return}if(h.nodes!==null&&(Fe(h.nodes.start,h.nodes.end),h.nodes=null),_!==""){if(ze){Ce.data;for(var d=ke(),u=d;d!==null&&(d.nodeType!==Pe||d.data!=="");)u=d,d=Ie(d);if(d===null)throw Ye(),Ke;ye(Ce,u),g=Ve(d);return}var m=_+"";i?m=`<svg>${m}</svg>`:x&&(m=`<math>${m}</math>`);var v=Re(m);if((i||x)&&(v=ae(v)),ye(ae(v),v.lastChild),i||x)for(;ae(v);)g.before(ae(v));else g.before(v)}})}var nt=w('<button type="button" class="h-8 w-8 rounded-full border border-zinc-700 transition-transform hover:scale-110 focus:ring-2 focus:ring-zinc-400 focus:outline-none"></button>'),lt=w('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/70 p-2 backdrop-blur-sm md:p-4" role="dialog" aria-modal="true" tabindex="-1"><div class="flex max-h-[95vh] w-full max-w-2xl flex-col overflow-y-auto rounded-xl border border-zinc-800 bg-zinc-900 shadow-xl md:max-h-[90vh]"><div class="sticky top-0 z-10 flex items-center justify-between border-b border-zinc-800 bg-zinc-900 p-4 md:p-6"><h2 class="text-xl font-bold text-zinc-100"> </h2> <button class="text-zinc-400 transition-colors hover:text-zinc-200" aria-label="Close"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <form class="space-y-6 p-4 md:p-6"><div><label for="title" class="mb-1 block text-sm font-medium text-zinc-400">Title</label> <input type="text" id="title" required class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"/></div> <div><label for="body" class="mb-1 block text-sm font-medium text-zinc-400">Body</label> <textarea id="body" rows="10" class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"></textarea></div> <div><label for="color" class="mb-1 block text-sm font-medium text-zinc-400">Color</label> <div class="flex flex-wrap gap-2"></div> <input type="hidden" name="color"/></div> <div class="sticky bottom-0 mt-6 flex justify-end gap-3 border-t border-zinc-800 bg-zinc-900 pt-4"><button type="button" class="rounded-md bg-zinc-800 px-3.5 py-2.5 text-sm font-semibold text-zinc-200 shadow-sm ring-1 ring-zinc-700 ring-inset hover:bg-zinc-700">Cancel</button> <button type="submit" class="rounded-md px-3.5 py-2.5 text-sm font-semibold text-white shadow-sm transition-all hover:brightness-110 focus-visible:outline-2 focus-visible:outline-offset-2">Save</button></div></form></div></div>');function ct(L,c){Ne(c,!0);let i=k(Ae({title:"",body:"",color:"#18181b"}));We(()=>{c.isOpen&&(c.entry?l(i,{title:c.entry.title||"",body:c.entry.body||"",color:c.entry.color||"#18181b"},!0):l(i,{title:"",body:"",color:"#18181b"},!0))});function x(u){u.preventDefault(),c.onSave(t(i))}function E(u){u.target===u.currentTarget&&c.onClose()}function g(u){u.key==="Escape"&&c.onClose()}var _=se(),h=B(_);{var d=u=>{var m=lt();m.__click=E,m.__keydown=g;var v=a(m),R=a(v),q=a(R),ne=a(q,!0);o(q);var le=n(q,2);le.__click=function(...e){c.onClose?.apply(this,e)},o(R);var F=n(R,2),P=a(F),I=n(a(P),2);De(I),o(P);var S=n(P,2),Y=n(a(S),2);Xe(Y),o(S);var D=n(S,2),K=n(a(D),2);_e(K,21,()=>H.settings.notes_types,he,(e,r)=>{var s=nt();s.__click=()=>t(i).color=t(r).color??"#18181b",A(()=>{ie(s,`background-color: ${t(r).color??""}; ${t(i).color===t(r).color?"border-color: white; transform: scale(1.1);":""}`),Je(s,"aria-label",`Select color ${t(r).color??""}`)}),b(e,s)}),o(K);var U=n(K,2);De(U),o(D);var $=n(D,2),ee=a($);ee.__click=function(...e){c.onClose?.apply(this,e)};var ce=n(ee,2);o($),o(F),o(v),o(m),A(e=>{Q(ne,c.entry?"Edit Note":"New Note"),ie(ce,`background-color: ${e??""}`)},[()=>H.getAccentHex()]),Ge("submit",F,x),ge(I,()=>t(i).title,e=>t(i).title=e),ge(Y,()=>t(i).body,e=>t(i).body=e),ge(U,()=>t(i).color,e=>t(i).color=e),tt(3,m,()=>rt,()=>({duration:H.getTransitionDuration()})),b(u,m)};C(h,u=>{c.isOpen&&u(d)})}b(L,_),Se()}Me(["click","keydown"]);var dt=w('<button class="fixed right-8 bottom-8 z-50 rounded-full p-4 shadow-lg/30 drop-shadow-lg backdrop-blur-md transition-all hover:scale-105 hover:brightness-110 md:right-16 md:bottom-16" aria-label="New Note"><!></button>'),vt=w('<div class="flex h-48 items-center justify-center"><!></div>'),ut=w('<div class="rounded-lg border border-zinc-800 bg-zinc-900/60 p-6 text-zinc-400">Sign in to view notes.</div>'),ft=w('<div class="rounded-lg border border-zinc-800 bg-zinc-900/60 p-6 text-zinc-400">No notes yet.</div>'),bt=w('<button><span class="capitalize"> </span> <!></button>'),mt=w('<div class="prose prose-sm max-w-none wrap-break-word text-zinc-300 prose-invert"><!></div>'),gt=w('<li class="group relative flex flex-col gap-4 rounded-lg border border-zinc-800 p-4 transition-all hover:border-zinc-700 hover:shadow-lg"><div class="flex flex-col gap-3"><h3 class="wrap-break-words text-lg font-bold text-zinc-100"> </h3> <!></div> <div class="mt-auto flex items-center justify-between gap-4 border-t border-zinc-800/50 pt-3"><div class="text-xs text-zinc-400/70"> </div> <div class="flex items-center gap-2"><button class="rounded-md p-2 text-indigo-400 transition-colors hover:bg-black/20 hover:text-indigo-300" aria-label="Edit"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg></button> <button class="rounded-md p-2 text-red-400 transition-colors hover:bg-black/20 hover:text-red-300" aria-label="Delete"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg></button></div></div></li>'),_t=w('<div class="mb-4 flex flex-wrap items-center gap-4 text-sm"><span class="text-zinc-500">Sort by:</span> <!> <span class="ml-auto text-xs text-zinc-500"> </span></div> <ul class="grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3"></ul>',1),ht=w('<!> <section class="space-y-6"><div class="flex flex-wrap items-center justify-between gap-4"><h2 class="hidden text-lg font-bold text-zinc-100 md:block">Notes</h2> <!></div> <!></section>',1);function St(L,c){Ne(c,!0);let i=k(null),x=k(!0),E=k(Ae([])),g=k(!1),_=k(null),h=k("created"),d=k("desc"),u=Ee(()=>[...t(E)].sort((e,r)=>{const s=t(d)==="asc"?1:-1;if(t(h)==="title")return(e.title||"").localeCompare(r.title||"")*s;if(t(h)==="created"){const f=new Date(e.created_at).getTime(),V=new Date(r.created_at).getTime();return(f-V)*s}return 0}));function m(e){t(h)===e?l(d,t(d)==="asc"?"desc":"asc",!0):(l(h,e,!0),l(d,"desc"))}Ze(()=>{T.auth.getSession().then(({data:{session:r}})=>{l(i,r,!0),r?v():l(x,!1)});const{data:{subscription:e}}=T.auth.onAuthStateChange((r,s)=>{l(i,s,!0),s?v():l(x,!1)});return()=>e.unsubscribe()});async function v(){l(x,!0),console.log("Fetching notes...");const{data:e,error:r}=await T.from("notes").select("id, created_at, title, body, color").order("created_at",{ascending:!1});!r&&e?l(E,e,!0):r&&console.error("Error fetching notes:",r),l(x,!1)}function R(){l(_,null),l(g,!0)}function q(e){l(_,e,!0),l(g,!0)}async function ne(e){if(!await et("Are you sure you want to delete this note?","Delete Note",{confirmText:"Delete",isDestructive:!0}))return;const{error:s}=await T.from("notes").delete().eq("id",e);s?(console.error("Error deleting note:",s),O("Error deleting: "+s.message,"Error")):(O("Note deleted successfully!","Success"),v())}async function le(e){const{id:r,...s}=e;if(t(_)){const{error:f}=await T.from("notes").update(s).eq("id",t(_).id);f?(console.error("Error updating note:",f),O("Error updating: "+f.message,"Error")):(O("Note updated successfully!","Success"),l(g,!1),v())}else{const{error:f}=await T.from("notes").insert(s);f?(console.error("Error saving note:",f),O("Error saving: "+f.message,"Error")):(O("Note saved successfully!","Success"),l(g,!1),v())}}function F(e){return e?e.replace(/\n/g,"<br>"):""}function P(e,r=50){return e?e.length>r?e.slice(0,r)+"...":e:""}var I=ht(),S=B(I);ct(S,{get isOpen(){return t(g)},get entry(){return t(_)},onClose:()=>l(g,!1),onSave:le});var Y=n(S,2),D=a(Y),K=n(a(D),2);{var U=e=>{var r=dt();r.__click=R;var s=a(r);ot(s,{class:"h-6 w-6 text-(--accent-color)"}),o(r),A((f,V)=>ie(r,`--accent-color: ${f??""}; background-color: ${V??""}/50`),[()=>H.getAccentLightHex(),()=>H.getAccentHex()]),b(e,r)};C(K,e=>{t(i)&&!t(g)&&!Qe.isOpen&&e(U)})}o(D);var $=n(D,2);{var ee=e=>{var r=vt(),s=a(r);{let f=Ee(()=>H.getAccentHex());Ue(s,{class:"h-6 w-6 animate-spin",get style(){return`color: ${t(f)??""}`}})}o(r),b(e,r)},ce=e=>{var r=se(),s=B(r);{var f=M=>{var te=ut();b(M,te)},V=M=>{var te=se(),je=B(te);{var Oe=j=>{var re=ft();b(j,re)},Te=j=>{var re=_t(),de=B(re),pe=n(a(de),2);_e(pe,16,()=>["created","title"],he,(ve,p)=>{var y=bt();y.__click=()=>m(p);var N=a(y),W=a(N,!0);o(N);var ue=n(N,2);{var fe=X=>{var Z=se(),G=B(Z);{var be=z=>{at(z,{class:"h-3 w-3"})},oe=z=>{st(z,{class:"h-3 w-3"})};C(G,z=>{t(d)==="asc"?z(be):z(oe,!1)})}b(X,Z)};C(ue,X=>{t(h)===p&&X(fe)})}o(y),A(()=>{$e(y,1,`flex items-center gap-1 rounded-md px-3 py-1.5 transition-colors ${t(h)===p?"bg-indigo-500/20 text-indigo-300":"bg-zinc-800/50 text-zinc-400 hover:bg-zinc-800"}`),Q(W,p)}),b(ve,y)});var xe=n(pe,2),Be=a(xe);o(xe),o(de);var we=n(de,2);_e(we,21,()=>t(u),he,(ve,p)=>{var y=gt(),N=a(y),W=a(N),ue=a(W,!0);o(W);var fe=n(W,2);{var X=J=>{var me=mt(),Le=a(me);it(Le,()=>F(P(t(p).body))),o(me),b(J,me)};C(fe,J=>{t(p).body&&J(X)})}o(N);var Z=n(N,2),G=a(Z),be=a(G,!0);o(G);var oe=n(G,2),z=a(oe);z.__click=()=>q(t(p));var He=n(z,2);He.__click=()=>ne(t(p).id),o(oe),o(Z),o(y),A(J=>{ie(y,`background-color: ${(t(p).color||"#18181b")??""}`),Q(ue,t(p).title),Q(be,J)},[()=>new Date(t(p).created_at).toLocaleDateString()]),b(ve,y)}),o(we),A(()=>Q(Be,`Amount of notes: ${t(E).length??""}`)),b(j,re)};C(je,j=>{t(E).length===0?j(Oe):j(Te,!1)},!0)}b(M,te)};C(s,M=>{t(i)?M(V,!1):M(f)},!0)}b(e,r)};C($,e=>{t(x)&&t(i)!==null?e(ee):e(ce,!1)})}o(Y),b(L,I),Se()}Me(["click"]);export{St as component};
