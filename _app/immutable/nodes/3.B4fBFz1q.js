import{c as fe,a as m,f as g}from"../chunks/o5v50Yvo.js";import{p as Pe,s as E,c as Re,d as it,f as u,g as K,a as Ve,h as a,i as n,j as i,n as Ie,t as U,k as e,o as rt,m as De}from"../chunks/5_FoE8hS.js";import{d as Ke,s as O,e as st}from"../chunks/vZxgl7By.js";import{i as A}from"../chunks/CRVHY2kJ.js";import{r as P,b as ot,a as lt,c as R,e as qe,d as C,i as Ge,s as Je,f as dt}from"../chunks/BJLCFyu5.js";import{s as V}from"../chunks/Bkout0r_.js";import{b as ie,a as ct,P as vt,L as ut}from"../chunks/CcyWMRgG.js";import{A as ft,a as pt}from"../chunks/CV5ueOdX.js";var mt=g('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/70 p-2 backdrop-blur-sm md:p-4" role="dialog" aria-modal="true" tabindex="-1"><div class="flex max-h-[95vh] w-full max-w-2xl flex-col overflow-y-auto rounded-xl border border-zinc-800 bg-zinc-900 shadow-xl md:max-h-[90vh]"><div class="sticky top-0 z-10 flex items-center justify-between border-b border-zinc-800 bg-zinc-900 p-4 md:p-6"><h2 class="text-xl font-bold text-zinc-100"> </h2> <button class="text-zinc-400 transition-colors hover:text-zinc-200" aria-label="Close"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <form class="space-y-6 p-4 md:p-6"><div><label for="name" class="mb-1 block text-sm font-medium text-zinc-400">Name</label> <input type="text" id="name" required class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"/></div> <div><label for="location" class="mb-1 block text-sm font-medium text-zinc-400">Location</label> <input type="text" id="location" class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"/></div> <div class="grid grid-cols-1 gap-6 md:grid-cols-2"><div><label for="type" class="mb-1 block text-sm font-medium text-zinc-400">Type</label> <select id="type" class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"><option>Select Type</option><option>Open Call</option><option>Residency</option><option>Grant</option><option>Job Offer</option><option>Other</option></select></div> <div><label for="funds" class="mb-1 block text-sm font-medium text-zinc-400">Funds (€)</label> <input type="number" id="funds" class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"/></div></div> <div><label for="deadline" class="mb-1 block text-sm font-medium text-zinc-400">Deadline</label> <input type="date" id="deadline" class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"/></div> <div><label for="link" class="mb-1 block text-sm font-medium text-zinc-400">Link</label> <input type="url" id="link" placeholder="https://" class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"/></div> <div class="flex items-center"><input type="checkbox" id="applied" class="h-4 w-4 rounded border-zinc-600 bg-zinc-800 text-indigo-600 focus:ring-indigo-500"/> <label for="applied" class="ml-2 block text-sm font-medium text-zinc-300">Applied</label></div> <div class="sticky bottom-0 mt-6 flex justify-end gap-3 border-t border-zinc-800 bg-zinc-900 pt-4"><button type="button" class="rounded-md bg-zinc-800 px-3.5 py-2.5 text-sm font-semibold text-zinc-200 shadow-sm ring-1 ring-zinc-700 ring-inset hover:bg-zinc-700">Cancel</button> <button type="submit" class="rounded-md bg-indigo-600 px-3.5 py-2.5 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600">Save</button></div></form></div></div>');function bt(pe,o){Pe(o,!0);let c=E(Re({name:"",location:"",type:null,funds:null,deadline:"",link:"",applied:!1}));it(()=>{o.isOpen&&(o.entry?u(c,{name:o.entry.name||"",location:o.entry.location||"",type:o.entry.type,funds:o.entry.funds,deadline:o.entry.deadline?new Date(o.entry.deadline).toISOString().split("T")[0]:"",link:o.entry.link||"",applied:o.entry.applied||!1},!0):u(c,{name:"",location:"",type:null,funds:null,deadline:"",link:"",applied:!1},!0))});function j(l){l.preventDefault(),o.onSave(e(c))}function L(l){l.target===l.currentTarget&&o.onClose()}function T(l){l.key==="Escape"&&o.onClose()}var _=fe(),M=K(_);{var me=l=>{var x=mt();x.__click=L,x.__keydown=T;var re=a(x),Q=a(re),k=a(Q),be=a(k,!0);n(k);var ge=i(k,2);ge.__click=function(...v){o.onClose?.apply(this,v)},n(Q);var W=i(Q,2),X=a(W),se=i(a(X),2);P(se),n(X);var Y=i(X,2),oe=i(a(Y),2);P(oe),n(Y);var B=i(Y,2),I=a(B),q=i(a(I),2),G=a(q);G.value=(G.__value=null)??"";var N=i(G);N.value=N.__value=1;var Z=i(N);Z.value=Z.__value=2;var $=i(Z);$.value=$.__value=3;var ee=i($);ee.value=ee.__value=4;var le=i(ee);le.value=le.__value=5,n(q),n(I);var de=i(I,2),t=i(a(de),2);P(t),n(de),n(B);var r=i(B,2),s=i(a(r),2);P(s),n(r);var d=i(r,2),h=i(a(d),2);P(h),n(d);var w=i(d,2),F=a(w);P(F),Ie(2),n(w);var ce=i(w,2),xe=a(ce);xe.__click=function(...v){o.onClose?.apply(this,v)},Ie(2),n(ce),n(W),n(re),n(x),U(()=>O(be,o.entry?"Edit Art Call":"New Art Call")),st("submit",W,j),ie(se,()=>e(c).name,v=>e(c).name=v),ie(oe,()=>e(c).location,v=>e(c).location=v),ot(q,()=>e(c).type,v=>e(c).type=v),ie(t,()=>e(c).funds,v=>e(c).funds=v),ie(s,()=>e(c).deadline,v=>e(c).deadline=v),ie(h,()=>e(c).link,v=>e(c).link=v),ct(F,()=>e(c).applied,v=>e(c).applied=v),m(l,x)};A(M,l=>{o.isOpen&&l(me)})}m(pe,_),Ve()}Ke(["click","keydown"]);var gt=g('<button class="fixed right-8 bottom-8 z-50 rounded-full bg-indigo-600 p-4 text-white shadow-lg transition-transform hover:scale-105 hover:bg-indigo-500" aria-label="New Art Call"><!></button>'),xt=g('<div class="flex h-48 items-center justify-center"><!></div>'),_t=g('<div class="rounded-lg border border-zinc-800 bg-zinc-900/60 p-6 text-zinc-400">Sign in to view art calls.</div>'),ht=g('<div class="rounded-lg border border-zinc-800 bg-zinc-900/60 p-6 text-zinc-400">No art calls yet.</div>'),wt=g('<button><span class="capitalize"> </span> <!></button>'),zt=g('<span class="text-base font-normal text-emerald-400">Applied</span>'),yt=g("<span>Not applied</span>"),kt=g('<a target="_blank" rel="noreferrer">Visit Link &rarr;</a>'),Ct=g('<li><div class="flex flex-col gap-3"><div class="flex items-start justify-between gap-3"><div class="min-w-0 flex-1"><div class="flex flex-wrap items-center gap-2"><h3> </h3> <div> </div></div> <div><span class="truncate"> </span> <span class="text-zinc-600">•</span> <span> </span></div></div> <div class="flex items-center self-center"><!></div></div> <div class="mt-1 flex items-center justify-between gap-4 border-t border-zinc-800/50 pt-3"><div class="flex gap-6"><div class="flex flex-col gap-0.5"><span class="text-[10px] font-bold tracking-wider text-zinc-500 uppercase">Funds</span> <span> </span></div> <div class="flex flex-col gap-0.5"><span class="text-[10px] font-bold tracking-wider text-zinc-500 uppercase">Deadline</span> <span> </span></div></div> <div class="flex items-center gap-2"><!> <button class="rounded-md p-2 text-indigo-400 transition-colors hover:bg-zinc-800 hover:text-indigo-300" aria-label="Edit"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg></button> <button class="rounded-md p-2 text-red-400 transition-colors hover:bg-zinc-800 hover:text-red-300" aria-label="Delete"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg></button></div></div></div></li>'),Ot=g('<div class="mb-4 flex flex-wrap items-center gap-4 text-sm"><span class="text-zinc-500">Sort by:</span> <!> <span class="ml-auto text-xs text-zinc-500"> </span></div> <ul class="grid grid-cols-1 gap-3"></ul>',1),At=g('<!> <section class="space-y-6"><div class="flex flex-wrap items-center justify-between gap-4"><h2 class="text-lg font-bold text-zinc-100">Art Calls</h2> <!></div> <!></section>',1);function Nt(pe,o){Pe(o,!0);const c={1:"Open Call",2:"Residency",3:"Grant",4:"Job Offer",5:"Other"};let j=E(null),L=E(!0),T=E(Re([])),_=E(!1),M=E(null),me=De(()=>e(T).filter(t=>t.applied).length),l=E("deadline"),x=E("asc"),re=De(()=>[...e(T)].sort((t,r)=>{const s=e(x)==="asc"?1:-1;if(e(l)==="name")return t.name.localeCompare(r.name)*s;if(e(l)==="funds")return((t.funds??0)-(r.funds??0))*s;if(e(l)==="deadline"){const d=t.deadline?new Date(t.deadline).getTime():s===1?1/0:-1/0,h=r.deadline?new Date(r.deadline).getTime():s===1?1/0:-1/0;return(d-h)*s}else if(e(l)==="created"){const d=new Date(t.created_at).getTime(),h=new Date(r.created_at).getTime();return(d-h)*s}else if(e(l)==="status"){const d=B(t.deadline).isOpen?0:1,h=B(r.deadline).isOpen?0:1;return(d-h)*s}return 0}));function Q(t){e(l)===t?u(x,e(x)==="asc"?"desc":"asc",!0):(u(l,t,!0),u(x,"asc"))}rt(()=>{V.auth.getSession().then(({data:{session:r}})=>{u(j,r,!0),r?k():u(L,!1)});const{data:{subscription:t}}=V.auth.onAuthStateChange((r,s)=>{u(j,s,!0),s?k():u(L,!1)});return()=>t.unsubscribe()});async function k(){u(L,!0),console.log("Fetching art calls...");const{data:t,error:r}=await V.from("artCalls").select("id, created_at, name, location, type, funds, deadline, link, applied").order("deadline",{ascending:!0});!r&&t?u(T,t,!0):r&&console.error("Error fetching art calls:",r),u(L,!1)}function be(){u(M,null),u(_,!0)}function ge(t){u(M,t,!0),u(_,!0)}async function W(t){if(!await dt("Are you sure you want to delete this art call?","Delete Art Call",{confirmText:"Delete",isDestructive:!0}))return;const{error:s}=await V.from("artCalls").delete().eq("id",t);s?(console.error("Error deleting art call:",s),R("Error deleting: "+s.message,"Error")):(R("Art call deleted successfully!","Success"),k())}async function X(t){const{id:r,...s}=t;if(e(M)){const{error:d}=await V.from("artCalls").update(s).eq("id",e(M).id);d?(console.error("Error updating art call:",d),R("Error updating: "+d.message,"Error")):(R("Art call updated successfully!","Success"),u(_,!1),k())}else{const{error:d}=await V.from("artCalls").insert(s);d?(console.error("Error saving art call:",d),R("Error saving: "+d.message,"Error")):(R("Art call saved successfully!","Success"),u(_,!1),k())}}const se=t=>c[t??0]??"Unknown",Y=t=>t===null?"—":`€${t}`,oe=t=>t?new Date(t).toLocaleDateString():"—";function B(t){if(!t)return{label:"Open",color:"bg-emerald-500",bg:"bg-emerald-500/10",text:"text-emerald-400",isOpen:!0};const r=new Date(t),s=new Date;return s.setHours(0,0,0,0),r.setHours(0,0,0,0),r>=s?{label:"Open",color:"bg-emerald-500",bg:"bg-emerald-500/10",text:"text-emerald-400",isOpen:!0}:{label:"Closed",color:"bg-red-500",bg:"bg-red-500/10",text:"text-red-400",isOpen:!1}}var I=At(),q=K(I);bt(q,{get isOpen(){return e(_)},get entry(){return e(M)},onClose:()=>u(_,!1),onSave:X});var G=i(q,2),N=a(G),Z=i(a(N),2);{var $=t=>{var r=gt();r.__click=be;var s=a(r);vt(s,{class:"h-6 w-6"}),n(r),m(t,r)};A(Z,t=>{e(j)&&!e(_)&&!lt.isOpen&&t($)})}n(N);var ee=i(N,2);{var le=t=>{var r=xt(),s=a(r);ut(s,{class:"h-6 w-6 animate-spin text-indigo-400"}),n(r),m(t,r)},de=t=>{var r=fe(),s=K(r);{var d=w=>{var F=_t();m(w,F)},h=w=>{var F=fe(),ce=K(F);{var xe=J=>{var ve=ht();m(J,ve)},v=J=>{var ve=Ot(),_e=K(ve),Se=i(a(_e),2);qe(Se,16,()=>["name","funds","deadline","created","status"],Ge,(he,f)=>{var p=wt();p.__click=()=>Q(f);var D=a(p),ue=a(D,!0);n(D);var te=i(D,2);{var ne=H=>{var S=fe(),we=K(S);{var ae=z=>{ft(z,{class:"h-3 w-3"})},ze=z=>{pt(z,{class:"h-3 w-3"})};A(we,z=>{e(x)==="asc"?z(ae):z(ze,!1)})}m(H,S)};A(te,H=>{e(l)===f&&H(ne)})}n(p),U(()=>{C(p,1,`flex items-center gap-1 rounded-md px-3 py-1.5 transition-colors ${e(l)===f?"bg-indigo-500/20 text-indigo-300":"bg-zinc-800/50 text-zinc-400 hover:bg-zinc-800"}`),O(ue,f)}),m(he,p)});var Ee=i(Se,2),Ue=a(Ee);n(Ee),n(_e);var je=i(_e,2);qe(je,21,()=>e(re),Ge,(he,f)=>{const p=De(()=>B(e(f).deadline));var D=Ct(),ue=a(D),te=a(ue),ne=a(te),H=a(ne),S=a(H),we=a(S,!0);n(S);var ae=i(S,2),ze=a(ae,!0);n(ae),n(H);var z=i(H,2),ye=a(z),Qe=a(ye,!0);n(ye);var Le=i(ye,4),We=a(Le,!0);n(Le),n(z),n(ne);var Te=i(ne,2),Xe=a(Te);{var Ye=b=>{var y=zt();m(b,y)},Ze=b=>{var y=yt();U(()=>C(y,1,`text-base font-normal ${e(p).isOpen?"text-zinc-400":"text-zinc-500"}`)),m(b,y)};A(Xe,b=>{e(f).applied?b(Ye):b(Ze,!1)})}n(Te),n(te);var Me=i(te,2),ke=a(Me),Ce=a(ke),Oe=i(a(Ce),2),$e=a(Oe,!0);n(Oe),n(Ce);var Be=i(Ce,2),Ae=i(a(Be),2),et=a(Ae,!0);n(Ae),n(Be),n(ke);var Ne=i(ke,2),Fe=a(Ne);{var tt=b=>{var y=kt();U(()=>{C(y,1,`rounded-md px-3 py-1.5 text-xs font-medium transition-colors ${e(p).isOpen?"bg-indigo-500/10 text-indigo-400 hover:bg-indigo-500/20 hover:text-indigo-300":"bg-zinc-800/60 text-zinc-500 hover:bg-zinc-800"}`),Je(y,"href",e(f).link)}),m(b,y)};A(Fe,b=>{e(f).link&&b(tt)})}var He=i(Fe,2);He.__click=()=>ge(e(f));var nt=i(He,2);nt.__click=()=>W(e(f).id),n(Ne),n(Me),n(ue),n(D),U((b,y,at)=>{C(D,1,`group relative flex flex-col justify-between rounded-lg border p-4 transition-all ${e(p).isOpen?"border-zinc-800 bg-zinc-900/60 hover:border-zinc-700 hover:bg-zinc-900/80":"border-zinc-800/60 bg-zinc-900/30 hover:border-zinc-700/60 hover:bg-zinc-900/40"}`),C(S,1,`truncate text-base font-bold ${e(p).isOpen?"text-zinc-100":"text-zinc-500"}`),Je(S,"title",e(f).name),O(we,e(f).name),C(ae,1,`shrink-0 rounded-full border px-2 py-0.5 text-[10px] font-medium ${e(p).bg} ${e(p).text} border-transparent text-center`),O(ze,e(p).label),C(z,1,`mt-1 flex flex-wrap items-center gap-x-2 gap-y-1 text-xs ${e(p).isOpen?"text-zinc-400":"text-zinc-500"}`),O(Qe,e(f).location),O(We,b),C(Oe,1,`text-sm font-medium ${e(p).isOpen?"text-emerald-400":"text-zinc-500"}`),O($e,y),C(Ae,1,`text-sm ${e(p).isOpen?"text-zinc-300":"text-zinc-500"}`),O(et,at)},[()=>se(e(f).type),()=>Y(e(f).funds),()=>oe(e(f).deadline)]),m(he,D)}),n(je),U(()=>O(Ue,`Applied ${e(me)??""} / ${e(T).length??""}`)),m(J,ve)};A(ce,J=>{e(T).length===0?J(xe):J(v,!1)},!0)}m(w,F)};A(s,w=>{e(j)?w(h,!1):w(d)},!0)}m(t,r)};A(ee,t=>{e(L)&&e(j)!==null?t(le):t(de,!1)})}n(G),m(pe,I),Ve()}Ke(["click"]);export{Nt as component};
