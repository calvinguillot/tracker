import{c as B,a as v,f as _}from"../chunks/CBL0ReU-.js";import{g as j,p as Le,s as O,c as Ne,d as Qe,f as c,a as Ie,h as a,i as n,j as r,n as We,t as ve,k as e,o as Xe,H as Oe}from"../chunks/DZENMWVZ.js";import{d as Me,s as D,e as Ye}from"../chunks/C73i8PqL.js";import{l as Te,s as Fe,i as A}from"../chunks/CcH4pQ61.js";import{I as Pe,c as Be,r as $,d as Ze,a as ue,e as De,f as Ae,i as je,s as Ee}from"../chunks/D7JaMLaG.js";import{s as ee}from"../chunks/Bkout0r_.js";import{b as te,P as $e,L as et}from"../chunks/uBRFw_18.js";import"../chunks/B3HG88SV.js";function tt(E,o){const d=Te(o,["children","$$slots","$$events","$$legacy"]);const m=[["path",{d:"M12 5v14"}],["path",{d:"m19 12-7 7-7-7"}]];Pe(E,Fe({name:"arrow-down"},()=>d,{get iconNode(){return m},children:(g,L)=>{var p=B(),x=j(p);Be(x,o,"default",{}),v(g,p)},$$slots:{default:!0}}))}function nt(E,o){const d=Te(o,["children","$$slots","$$events","$$legacy"]);const m=[["path",{d:"m5 12 7-7 7 7"}],["path",{d:"M12 19V5"}]];Pe(E,Fe({name:"arrow-up"},()=>d,{get iconNode(){return m},children:(g,L)=>{var p=B(),x=j(p);Be(x,o,"default",{}),v(g,p)},$$slots:{default:!0}}))}var at=_('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/70 p-4 backdrop-blur-sm" role="dialog" aria-modal="true" tabindex="-1"><div class="flex max-h-[90vh] w-full max-w-2xl flex-col overflow-y-auto rounded-xl border border-zinc-800 bg-zinc-900 shadow-xl"><div class="sticky top-0 z-10 flex items-center justify-between border-b border-zinc-800 bg-zinc-900 p-6"><h2 class="text-xl font-bold text-zinc-100"> </h2> <button class="text-zinc-400 transition-colors hover:text-zinc-200" aria-label="Close"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <form class="space-y-6 p-6"><div><label for="name" class="mb-1 block text-sm font-medium text-zinc-400">Name</label> <input type="text" id="name" required class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"/></div> <div><label for="location" class="mb-1 block text-sm font-medium text-zinc-400">Location</label> <input type="text" id="location" class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"/></div> <div class="grid grid-cols-1 gap-6 md:grid-cols-2"><div><label for="type" class="mb-1 block text-sm font-medium text-zinc-400">Type</label> <select id="type" class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"><option>Select Type</option><option>Open Call</option><option>Residency</option><option>Grant</option><option>Job Offer</option><option>Other</option></select></div> <div><label for="funds" class="mb-1 block text-sm font-medium text-zinc-400">Funds (€)</label> <input type="number" id="funds" class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"/></div></div> <div><label for="deadline" class="mb-1 block text-sm font-medium text-zinc-400">Deadline</label> <input type="date" id="deadline" class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"/></div> <div><label for="link" class="mb-1 block text-sm font-medium text-zinc-400">Link</label> <input type="url" id="link" placeholder="https://" class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"/></div> <div class="sticky bottom-0 mt-6 flex justify-end gap-3 border-t border-zinc-800 bg-zinc-900 pt-4"><button type="button" class="rounded-md bg-zinc-800 px-3.5 py-2.5 text-sm font-semibold text-zinc-200 shadow-sm ring-1 ring-zinc-700 ring-inset hover:bg-zinc-700">Cancel</button> <button type="submit" class="rounded-md bg-indigo-600 px-3.5 py-2.5 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600">Save</button></div></form></div></div>');function rt(E,o){Le(o,!0);let d=O(Ne({name:"",location:"",type:null,funds:null,deadline:"",link:""}));Qe(()=>{o.isOpen&&(o.entry?c(d,{name:o.entry.name||"",location:o.entry.location||"",type:o.entry.type,funds:o.entry.funds,deadline:o.entry.deadline?new Date(o.entry.deadline).toISOString().split("T")[0]:"",link:o.entry.link||""},!0):c(d,{name:"",location:"",type:null,funds:null,deadline:"",link:""},!0))});function m(u){u.preventDefault(),o.onSave(e(d))}function g(u){u.target===u.currentTarget&&o.onClose()}function L(u){u.key==="Escape"&&o.onClose()}var p=B(),x=j(p);{var h=u=>{var N=at();N.__click=g,N.__keydown=L;var ne=a(N),k=a(ne),H=a(k),fe=a(H,!0);n(H);var pe=r(H,2);pe.__click=function(...l){o.onClose?.apply(this,l)},n(k);var q=r(k,2),G=a(q),ae=r(a(G),2);$(ae),n(G);var F=r(G,2),J=r(a(F),2);$(J),n(F);var P=r(F,2),I=a(P),R=r(a(I),2),V=a(R);V.value=(V.__value=null)??"";var K=r(V);K.value=K.__value=1;var U=r(K);U.value=U.__value=2;var Q=r(U);Q.value=Q.__value=3;var t=r(Q);t.value=t.__value=4;var i=r(t);i.value=i.__value=5,n(R),n(I);var s=r(I,2),f=r(a(s),2);$(f),n(s),n(P);var M=r(P,2),y=r(a(M),2);$(y),n(M);var C=r(M,2),re=r(a(C),2);$(re),n(C);var ie=r(C,2),be=a(ie);be.__click=function(...l){o.onClose?.apply(this,l)},We(2),n(ie),n(q),n(ne),n(N),ve(()=>D(fe,o.entry?"Edit Art Call":"New Art Call")),Ye("submit",q,m),te(ae,()=>e(d).name,l=>e(d).name=l),te(J,()=>e(d).location,l=>e(d).location=l),Ze(R,()=>e(d).type,l=>e(d).type=l),te(f,()=>e(d).funds,l=>e(d).funds=l),te(y,()=>e(d).deadline,l=>e(d).deadline=l),te(re,()=>e(d).link,l=>e(d).link=l),v(u,N)};A(x,u=>{o.isOpen&&u(h)})}v(E,p),Ie()}Me(["click","keydown"]);var it=_('<button class="fixed right-8 bottom-8 z-50 rounded-full bg-indigo-600 p-4 text-white shadow-lg transition-transform hover:scale-105 hover:bg-indigo-500" aria-label="New Art Call"><!></button>'),ot=_('<div class="flex h-48 items-center justify-center"><!></div>'),st=_('<div class="rounded-lg border border-zinc-800 bg-zinc-900/60 p-6 text-zinc-400">Sign in to view art calls.</div>'),lt=_('<div class="rounded-lg border border-zinc-800 bg-zinc-900/60 p-6 text-zinc-400">No art calls yet.</div>'),dt=_('<button><span class="capitalize"> </span> <!></button>'),ct=_('<a class="rounded-md bg-indigo-500/10 px-3 py-1.5 text-xs font-medium text-indigo-400 transition-colors hover:bg-indigo-500/20 hover:text-indigo-300" target="_blank" rel="noreferrer">Visit Link &rarr;</a>'),ut=_('<li class="group relative flex flex-col justify-between rounded-lg border border-zinc-800 bg-zinc-900/60 p-4 transition-all hover:border-zinc-700 hover:bg-zinc-900/80"><div class="flex flex-col gap-3"><div class="flex items-start justify-between gap-3"><div class="min-w-0 flex-1"><h3 class="truncate text-base font-bold text-zinc-100"> </h3> <div class="mt-1 flex flex-wrap items-center gap-x-2 gap-y-1 text-xs text-zinc-400"><span class="truncate"> </span> <span class="text-zinc-600">•</span> <span> </span></div></div> <div> </div></div> <div class="mt-1 flex items-center justify-between gap-4 border-t border-zinc-800/50 pt-3"><div class="flex gap-6"><div class="flex flex-col gap-0.5"><span class="text-[10px] font-bold tracking-wider text-zinc-500 uppercase">Funds</span> <span class="text-sm font-medium text-emerald-400"> </span></div> <div class="flex flex-col gap-0.5"><span class="text-[10px] font-bold tracking-wider text-zinc-500 uppercase">Deadline</span> <span class="text-sm text-zinc-300"> </span></div></div> <!></div></div></li>'),vt=_('<div class="mb-4 flex flex-wrap items-center gap-4 text-sm"><span class="text-zinc-500">Sort by:</span> <!></div> <ul class="grid grid-cols-1 gap-3"></ul>',1),ft=_('<!> <section class="space-y-6"><div class="flex flex-wrap items-center justify-between gap-4"><h2 class="text-lg font-bold text-zinc-100">Art Calls</h2> <!></div> <!></section>',1);function wt(E,o){Le(o,!0);const d={1:"Open Call",2:"Residency",3:"Grant",4:"Job Offer",5:"Other"};let m=O(null),g=O(!0),L=O(Ne([])),p=O(!1),x=O(null),h=O("deadline"),u=O("asc"),N=Oe(()=>[...e(L)].sort((t,i)=>{const s=e(u)==="asc"?1:-1;if(e(h)==="name")return t.name.localeCompare(i.name)*s;if(e(h)==="funds")return((t.funds??0)-(i.funds??0))*s;if(e(h)==="deadline"){const f=t.deadline?new Date(t.deadline).getTime():s===1?1/0:-1/0,M=i.deadline?new Date(i.deadline).getTime():s===1?1/0:-1/0;return(f-M)*s}return 0}));function ne(t){e(h)===t?c(u,e(u)==="asc"?"desc":"asc",!0):(c(h,t,!0),c(u,"asc"))}Xe(()=>{ee.auth.getSession().then(({data:{session:i}})=>{c(m,i,!0),i?k():c(g,!1)});const{data:{subscription:t}}=ee.auth.onAuthStateChange((i,s)=>{c(m,s,!0),s?k():c(g,!1)});return()=>t.unsubscribe()});async function k(){c(g,!0),console.log("Fetching art calls...");const{data:t,error:i}=await ee.from("artCalls").select("id, created_at, name, location, type, funds, deadline, link").order("deadline",{ascending:!0});!i&&t?c(L,t,!0):i&&console.error("Error fetching art calls:",i),c(g,!1)}function H(){c(x,null),c(p,!0)}async function fe(t){const{id:i,...s}=t;if(e(x)){const{error:f}=await ee.from("artCalls").update(s).eq("id",e(x).id);f?(console.error("Error updating art call:",f),ue("Error updating: "+f.message,"Error")):(ue("Art call updated successfully!","Success"),c(p,!1),k())}else{const{error:f}=await ee.from("artCalls").insert(s);f?(console.error("Error saving art call:",f),ue("Error saving: "+f.message,"Error")):(ue("Art call saved successfully!","Success"),c(p,!1),k())}}const pe=t=>d[t??0]??"Unknown",q=t=>t===null?"—":`€${t}`,G=t=>t?new Date(t).toLocaleDateString():"—";function ae(t){if(!t)return{label:"Open",color:"bg-emerald-500",bg:"bg-emerald-500/10",text:"text-emerald-400"};const i=new Date(t),s=new Date;return s.setHours(0,0,0,0),i.setHours(0,0,0,0),i>=s?{label:"Open",color:"bg-emerald-500",bg:"bg-emerald-500/10",text:"text-emerald-400"}:{label:"Closed",color:"bg-red-500",bg:"bg-red-500/10",text:"text-red-400"}}var F=ft(),J=j(F);rt(J,{get isOpen(){return e(p)},get entry(){return e(x)},onClose:()=>c(p,!1),onSave:fe});var P=r(J,2),I=a(P),R=r(a(I),2);{var V=t=>{var i=it();i.__click=H;var s=a(i);$e(s,{class:"h-6 w-6"}),n(i),v(t,i)};A(R,t=>{e(m)&&t(V)})}n(I);var K=r(I,2);{var U=t=>{var i=ot(),s=a(i);et(s,{class:"h-6 w-6 animate-spin text-indigo-400"}),n(i),v(t,i)},Q=t=>{var i=B(),s=j(i);{var f=y=>{var C=st();v(y,C)},M=y=>{var C=B(),re=j(C);{var ie=l=>{var oe=lt();v(l,oe)},be=l=>{var oe=vt(),me=j(oe),He=r(a(me),2);De(He,16,()=>["name","funds","deadline"],je,(ge,b)=>{var w=dt();w.__click=()=>ne(b);var T=a(w),se=a(T,!0);n(T);var W=r(T,2);{var X=S=>{var le=B(),de=j(le);{var Y=z=>{nt(z,{class:"h-3 w-3"})},xe=z=>{tt(z,{class:"h-3 w-3"})};A(de,z=>{e(u)==="asc"?z(Y):z(xe,!1)})}v(S,le)};A(W,S=>{e(h)===b&&S(X)})}n(w),ve(()=>{Ae(w,1,`flex items-center gap-1 rounded-md px-3 py-1.5 transition-colors ${e(h)===b?"bg-indigo-500/20 text-indigo-300":"bg-zinc-800/50 text-zinc-400 hover:bg-zinc-800"}`),D(se,b)}),v(ge,w)}),n(me);var we=r(me,2);De(we,21,()=>e(N),je,(ge,b)=>{const w=Oe(()=>ae(e(b).deadline));var T=ut(),se=a(T),W=a(se),X=a(W),S=a(X),le=a(S,!0);n(S);var de=r(S,2),Y=a(de),xe=a(Y,!0);n(Y);var z=r(Y,4),qe=a(z,!0);n(z),n(de),n(X);var _e=r(X,2),Ge=a(_e,!0);n(_e),n(W);var ze=r(W,2),he=a(ze),ye=a(he),ke=r(a(ye),2),Je=a(ke,!0);n(ke),n(ye);var Ce=r(ye,2),Se=r(a(Ce),2),Re=a(Se,!0);n(Se),n(Ce),n(he);var Ve=r(he,2);{var Ke=Z=>{var ce=ct();ve(()=>Ee(ce,"href",e(b).link)),v(Z,ce)};A(Ve,Z=>{e(b).link&&Z(Ke)})}n(ze),n(se),n(T),ve((Z,ce,Ue)=>{Ee(S,"title",e(b).name),D(le,e(b).name),D(xe,e(b).location),D(qe,Z),Ae(_e,1,`shrink-0 rounded-full border px-2 py-0.5 text-[10px] font-medium ${e(w).bg} ${e(w).text} border-transparent`),D(Ge,e(w).label),D(Je,ce),D(Re,Ue)},[()=>pe(e(b).type),()=>q(e(b).funds),()=>G(e(b).deadline)]),v(ge,T)}),n(we),v(l,oe)};A(re,l=>{e(L).length===0?l(ie):l(be,!1)},!0)}v(y,C)};A(s,y=>{e(m)?y(M,!1):y(f)},!0)}v(t,i)};A(K,t=>{e(g)&&e(m)!==null?t(U):t(Q,!1)})}n(P),v(E,F),Ie()}Me(["click"]);export{wt as component};
