import{c as Ne,a as p,f as x}from"../chunks/Blua9Muq.js";import{p as Xe,v as M,w as Ye,x as ht,y as b,k as $,a as Ze,z as a,A as r,B as i,D as H,m as e,F as zt,G as Re,o as yt,I as W,J as wt}from"../chunks/BWAAnFQE.js";import{d as $e,s as w,e as kt}from"../chunks/B5UJqv3b.js";import{i as z}from"../chunks/hg7ngHtp.js";import{e as ye,i as we,s as Pe}from"../chunks/wCmp37z_.js";import{r as K,a as A,b as et,t as At,c as Ct,d as X,e as Ot,L as Dt,f as j,g as Ve}from"../chunks/FJNRq2ku.js";import{s as Y}from"../chunks/BW5xtwr9.js";import{b as Z,a as We,P as St}from"../chunks/DWGvfTVC.js";import{f as Et}from"../chunks/BsCRBkET.js";import{A as Tt}from"../chunks/C6BYduXv.js";import{A as Lt}from"../chunks/f6ai2VFN.js";var jt=x("<option> </option>"),Ht=x('<button type="button" class="rounded-md bg-red-500/10 px-3.5 py-2.5 text-sm font-semibold text-red-400 shadow-sm ring-1 ring-red-500/20 transition-colors ring-inset hover:bg-red-500/20">Delete</button>'),Ft=x('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/70 p-2 backdrop-blur-sm md:p-4" role="dialog" aria-modal="true" tabindex="-1"><div class="flex max-h-[95vh] w-full max-w-2xl flex-col overflow-y-auto rounded-xl border border-zinc-800 bg-zinc-900 shadow-xl md:max-h-[90vh]"><div class="sticky top-0 z-10 flex items-center justify-between border-b border-zinc-800 bg-zinc-900 p-4 md:p-6"><h2 class="text-xl font-bold text-zinc-100"> </h2> <button class="text-zinc-400 transition-colors hover:text-zinc-200" aria-label="Close"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <form class="space-y-6 p-4 md:p-6"><div><label for="name" class="mb-1 block text-sm font-medium text-zinc-400">Name</label> <input type="text" id="name" required class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"/></div> <div><label for="location" class="mb-1 block text-sm font-medium text-zinc-400">Location</label> <input type="text" id="location" class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"/></div> <div class="grid grid-cols-1 gap-6 md:grid-cols-2"><div><label for="type" class="mb-1 block text-sm font-medium text-zinc-400">Type</label> <select id="type" class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"><option>Select Type</option><!></select></div> <div><label for="funds" class="mb-1 block text-sm font-medium text-zinc-400">Funds (€)</label> <input type="number" id="funds" class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"/></div></div> <div><label for="deadline" class="mb-1 block text-sm font-medium text-zinc-400">Deadline</label> <input type="date" id="deadline" class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"/></div> <div><label for="link" class="mb-1 block text-sm font-medium text-zinc-400">Link</label> <input type="url" id="link" placeholder="https://" class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"/></div> <div><label for="idea" class="mb-1 block text-sm font-medium text-zinc-400">Idea</label> <textarea id="idea" rows="3" class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"></textarea></div> <div class="flex gap-6"><div class="flex items-center"><input type="checkbox" id="applied" class="h-4 w-4 rounded border-zinc-600 bg-zinc-800 text-indigo-600 focus:ring-indigo-500"/> <label for="applied" class="ml-2 block text-sm font-medium text-zinc-300">Applied</label></div> <div class="flex items-center"><input type="checkbox" id="group" class="h-4 w-4 rounded border-zinc-600 bg-zinc-800 text-yellow-500 focus:ring-yellow-500"/> <label for="group" class="ml-2 block text-sm font-medium text-zinc-300">Group</label></div></div> <div class="sticky bottom-0 mt-6 flex justify-between gap-3 border-t border-zinc-800 bg-zinc-900 pt-4"><div><!></div> <div class="flex gap-3"><button type="button" class="rounded-md bg-zinc-800 px-3.5 py-2.5 text-sm font-semibold text-zinc-200 shadow-sm ring-1 ring-zinc-700 ring-inset hover:bg-zinc-700">Cancel</button> <button type="submit" class="rounded-md px-3.5 py-2.5 text-sm font-semibold text-white shadow-sm transition-all hover:brightness-110 focus-visible:outline-2 focus-visible:outline-offset-2">Save</button></div></div></form></div></div>');function It(ke,d){Xe(d,!0);let l=M(Ye({name:"",location:"",type:null,funds:null,deadline:"",link:"",applied:!1,group:!1,idea:""}));ht(()=>{d.isOpen&&(d.entry?b(l,{name:d.entry.name||"",location:d.entry.location||"",type:d.entry.type,funds:d.entry.funds,deadline:d.entry.deadline?new Date(d.entry.deadline).toISOString().split("T")[0]:"",link:d.entry.link||"",applied:d.entry.applied||!1,group:d.entry.group||!1,idea:d.entry.idea||""},!0):b(l,{name:"",location:"",type:null,funds:null,deadline:"",link:"",applied:!1,group:!1,idea:""},!0))});function N(_){_.preventDefault(),d.onSave(e(l))}function P(_){_.target===_.currentTarget&&d.onClose()}function k(_){_.key==="Escape"&&d.onClose()}var F=Ne(),Ae=$(F);{var C=_=>{var O=Ft();O.__click=P,O.__keydown=k;var ue=a(O),U=a(ue),D=a(U),Ce=a(D,!0);r(D);var Oe=i(D,2);Oe.__click=function(...s){d.onClose?.apply(this,s)},r(U);var ee=i(U,2),te=a(ee),fe=i(a(te),2);K(fe),r(te);var re=i(te,2),pe=i(a(re),2);K(pe),r(re);var ae=i(re,2),S=a(ae),Q=i(a(S),2),R=a(Q);R.value=(R.__value=null)??"";var be=i(R);ye(be,17,()=>A.settings.calls_types,we,(s,y)=>{var T=jt(),Se=a(T,!0);r(T);var he={};H(()=>{w(Se,e(y).label),he!==(he=e(y).id)&&(T.value=(T.__value=e(y).id)??"")}),p(s,T)}),r(Q),r(S);var V=i(S,2),me=i(a(V),2);K(me),r(V),r(ae);var ie=i(ae,2),ge=i(a(ie),2);K(ge),r(ie);var ne=i(ie,2),xe=i(a(ne),2);K(xe),r(ne);var t=i(ne,2),n=i(a(t),2);zt(n),r(t);var o=i(t,2),v=a(o),h=a(v);K(h),Re(2),r(v);var E=i(v,2),q=a(E);K(q),Re(2),r(E),r(o);var _e=i(o,2),se=a(_e),De=a(se);{var I=s=>{var y=Ht();y.__click=()=>d.onDelete(d.entry.id),p(s,y)};z(De,s=>{d.entry&&d.onDelete&&s(I)})}r(se);var G=i(se,2),oe=a(G);oe.__click=function(...s){d.onClose?.apply(this,s)};var le=i(oe,2);r(G),r(_e),r(ee),r(ue),r(O),H(s=>{w(Ce,d.entry?"Edit Art Call":"New Art Call"),Pe(le,`background-color: ${s??""}`)},[()=>A.getAccentHex()]),kt("submit",ee,N),Z(fe,()=>e(l).name,s=>e(l).name=s),Z(pe,()=>e(l).location,s=>e(l).location=s),et(Q,()=>e(l).type,s=>e(l).type=s),Z(me,()=>e(l).funds,s=>e(l).funds=s),Z(ge,()=>e(l).deadline,s=>e(l).deadline=s),Z(xe,()=>e(l).link,s=>e(l).link=s),Z(n,()=>e(l).idea,s=>e(l).idea=s),We(h,()=>e(l).applied,s=>e(l).applied=s),We(q,()=>e(l).group,s=>e(l).group=s),At(3,O,()=>Et,()=>({duration:A.getTransitionDuration()})),p(_,O)};z(Ae,_=>{d.isOpen&&_(C)})}p(ke,F),Ze()}$e(["click","keydown"]);var Bt=x('<button class="fixed right-8 bottom-24 z-50 rounded-full p-4 shadow-lg/30 drop-shadow-lg backdrop-blur-md transition-all hover:scale-105 hover:brightness-110 md:right-16 md:bottom-16" aria-label="New Art Call"><!></button>'),Mt=x('<div class="flex h-48 items-center justify-center"><!></div>'),Nt=x('<div class="rounded-lg border border-zinc-800 bg-zinc-900/60 p-6 text-zinc-400">Sign in to view art calls.</div>'),Pt=x('<div class="rounded-lg border border-zinc-800 bg-zinc-900/60 p-6 text-zinc-400">No art calls yet.</div>'),qt=x('<div class="shrink-0 rounded-full border border-transparent bg-yellow-500/10 px-2 py-0.5 text-center text-[10px] font-medium text-yellow-500">Group</div>'),Gt=x('<span class="text-base font-normal text-emerald-400">Applied</span>'),Jt=x("<span>Not applied</span>"),Kt=x('<div class="mt-1 border-t border-zinc-800/50 pt-3"><p> </p></div>'),Ut=x('<a target="_blank" rel="noreferrer">Link &rarr;</a>'),Qt=x('<button type="button"><div class="flex flex-col gap-3"><div class="flex items-start justify-between gap-3"><div class="min-w-0 flex-1"><div class="flex flex-wrap items-center gap-2"><h3> </h3> <div> </div> <!></div> <div><span class="truncate"> </span> <span class="text-zinc-600">•</span> <span> </span></div></div> <div class="flex items-center self-center"><!></div></div> <!> <div class="mt-1 flex items-center justify-between gap-4 border-t border-zinc-800/50 pt-3"><div class="flex gap-6"><div class="flex flex-col gap-0.5"><span class="text-[10px] font-bold tracking-wider text-zinc-500 uppercase">Funds</span> <span> </span></div> <div class="flex flex-col gap-0.5"><span class="text-[10px] font-bold tracking-wider text-zinc-500 uppercase">Deadline</span> <span> </span></div></div> <!></div></div></button>'),Rt=x("<option> </option>"),Vt=x('<div class="my-8 flex items-center gap-4"><div class="h-px flex-1 bg-zinc-800"></div> <span class="text-sm font-medium tracking-wider text-zinc-500 uppercase">Archived</span> <div class="h-px flex-1 bg-zinc-800"></div></div> <div class="grid grid-cols-1 gap-3"></div>',1),Wt=x('<div class="mb-4 flex flex-wrap items-center gap-4 text-sm"><div class="flex items-center gap-2"><select class="cursor-pointer rounded-md border border-zinc-700 bg-zinc-800 px-3 py-1.5 text-sm text-zinc-100 shadow-sm outline-none focus:border-indigo-500 focus:ring-indigo-500"></select> <button class="flex items-center justify-center rounded-md border border-zinc-700 bg-zinc-800 p-1.5 text-zinc-400 shadow-sm transition-colors hover:bg-zinc-700 hover:text-zinc-100" aria-label="Toggle sort order"><!></button></div> <span class="ml-auto text-xs text-zinc-500"> </span></div> <div class="grid grid-cols-1 gap-3"></div> <!>',1),Xt=x('<!> <section><div class="flex flex-wrap items-center justify-between gap-4"><!></div> <!></section>',1);function lr(ke,d){Xe(d,!0);let l=M(null),N=M(!0),P=M(Ye([])),k=M(!1),F=M(null),Ae=W(()=>e(P).filter(t=>t.applied).length),C=M("deadline"),_=M("asc"),O=W(()=>[...e(P)].sort((t,n)=>{const o=e(_)==="asc"?1:-1;if(e(C)==="name")return t.name.localeCompare(n.name)*o;if(e(C)==="funds")return((t.funds??0)-(n.funds??0))*o;if(e(C)==="deadline"){const v=t.deadline?new Date(t.deadline).getTime():o===1?1/0:-1/0,h=n.deadline?new Date(n.deadline).getTime():o===1?1/0:-1/0;return(v-h)*o}else if(e(C)==="created"){const v=new Date(t.created_at).getTime(),h=new Date(n.created_at).getTime();return(v-h)*o}else if(e(C)==="status"){const v=S(t.deadline).isOpen?0:1,h=S(n.deadline).isOpen?0:1;return(v-h)*o}return 0})),ue=W(()=>e(O).filter(t=>S(t.deadline).isOpen&&!t.applied)),U=W(()=>e(O).filter(t=>!S(t.deadline).isOpen||t.applied));yt(()=>{Y.auth.getSession().then(({data:{session:n}})=>{b(l,n,!0),n?D():b(N,!1)});const{data:{subscription:t}}=Y.auth.onAuthStateChange((n,o)=>{b(l,o,!0),o?D():b(N,!1)});return()=>t.unsubscribe()});async function D(){b(N,!0),console.log("Fetching art calls...");const{data:t,error:n}=await Y.from("artCalls").select("id, created_at, name, location, type, funds, deadline, link, applied, group, idea").order("deadline",{ascending:!0});!n&&t?b(P,t,!0):n&&console.error("Error fetching art calls:",n),b(N,!1)}function Ce(){b(F,null),b(k,!0)}function Oe(t){b(F,t,!0),b(k,!0)}async function ee(t){if(!await Ct("Are you sure you want to delete this art call?","Delete Art Call",{confirmText:"Delete",isDestructive:!0}))return;const{error:o}=await Y.from("artCalls").delete().eq("id",t);o?(console.error("Error deleting art call:",o),X("Error deleting: "+o.message,"Error")):(X("Art call deleted successfully!","Success"),b(k,!1),D())}async function te(t){const{id:n,...o}=t;if(e(F)){const{error:v}=await Y.from("artCalls").update(o).eq("id",e(F).id);v?(console.error("Error updating art call:",v),X("Error updating: "+v.message,"Error")):(X("Art call updated successfully!","Success"),b(k,!1),D())}else{const{error:v}=await Y.from("artCalls").insert(o);v?(console.error("Error saving art call:",v),X("Error saving: "+v.message,"Error")):(X("Art call saved successfully!","Success"),b(k,!1),D())}}const fe=t=>A.getCallTypeLabel(t),re=t=>t===null?"—":`€${t}`,pe=t=>t?new Date(t).toLocaleDateString():"—";function ae(t,n=50){return t?t.length>n?t.slice(0,n)+"...":t:""}function S(t){if(!t)return{label:"Open",color:"bg-emerald-500",bg:"bg-emerald-500/10",text:"text-emerald-400",isOpen:!0};const n=new Date(t),o=new Date;return o.setHours(0,0,0,0),n.setHours(0,0,0,0),n>=o?{label:"Open",color:"bg-emerald-500",bg:"bg-emerald-500/10",text:"text-emerald-400",isOpen:!0}:{label:"Closed",color:"bg-red-500",bg:"bg-red-500/10",text:"text-red-400",isOpen:!1}}var Q=Xt(),R=$(Q);It(R,{get isOpen(){return e(k)},get entry(){return e(F)},onClose:()=>b(k,!1),onSave:te,onDelete:ee});var be=i(R,2),V=a(be),me=a(V);{var ie=t=>{var n=Bt();n.__click=Ce;var o=a(n);St(o,{class:"h-6 w-6 text-(--accent-color)"}),r(n),H((v,h)=>Pe(n,`--accent-color: ${v??""}; background-color: ${h??""}/50`),[()=>A.getAccentLightHex(),()=>A.getAccentHex()]),p(t,n)};z(me,t=>{e(l)&&!e(k)&&!Ot.isOpen&&t(ie)})}r(V);var ge=i(V,2);{var ne=t=>{var n=Mt(),o=a(n);{let v=W(()=>A.getAccentHex());Dt(o,{class:"h-6 w-6 animate-spin",get style(){return`color: ${e(v)??""}`}})}r(n),p(t,n)},xe=t=>{var n=Ne(),o=$(n);{var v=E=>{var q=Nt();p(E,q)},h=E=>{var q=Ne(),_e=$(q);{var se=I=>{var G=Pt();p(I,G)},De=I=>{const G=(m,c=wt)=>{const u=W(()=>S(c().deadline));var L=Qt();L.__click=()=>Oe(c());var J=a(L),de=a(J),Te=a(de),Le=a(Te),ce=a(Le),nt=a(ce,!0);r(ce);var ze=i(ce,2),st=a(ze,!0);r(ze);var ot=i(ze,2);{var lt=f=>{var g=qt();p(f,g)};z(ot,f=>{c().group&&f(lt)})}r(Le);var je=i(Le,2),He=a(je),dt=a(He,!0);r(He);var Ge=i(He,4),ct=a(Ge,!0);r(Ge),r(je),r(Te);var Je=i(Te,2),vt=a(Je);{var ut=f=>{var g=Gt();p(f,g)},ft=f=>{var g=Jt();H(()=>j(g,1,`text-base font-normal ${e(u).isOpen?"text-zinc-400":"text-zinc-500"}`)),p(f,g)};z(vt,f=>{c().applied?f(ut):f(ft,!1)})}r(Je),r(de);var Ke=i(de,2);{var pt=f=>{var g=Kt(),B=a(g),ve=a(B,!0);r(B),r(g),H(_t=>{j(B,1,`text-sm ${e(u).isOpen&&!c().applied?"text-zinc-300":"text-zinc-500"}`),w(ve,_t)},[()=>ae(c().idea)]),p(f,g)};z(Ke,f=>{c().idea&&f(pt)})}var Ue=i(Ke,2),Fe=a(Ue),Ie=a(Fe),Be=i(a(Ie),2),bt=a(Be,!0);r(Be),r(Ie);var Qe=i(Ie,2),Me=i(a(Qe),2),mt=a(Me,!0);r(Me),r(Qe),r(Fe);var gt=i(Fe,2);{var xt=f=>{var g=Ut();let B;g.__click=ve=>ve.stopPropagation(),H(ve=>{B=j(g,1,`rounded-md px-3 py-1.5 text-xs font-medium transition-colors ${e(u).isOpen?"":"bg-zinc-800/60 text-zinc-500 hover:bg-zinc-800"}`,null,B,{"text-[var(--btn-text)]":e(u).isOpen,"bg-[var(--btn-bg)]":e(u).isOpen,"hover:bg-[var(--btn-bg-hover)]":e(u).isOpen}),Pe(g,ve),Ve(g,"href",c().link)},[()=>e(u).isOpen?`--btn-bg: ${A.getAccentHex()}1a; --btn-text: ${A.getAccentLightHex()}; --btn-bg-hover: ${A.getAccentHex()}33;`:""]),p(f,g)};z(gt,f=>{c().link&&f(xt)})}r(Ue),r(J),r(L),H((f,g,B)=>{j(L,1,`group relative flex w-full cursor-pointer flex-col justify-between rounded-lg border p-4 text-left transition-all ${e(u).isOpen?"border-zinc-800 bg-zinc-900/60 hover:border-zinc-700 hover:bg-zinc-900/80":"border-zinc-800/60 bg-zinc-900/30 hover:border-zinc-700/60 hover:bg-zinc-900/40"}`),j(ce,1,`truncate text-base font-bold ${e(u).isOpen?"text-zinc-100":"text-zinc-500"}`),Ve(ce,"title",c().name),w(nt,c().name),j(ze,1,`shrink-0 rounded-full border px-2 py-0.5 text-[10px] font-medium ${e(u).bg} ${e(u).text} border-transparent text-center`),w(st,e(u).label),j(je,1,`mt-1 flex flex-wrap items-center gap-x-2 gap-y-1 text-xs ${e(u).isOpen?"text-zinc-400":"text-zinc-500"}`),w(dt,c().location),w(ct,f),j(Be,1,`text-sm font-medium ${e(u).isOpen?"text-emerald-400":"text-zinc-500"}`),w(bt,g),j(Me,1,`text-sm ${e(u).isOpen?"text-zinc-300":"text-zinc-500"}`),w(mt,B)},[()=>fe(c().type),()=>re(c().funds),()=>pe(c().deadline)]),p(m,L)};var oe=Wt(),le=$(oe),s=a(le),y=a(s);ye(y,20,()=>["name","funds","deadline","created","status"],we,(m,c)=>{var u=Rt(),L=a(u,!0);r(u);var J={};H(de=>{w(L,de),J!==(J=c)&&(u.value=(u.__value=c)??"")},[()=>c.charAt(0).toUpperCase()+c.slice(1)]),p(m,u)}),r(y);var T=i(y,2);T.__click=()=>b(_,e(_)==="asc"?"desc":"asc",!0);var Se=a(T);{var he=m=>{Tt(m,{class:"h-4 w-4"})},tt=m=>{Lt(m,{class:"h-4 w-4"})};z(Se,m=>{e(_)==="asc"?m(he):m(tt,!1)})}r(T),r(s);var qe=i(s,2),rt=a(qe);r(qe),r(le);var Ee=i(le,2);ye(Ee,21,()=>e(ue),we,(m,c)=>{G(m,()=>e(c))}),r(Ee);var at=i(Ee,2);{var it=m=>{var c=Vt(),u=i($(c),2);ye(u,21,()=>e(U),we,(L,J)=>{G(L,()=>e(J))}),r(u),p(m,c)};z(at,m=>{e(U).length>0&&m(it)})}H(()=>w(rt,`Applied ${e(Ae)??""} / ${e(P).length??""}`)),et(y,()=>e(C),m=>b(C,m)),p(I,oe)};z(_e,I=>{e(P).length===0?I(se):I(De,!1)},!0)}p(E,q)};z(o,E=>{e(l)?E(h,!1):E(v)},!0)}p(t,n)};z(ge,t=>{e(N)&&e(l)!==null?t(ne):t(xe,!1)})}r(be),p(ke,Q),Ze()}$e(["click"]);export{lr as component};
