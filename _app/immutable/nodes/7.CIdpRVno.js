import{b as he,d as Ae,c as ue,a as h,f as C}from"../chunks/B-wedEgi.js";import{F as T,h as xe,b as we,W as Me,X as Be,i as ye,C as Oe,e as Te,Y as je,Z as He,f as Le,g as $,p as ke,l as B,m as Fe,y as Re,t as b,k as X,a as Ne,z as a,A as r,B as i,D as qe,n as e,o as Ie,I as de}from"../chunks/DXU5jnQ_.js";import{d as Ce,s as Z,e as Ye}from"../chunks/CKrhTcXd.js";import{i as O}from"../chunks/1UUrSLx-.js";import{e as fe,s as be,i as me}from"../chunks/JHaZoCpa.js";import{r as ze,g as Ke,a as ce,t as Pe,e as M,f as Ve,c as We,d as Xe}from"../chunks/CpFvtbVR.js";import{s as W}from"../chunks/BW5xtwr9.js";import{b as ve}from"../chunks/jmEW5wUa.js";import{f as Ze}from"../chunks/BsCRBkET.js";import{F as Ge,A as Je}from"../chunks/Df4ok_nb.js";import{d as ee}from"../chunks/Ban-EeZC.js";import{A as Qe}from"../chunks/QpLyY0R8.js";function Ue(j,l,s=!1,k=!1,y=!1){var x=j,u="";T(()=>{var g=Me;if(u===(u=l()??"")){xe&&we();return}if(g.nodes!==null&&(Be(g.nodes.start,g.nodes.end),g.nodes=null),u!==""){if(xe){ye.data;for(var m=we(),c=m;m!==null&&(m.nodeType!==Oe||m.data!=="");)c=m,m=Te(m);if(m===null)throw je(),He;he(ye,c),x=Le(m);return}var f=u+"";s?f=`<svg>${f}</svg>`:k&&(f=`<math>${f}</math>`);var _=Ae(f);if((s||k)&&(_=$(_)),he($(_),_.lastChild),s||k)for(;$(_);)x.before($(_));else x.before(_)}})}var $e=C('<button type="button" class="h-8 w-8 rounded-full border border-zinc-700 transition-transform hover:scale-110 focus:ring-2 focus:ring-zinc-400 focus:outline-none"></button>'),et=C('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/70 p-2 backdrop-blur-sm md:p-4" role="dialog" aria-modal="true" tabindex="-1"><div class="flex max-h-[95vh] w-full max-w-2xl flex-col overflow-y-auto rounded-xl border border-zinc-800 bg-zinc-900 shadow-xl md:max-h-[90vh]"><div class="sticky top-0 z-10 flex items-center justify-between border-b border-zinc-800 bg-zinc-900 p-4 md:p-6"><h2 class="text-xl font-bold text-zinc-100"> </h2> <button class="text-zinc-400 transition-colors hover:text-zinc-200" aria-label="Close"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <form class="space-y-6 p-4 md:p-6"><div><label for="title" class="mb-1 block text-sm font-medium text-zinc-400">Title</label> <input type="text" id="title" required class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"/></div> <div><label for="body" class="mb-1 block text-sm font-medium text-zinc-400">Body</label> <textarea id="body" rows="10" class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"></textarea></div> <div><label for="color" class="mb-1 block text-sm font-medium text-zinc-400">Color</label> <div class="flex flex-wrap gap-2"></div> <input type="hidden" name="color"/></div> <div class="sticky bottom-0 mt-6 flex justify-end gap-3 border-t border-zinc-800 bg-zinc-900 pt-4"><button type="button" class="rounded-md bg-zinc-800 px-3.5 py-2.5 text-sm font-semibold text-zinc-200 shadow-sm ring-1 ring-zinc-700 ring-inset hover:bg-zinc-700">Cancel</button> <button type="submit" class="rounded-md px-3.5 py-2.5 text-sm font-semibold text-white shadow-sm transition-all hover:brightness-110 focus-visible:outline-2 focus-visible:outline-offset-2">Save</button></div></form></div></div>');function tt(j,l){ke(l,!0);let s=B(Fe({title:"",body:"",color:"#18181b"}));Re(()=>{l.isOpen&&(l.entry?b(s,{title:l.entry.title||"",body:l.entry.body||"",color:l.entry.color||"#18181b"},!0):b(s,{title:"",body:"",color:"#18181b"},!0))});function k(c){c.preventDefault(),l.onSave(e(s))}function y(c){c.target===c.currentTarget&&l.onClose()}function x(c){c.key==="Escape"&&l.onClose()}var u=ue(),g=X(u);{var m=c=>{var f=et();f.__click=y,f.__keydown=x;var _=a(f),H=a(_),L=a(H),te=a(L,!0);r(L);var re=i(L,2);re.__click=function(...o){l.onClose?.apply(this,o)},r(H);var D=i(H,2),A=a(D),F=i(a(A),2);ze(F),r(A);var E=i(A,2),G=i(a(E),2);qe(G),r(E);var R=i(E,2),q=i(a(R),2);fe(q,21,()=>ce.settings.notes_types,me,(o,d)=>{var w=$e();w.__click=()=>e(s).color=e(d).color??"#18181b",T(()=>{be(w,`background-color: ${e(d).color??""}; ${e(s).color===e(d).color?"border-color: white; transform: scale(1.1);":""}`),Ke(w,"aria-label",`Select color ${e(d).color??""}`)}),h(o,w)}),r(q);var J=i(q,2);ze(J),r(R);var t=i(R,2),n=a(t);n.__click=function(...o){l.onClose?.apply(this,o)};var v=i(n,2);r(t),r(D),r(_),r(f),T(o=>{Z(te,l.entry?"Edit Note":"New Note"),be(v,`background-color: ${o??""}`)},[()=>ce.getAccentHex()]),Ye("submit",D,k),ve(F,()=>e(s).title,o=>e(s).title=o),ve(G,()=>e(s).body,o=>e(s).body=o),ve(J,()=>e(s).color,o=>e(s).color=o),Pe(3,f,()=>Ze,()=>({duration:ce.getTransitionDuration()})),h(c,f)};O(g,c=>{l.isOpen&&c(m)})}h(j,u),Ne()}Ce(["click","keydown"]);var rt=C('<div class="rounded-lg border border-zinc-800 bg-zinc-900/60 p-6 text-zinc-400">Sign in to view notes.</div>'),ot=C('<div class="rounded-lg border border-zinc-800 bg-zinc-900/60 p-6 text-zinc-400">No notes yet.</div>'),at=C('<button><span class="capitalize"> </span> <!></button>'),st=C('<div class="prose prose-sm max-w-none wrap-break-word text-zinc-300 prose-invert"><!></div>'),it=C('<li class="group relative flex flex-col gap-4 rounded-lg border border-zinc-800 p-4 transition-all hover:border-zinc-700 hover:shadow-lg"><div class="flex flex-col gap-3"><h3 class="wrap-break-words text-lg font-bold text-zinc-100"> </h3> <!></div> <div class="mt-auto flex items-center justify-between gap-4 border-t border-zinc-800/50 pt-3"><div class="text-xs text-zinc-400/70"> </div> <div class="flex items-center gap-2"><button class="rounded-md p-2 text-indigo-400 transition-colors hover:bg-black/20 hover:text-indigo-300" aria-label="Edit"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg></button> <button class="rounded-md p-2 text-red-400 transition-colors hover:bg-black/20 hover:text-red-300" aria-label="Delete"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg></button></div></div></li>'),nt=C('<div class="mb-4 flex flex-wrap items-center gap-4 text-sm"><span class="text-zinc-500">Sort by:</span> <!> <span class="ml-auto text-xs text-zinc-500"> </span></div> <ul class="grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3"></ul>',1),lt=C('<!> <section class="space-y-6"><div class="flex flex-wrap items-center justify-between gap-4"><!></div> <!></section>',1);function wt(j,l){ke(l,!0);let s=B(null),k=de(()=>ee.notes),y=B(!1),x=B(null),u=B("created"),g=B("desc"),m=de(()=>[...e(k)].sort((t,n)=>{const v=e(g)==="asc"?1:-1;if(e(u)==="title")return(t.title||"").localeCompare(n.title||"")*v;if(e(u)==="created"){const o=new Date(t.created_at).getTime(),d=new Date(n.created_at).getTime();return(o-d)*v}return 0}));function c(t){e(u)===t?b(g,e(g)==="asc"?"desc":"asc",!0):(b(u,t,!0),b(g,"desc"))}Ie(()=>{W.auth.getSession().then(({data:{session:n}})=>{b(s,n,!0)});const{data:{subscription:t}}=W.auth.onAuthStateChange((n,v)=>{b(s,v,!0)});return()=>t.unsubscribe()});function f(){b(x,null),b(y,!0)}function _(t){b(x,t,!0),b(y,!0)}async function H(t){if(!await Xe("Are you sure you want to delete this note?","Delete Note",{confirmText:"Delete",isDestructive:!0}))return;const{error:v}=await W.from("notes").delete().eq("id",t);v?(console.error("Error deleting note:",v),M("Error deleting: "+v.message,"Error")):(M("Note deleted successfully!","Success"),ee.deleteNote(t))}async function L(t){const{id:n,...v}=t;if(e(x)){const{data:o,error:d}=await W.from("notes").update(v).eq("id",e(x).id).select().single();d?(console.error("Error updating note:",d),M("Error updating: "+d.message,"Error")):(M("Note updated successfully!","Success"),b(y,!1),o&&ee.updateNote(o))}else{const{data:o,error:d}=await W.from("notes").insert(v).select().single();d?(console.error("Error saving note:",d),M("Error saving: "+d.message,"Error")):(M("Note saved successfully!","Success"),b(y,!1),o&&ee.addNote(o))}}function te(t){return t?t.replace(/\n/g,"<br>"):""}function re(t,n=50){return t?t.length>n?t.slice(0,n)+"...":t:""}var D=lt(),A=X(D);tt(A,{get isOpen(){return e(y)},get entry(){return e(x)},onClose:()=>b(y,!1),onSave:L});var F=i(A,2),E=a(F),G=a(E);{let t=de(()=>!!(e(s)&&!e(y)&&!Ve.isOpen));Ge(G,{onclick:f,get visible(){return e(t)},ariaLabel:"New Note",bottomMobile:"8"})}r(E);var R=i(E,2);{var q=t=>{var n=rt();h(t,n)},J=t=>{var n=ue(),v=X(n);{var o=w=>{var Q=ot();h(w,Q)},d=w=>{var Q=nt(),oe=X(Q),ge=i(a(oe),2);fe(ge,16,()=>["created","title"],me,(ae,p)=>{var z=at();z.__click=()=>c(p);var S=a(z),I=a(S,!0);r(S);var se=i(S,2);{var ie=Y=>{var K=ue(),P=X(K);{var ne=N=>{Je(N,{class:"h-3 w-3"})},U=N=>{Qe(N,{class:"h-3 w-3"})};O(P,N=>{e(g)==="asc"?N(ne):N(U,!1)})}h(Y,K)};O(se,Y=>{e(u)===p&&Y(ie)})}r(z),T(()=>{We(z,1,`flex items-center gap-1 rounded-md px-3 py-1.5 transition-colors ${e(u)===p?"bg-indigo-500/20 text-indigo-300":"bg-zinc-800/50 text-zinc-400 hover:bg-zinc-800"}`),Z(I,p)}),h(ae,z)});var _e=i(ge,2),Ee=a(_e);r(_e),r(oe);var pe=i(oe,2);fe(pe,21,()=>e(m),me,(ae,p)=>{var z=it(),S=a(z),I=a(S),se=a(I,!0);r(I);var ie=i(I,2);{var Y=V=>{var le=st(),De=a(le);Ue(De,()=>te(re(e(p).body))),r(le),h(V,le)};O(ie,V=>{e(p).body&&V(Y)})}r(S);var K=i(S,2),P=a(K),ne=a(P,!0);r(P);var U=i(P,2),N=a(U);N.__click=()=>_(e(p));var Se=i(N,2);Se.__click=()=>H(e(p).id),r(U),r(K),r(z),T(V=>{be(z,`background-color: ${(e(p).color||"#18181b")??""}`),Z(se,e(p).title),Z(ne,V)},[()=>new Date(e(p).created_at).toLocaleDateString()]),h(ae,z)}),r(pe),T(()=>Z(Ee,`Amount of notes: ${e(k).length??""}`)),h(w,Q)};O(v,w=>{e(k).length===0?w(o):w(d,!1)},!0)}h(t,n)};O(R,t=>{e(s)?t(J,!1):t(q)})}r(F),h(j,D),Ne()}Ce(["click"]);export{wt as component};
