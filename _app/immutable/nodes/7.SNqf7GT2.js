import{b as ye,d as He,c as oe,a as f,f as w}from"../chunks/CQkslu6P.js";import{D as S,h as ze,b as ke,W as Re,X as qe,i as Ce,C as Fe,e as Pe,Y as Ye,Z as Ie,f as Je,g as re,p as De,v as k,w as Ne,x as Ke,y as l,k as B,a as Se,z as a,A as o,B as n,F as Ve,m as t,o as We,J as Xe}from"../chunks/CzM_H10X.js";import{d as Ae,s as Z,e as Ze}from"../chunks/C_B3uCM3.js";import{i as C}from"../chunks/DVrx_Uw8.js";import{e as _e,s as se,i as he}from"../chunks/CGOCP0_5.js";import{r as Ee,f as Ge,a as ae,c as O,d as Qe,e as Ue,g as $e}from"../chunks/BlwmmlO5.js";import{s as T}from"../chunks/BW5xtwr9.js";import{t as et,f as tt}from"../chunks/BL1b-Wf3.js";import{b as ge,L as rt}from"../chunks/DzRLBAai.js";import{P as ot}from"../chunks/BC-pPyRz.js";import{A as at,a as st}from"../chunks/DafGPu0x.js";function it(L,c,i=!1,x=!1,E=!1){var m=L,g="";S(()=>{var _=Re;if(g===(g=c()??"")){ze&&ke();return}if(_.nodes!==null&&(qe(_.nodes.start,_.nodes.end),_.nodes=null),g!==""){if(ze){Ce.data;for(var d=ke(),u=d;d!==null&&(d.nodeType!==Fe||d.data!=="");)u=d,d=Pe(d);if(d===null)throw Ye(),Ie;ye(Ce,u),m=Je(d);return}var b=g+"";i?b=`<svg>${b}</svg>`:x&&(b=`<math>${b}</math>`);var v=He(b);if((i||x)&&(v=re(v)),ye(re(v),v.lastChild),i||x)for(;re(v);)m.before(re(v));else m.before(v)}})}var nt=w('<button type="button" class="h-8 w-8 rounded-full border border-zinc-700 transition-transform hover:scale-110 focus:ring-2 focus:ring-zinc-400 focus:outline-none"></button>'),lt=w('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/70 p-2 backdrop-blur-sm md:p-4" role="dialog" aria-modal="true" tabindex="-1"><div class="flex max-h-[95vh] w-full max-w-2xl flex-col overflow-y-auto rounded-xl border border-zinc-800 bg-zinc-900 shadow-xl md:max-h-[90vh]"><div class="sticky top-0 z-10 flex items-center justify-between border-b border-zinc-800 bg-zinc-900 p-4 md:p-6"><h2 class="text-xl font-bold text-zinc-100"> </h2> <button class="text-zinc-400 transition-colors hover:text-zinc-200" aria-label="Close"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <form class="space-y-6 p-4 md:p-6"><div><label for="title" class="mb-1 block text-sm font-medium text-zinc-400">Title</label> <input type="text" id="title" required class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"/></div> <div><label for="body" class="mb-1 block text-sm font-medium text-zinc-400">Body</label> <textarea id="body" rows="10" class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"></textarea></div> <div><label for="color" class="mb-1 block text-sm font-medium text-zinc-400">Color</label> <div class="flex flex-wrap gap-2"></div> <input type="hidden" name="color"/></div> <div class="sticky bottom-0 mt-6 flex justify-end gap-3 border-t border-zinc-800 bg-zinc-900 pt-4"><button type="button" class="rounded-md bg-zinc-800 px-3.5 py-2.5 text-sm font-semibold text-zinc-200 shadow-sm ring-1 ring-zinc-700 ring-inset hover:bg-zinc-700">Cancel</button> <button type="submit" class="rounded-md px-3.5 py-2.5 text-sm font-semibold text-white shadow-sm transition-all hover:brightness-110 focus-visible:outline-2 focus-visible:outline-offset-2">Save</button></div></form></div></div>');function ct(L,c){De(c,!0);let i=k(Ne({title:"",body:"",color:"#18181b"}));Ke(()=>{c.isOpen&&(c.entry?l(i,{title:c.entry.title||"",body:c.entry.body||"",color:c.entry.color||"#18181b"},!0):l(i,{title:"",body:"",color:"#18181b"},!0))});function x(u){u.preventDefault(),c.onSave(t(i))}function E(u){u.target===u.currentTarget&&c.onClose()}function m(u){u.key==="Escape"&&c.onClose()}var g=oe(),_=B(g);{var d=u=>{var b=lt();b.__click=E,b.__keydown=m;var v=a(b),H=a(v),R=a(H),ie=a(R,!0);o(R);var ne=n(R,2);ne.__click=function(...e){c.onClose?.apply(this,e)},o(H);var q=n(H,2),F=a(q),P=n(a(F),2);Ee(P),o(F);var A=n(F,2),Y=n(a(A),2);Ve(Y),o(A);var D=n(A,2),I=n(a(D),2);_e(I,21,()=>ae.settings.notes_types,he,(e,r)=>{var s=nt();s.__click=()=>t(i).color=t(r).color??"#18181b",S(()=>{se(s,`background-color: ${t(r).color??""}; ${t(i).color===t(r).color?"border-color: white; transform: scale(1.1);":""}`),Ge(s,"aria-label",`Select color ${t(r).color??""}`)}),f(e,s)}),o(I);var G=n(I,2);Ee(G),o(D);var Q=n(D,2),U=a(Q);U.__click=function(...e){c.onClose?.apply(this,e)};var le=n(U,2);o(Q),o(q),o(v),o(b),S(e=>{Z(ie,c.entry?"Edit Note":"New Note"),se(le,`background-color: ${e??""}`)},[()=>ae.getAccentHex()]),Ze("submit",q,x),ge(P,()=>t(i).title,e=>t(i).title=e),ge(Y,()=>t(i).body,e=>t(i).body=e),ge(G,()=>t(i).color,e=>t(i).color=e),et(3,b,()=>tt,()=>({duration:ae.getTransitionDuration()})),f(u,b)};C(_,u=>{c.isOpen&&u(d)})}f(L,g),Se()}Ae(["click","keydown"]);var dt=w('<button class="fixed right-8 bottom-8 z-50 rounded-full p-4 text-white shadow-lg transition-all hover:scale-105 hover:brightness-110" aria-label="New Note"><!></button>'),vt=w('<div class="flex h-48 items-center justify-center"><!></div>'),ut=w('<div class="rounded-lg border border-zinc-800 bg-zinc-900/60 p-6 text-zinc-400">Sign in to view notes.</div>'),ft=w('<div class="rounded-lg border border-zinc-800 bg-zinc-900/60 p-6 text-zinc-400">No notes yet.</div>'),bt=w('<button><span class="capitalize"> </span> <!></button>'),mt=w('<div class="prose prose-sm max-w-none wrap-break-word text-zinc-300 prose-invert"><!></div>'),gt=w('<li class="group relative flex flex-col gap-4 rounded-lg border border-zinc-800 p-4 transition-all hover:border-zinc-700 hover:shadow-lg"><div class="flex flex-col gap-3"><h3 class="wrap-break-words text-lg font-bold text-zinc-100"> </h3> <!></div> <div class="mt-auto flex items-center justify-between gap-4 border-t border-zinc-800/50 pt-3"><div class="text-xs text-zinc-400/70"> </div> <div class="flex items-center gap-2"><button class="rounded-md p-2 text-indigo-400 transition-colors hover:bg-black/20 hover:text-indigo-300" aria-label="Edit"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg></button> <button class="rounded-md p-2 text-red-400 transition-colors hover:bg-black/20 hover:text-red-300" aria-label="Delete"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg></button></div></div></li>'),_t=w('<div class="mb-4 flex flex-wrap items-center gap-4 text-sm"><span class="text-zinc-500">Sort by:</span> <!> <span class="ml-auto text-xs text-zinc-500"> </span></div> <ul class="grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3"></ul>',1),ht=w('<!> <section class="space-y-6"><div class="flex flex-wrap items-center justify-between gap-4"><h2 class="hidden text-lg font-bold text-zinc-100 md:block">Notes</h2> <!></div> <!></section>',1);function At(L,c){De(c,!0);let i=k(null),x=k(!0),E=k(Ne([])),m=k(!1),g=k(null),_=k("created"),d=k("desc"),u=Xe(()=>[...t(E)].sort((e,r)=>{const s=t(d)==="asc"?1:-1;if(t(_)==="title")return(e.title||"").localeCompare(r.title||"")*s;if(t(_)==="created"){const h=new Date(e.created_at).getTime(),ce=new Date(r.created_at).getTime();return(h-ce)*s}return 0}));function b(e){t(_)===e?l(d,t(d)==="asc"?"desc":"asc",!0):(l(_,e,!0),l(d,"desc"))}We(()=>{T.auth.getSession().then(({data:{session:r}})=>{l(i,r,!0),r?v():l(x,!1)});const{data:{subscription:e}}=T.auth.onAuthStateChange((r,s)=>{l(i,s,!0),s?v():l(x,!1)});return()=>e.unsubscribe()});async function v(){l(x,!0),console.log("Fetching notes...");const{data:e,error:r}=await T.from("notes").select("id, created_at, title, body, color").order("created_at",{ascending:!1});!r&&e?l(E,e,!0):r&&console.error("Error fetching notes:",r),l(x,!1)}function H(){l(g,null),l(m,!0)}function R(e){l(g,e,!0),l(m,!0)}async function ie(e){if(!await $e("Are you sure you want to delete this note?","Delete Note",{confirmText:"Delete",isDestructive:!0}))return;const{error:s}=await T.from("notes").delete().eq("id",e);s?(console.error("Error deleting note:",s),O("Error deleting: "+s.message,"Error")):(O("Note deleted successfully!","Success"),v())}async function ne(e){const{id:r,...s}=e;if(t(g)){const{error:h}=await T.from("notes").update(s).eq("id",t(g).id);h?(console.error("Error updating note:",h),O("Error updating: "+h.message,"Error")):(O("Note updated successfully!","Success"),l(m,!1),v())}else{const{error:h}=await T.from("notes").insert(s);h?(console.error("Error saving note:",h),O("Error saving: "+h.message,"Error")):(O("Note saved successfully!","Success"),l(m,!1),v())}}function q(e){return e?e.replace(/\n/g,"<br>"):""}function F(e,r=50){return e?e.length>r?e.slice(0,r)+"...":e:""}var P=ht(),A=B(P);ct(A,{get isOpen(){return t(m)},get entry(){return t(g)},onClose:()=>l(m,!1),onSave:ne});var Y=n(A,2),D=a(Y),I=n(a(D),2);{var G=e=>{var r=dt();r.__click=H;var s=a(r);ot(s,{class:"h-6 w-6"}),o(r),S(h=>se(r,`background-color: ${h??""}`),[()=>ae.getAccentHex()]),f(e,r)};C(I,e=>{t(i)&&!t(m)&&!Qe.isOpen&&e(G)})}o(D);var Q=n(D,2);{var U=e=>{var r=vt(),s=a(r);rt(s,{class:"h-6 w-6 animate-spin text-indigo-400"}),o(r),f(e,r)},le=e=>{var r=oe(),s=B(r);{var h=M=>{var $=ut();f(M,$)},ce=M=>{var $=oe(),Me=B($);{var je=j=>{var ee=ft();f(j,ee)},Oe=j=>{var ee=_t(),de=B(ee),pe=n(a(de),2);_e(pe,16,()=>["created","title"],he,(ve,p)=>{var y=bt();y.__click=()=>b(p);var N=a(y),J=a(N,!0);o(N);var ue=n(N,2);{var fe=K=>{var V=oe(),W=B(V);{var be=z=>{at(z,{class:"h-3 w-3"})},te=z=>{st(z,{class:"h-3 w-3"})};C(W,z=>{t(d)==="asc"?z(be):z(te,!1)})}f(K,V)};C(ue,K=>{t(_)===p&&K(fe)})}o(y),S(()=>{Ue(y,1,`flex items-center gap-1 rounded-md px-3 py-1.5 transition-colors ${t(_)===p?"bg-indigo-500/20 text-indigo-300":"bg-zinc-800/50 text-zinc-400 hover:bg-zinc-800"}`),Z(J,p)}),f(ve,y)});var xe=n(pe,2),Te=a(xe);o(xe),o(de);var we=n(de,2);_e(we,21,()=>t(u),he,(ve,p)=>{var y=gt(),N=a(y),J=a(N),ue=a(J,!0);o(J);var fe=n(J,2);{var K=X=>{var me=mt(),Le=a(me);it(Le,()=>q(F(t(p).body))),o(me),f(X,me)};C(fe,X=>{t(p).body&&X(K)})}o(N);var V=n(N,2),W=a(V),be=a(W,!0);o(W);var te=n(W,2),z=a(te);z.__click=()=>R(t(p));var Be=n(z,2);Be.__click=()=>ie(t(p).id),o(te),o(V),o(y),S(X=>{se(y,`background-color: ${(t(p).color||"#18181b")??""}`),Z(ue,t(p).title),Z(be,X)},[()=>new Date(t(p).created_at).toLocaleDateString()]),f(ve,y)}),o(we),S(()=>Z(Te,`Amount of notes: ${t(E).length??""}`)),f(j,ee)};C(Me,j=>{t(E).length===0?j(je):j(Oe,!1)},!0)}f(M,$)};C(s,M=>{t(i)?M(ce,!1):M(h)},!0)}f(e,r)};C(Q,e=>{t(x)&&t(i)!==null?e(U):e(le,!1)})}o(Y),f(L,P),Se()}Ae(["click"]);export{At as component};
