import{b as pe,d as Le,c as V,a as g,f as z}from"../chunks/wK1Vbmlk.js";import{t as q,H as he,J as xe,K as Be,L as Pe,M as ye,N as Re,O as qe,P as Ie,Q as Fe,R as He,T as re,g as D,p as ze,s as N,c as ke,d as Ke,f as d,a as Ne,h as o,i as a,j as l,l as Je,k as t,n as Qe,o as Ye,v as Ge}from"../chunks/BYhnerF1.js";import{d as Ee,s as U,e as Ue}from"../chunks/DJuLYhV6.js";import{l as Ve,s as We,i as C}from"../chunks/D8lGRnAB.js";import{I as Xe,a as Ze,r as we,e as ve,h as Se,s as $e,i as fe,c as et,d as P,f as tt,g as rt}from"../chunks/Bwlg0huN.js";import{s as R}from"../chunks/Bkout0r_.js";import{b as ue,P as at,L as ot}from"../chunks/Kn-75_P5.js";import"../chunks/DU-Tk7Uy.js";import{T as st}from"../chunks/CMFy1DSP.js";import{A as it,a as nt}from"../chunks/CpuzINp4.js";function lt(E,n,s=!1,_=!1,k=!1){var m=E,u="";q(()=>{var f=Be;if(u===(u=n()??"")){he&&xe();return}if(f.nodes!==null&&(Pe(f.nodes.start,f.nodes.end),f.nodes=null),u!==""){if(he){ye.data;for(var c=xe(),b=c;c!==null&&(c.nodeType!==Re||c.data!=="");)b=c,c=qe(c);if(c===null)throw Ie(),Fe;pe(ye,b),m=He(c);return}var p=u+"";s?p=`<svg>${p}</svg>`:_&&(p=`<math>${p}</math>`);var v=Le(p);if((s||_)&&(v=re(v)),pe(re(v),v.lastChild),s||_)for(;re(v);)m.before(re(v));else m.before(v)}})}function dt(E,n){const s=Ve(n,["children","$$slots","$$events","$$legacy"]);const _=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z"}]];Xe(E,We({name:"pen"},()=>s,{get iconNode(){return _},children:(k,m)=>{var u=V(),f=D(u);Ze(f,n,"default",{}),g(k,u)},$$slots:{default:!0}}))}var ct=z('<button type="button" class="h-8 w-8 rounded-full border border-zinc-700 transition-transform hover:scale-110 focus:outline-none focus:ring-2 focus:ring-zinc-400"></button>'),ut=z('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/70 p-2 backdrop-blur-sm md:p-4" role="dialog" aria-modal="true" tabindex="-1"><div class="flex max-h-[95vh] w-full max-w-2xl flex-col overflow-y-auto rounded-xl border border-zinc-800 bg-zinc-900 shadow-xl md:max-h-[90vh]"><div class="sticky top-0 z-10 flex items-center justify-between border-b border-zinc-800 bg-zinc-900 p-4 md:p-6"><h2 class="text-xl font-bold text-zinc-100"> </h2> <button class="text-zinc-400 transition-colors hover:text-zinc-200" aria-label="Close"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <form class="space-y-6 p-4 md:p-6"><div><label for="title" class="mb-1 block text-sm font-medium text-zinc-400">Title</label> <input type="text" id="title" required class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"/></div> <div><label for="body" class="mb-1 block text-sm font-medium text-zinc-400">Body</label> <textarea id="body" rows="10" class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"></textarea></div> <div><label for="color" class="mb-1 block text-sm font-medium text-zinc-400">Color</label> <div class="flex gap-2"></div> <input type="hidden" name="color"/></div> <div class="sticky bottom-0 mt-6 flex justify-end gap-3 border-t border-zinc-800 bg-zinc-900 pt-4"><button type="button" class="rounded-md bg-zinc-800 px-3.5 py-2.5 text-sm font-semibold text-zinc-200 shadow-sm ring-1 ring-zinc-700 ring-inset hover:bg-zinc-700">Cancel</button> <button type="submit" class="rounded-md bg-indigo-600 px-3.5 py-2.5 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600">Save</button></div></form></div></div>');function vt(E,n){ze(n,!0);let s=N(ke({title:"",body:"",color:"#18181b"}));Ke(()=>{n.isOpen&&(n.entry?d(s,{title:n.entry.title||"",body:n.entry.body||"",color:n.entry.color||"#18181b"},!0):d(s,{title:"",body:"",color:"#18181b"},!0))});function _(b){b.preventDefault(),n.onSave(t(s))}function k(b){b.target===b.currentTarget&&n.onClose()}function m(b){b.key==="Escape"&&n.onClose()}var u=V(),f=D(u);{var c=b=>{var p=ut();p.__click=k,p.__keydown=m;var v=o(p),I=o(v),F=o(I),ae=o(F,!0);a(F);var oe=l(F,2);oe.__click=function(...e){n.onClose?.apply(this,e)},a(I);var H=l(I,2),T=o(H),K=l(o(T),2);we(K),a(T);var O=l(T,2),j=l(o(O),2);Je(j),a(O);var J=l(O,2),Q=l(o(J),2);ve(Q,20,()=>["#18181b","#7f1d1d","#7c2d12","#78350f","#365314","#064e3b","#134e4a","#0c4a6e","#1e3a8a","#312e81","#4c1d95","#701a75","#831843"],fe,(e,r)=>{var i=ct();i.__click=()=>t(s).color=r,q(()=>{Se(i,`background-color: ${r??""}; ${t(s).color===r?"border-color: white; transform: scale(1.1);":""}`),$e(i,"aria-label",`Select color ${r??""}`)}),g(e,i)}),a(Q);var W=l(Q,2);we(W),a(J);var X=l(J,2),se=o(X);se.__click=function(...e){n.onClose?.apply(this,e)},Qe(2),a(X),a(H),a(v),a(p),q(()=>U(ae,n.entry?"Edit Note":"New Note")),Ue("submit",H,_),ue(K,()=>t(s).title,e=>t(s).title=e),ue(j,()=>t(s).body,e=>t(s).body=e),ue(W,()=>t(s).color,e=>t(s).color=e),g(b,p)};C(f,b=>{n.isOpen&&b(c)})}g(E,u),Ne()}Ee(["click","keydown"]);var ft=z('<button class="fixed right-8 bottom-8 z-50 rounded-full bg-indigo-600 p-4 text-white shadow-lg transition-transform hover:scale-105 hover:bg-indigo-500" aria-label="New Note"><!></button>'),bt=z('<div class="flex h-48 items-center justify-center"><!></div>'),gt=z('<div class="rounded-lg border border-zinc-800 bg-zinc-900/60 p-6 text-zinc-400">Sign in to view notes.</div>'),mt=z('<div class="rounded-lg border border-zinc-800 bg-zinc-900/60 p-6 text-zinc-400">No notes yet.</div>'),_t=z('<button><span class="capitalize"> </span> <!></button>'),pt=z('<li class="group relative flex flex-col justify-between overflow-hidden rounded-lg border border-zinc-800/50 transition-all hover:border-zinc-700 hover:shadow-lg"><div class="flex flex-col gap-3 p-4"><div class="flex items-start justify-between gap-3"><h3 class="text-lg font-bold text-zinc-100 break-words"> </h3></div> <div class="prose prose-invert prose-sm max-w-none text-zinc-300 break-words"><!></div></div> <div class="absolute top-2 right-2 flex gap-2 opacity-0 transition-opacity group-hover:opacity-100"><button class="rounded-full bg-black/50 p-2 text-indigo-400 hover:bg-black/70 hover:text-indigo-300 backdrop-blur-sm" aria-label="Edit"><!></button> <button class="rounded-full bg-black/50 p-2 text-red-400 hover:bg-black/70 hover:text-red-300 backdrop-blur-sm" aria-label="Delete"><!></button></div> <div class="p-4 pt-0 text-xs text-zinc-400/70 mt-auto"> </div></li>'),ht=z('<div class="mb-4 flex flex-wrap items-center gap-4 text-sm"><span class="text-zinc-500">Sort by:</span> <!> <span class="ml-auto text-xs text-zinc-500"> </span></div> <ul class="grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3"></ul>',1),xt=z('<!> <section class="space-y-6"><div class="flex flex-wrap items-center justify-between gap-4"><h2 class="text-lg font-bold text-zinc-100">Notes</h2> <!></div> <!></section>',1);function Ot(E,n){ze(n,!0);let s=N(null),_=N(!0),k=N(ke([])),m=N(!1),u=N(null),f=N("created"),c=N("desc"),b=Ge(()=>[...t(k)].sort((e,r)=>{const i=t(c)==="asc"?1:-1;if(t(f)==="title")return(e.title||"").localeCompare(r.title||"")*i;if(t(f)==="created"){const h=new Date(e.created_at).getTime(),ie=new Date(r.created_at).getTime();return(h-ie)*i}return 0}));function p(e){t(f)===e?d(c,t(c)==="asc"?"desc":"asc",!0):(d(f,e,!0),d(c,"desc"))}Ye(()=>{R.auth.getSession().then(({data:{session:r}})=>{d(s,r,!0),r?v():d(_,!1)});const{data:{subscription:e}}=R.auth.onAuthStateChange((r,i)=>{d(s,i,!0),i?v():d(_,!1)});return()=>e.unsubscribe()});async function v(){d(_,!0),console.log("Fetching notes...");const{data:e,error:r}=await R.from("notes").select("id, created_at, title, body, color").order("created_at",{ascending:!1});!r&&e?d(k,e,!0):r&&console.error("Error fetching notes:",r),d(_,!1)}function I(){d(u,null),d(m,!0)}function F(e){d(u,e,!0),d(m,!0)}async function ae(e){if(!await rt("Are you sure you want to delete this note?","Delete Note",{confirmText:"Delete",isDestructive:!0}))return;const{error:i}=await R.from("notes").delete().eq("id",e);i?(console.error("Error deleting note:",i),P("Error deleting: "+i.message,"Error")):(P("Note deleted successfully!","Success"),v())}async function oe(e){const{id:r,...i}=e;if(t(u)){const{error:h}=await R.from("notes").update(i).eq("id",t(u).id);h?(console.error("Error updating note:",h),P("Error updating: "+h.message,"Error")):(P("Note updated successfully!","Success"),d(m,!1),v())}else{const{error:h}=await R.from("notes").insert(i);h?(console.error("Error saving note:",h),P("Error saving: "+h.message,"Error")):(P("Note saved successfully!","Success"),d(m,!1),v())}}function H(e){return e?e.replace(/\n/g,"<br>"):""}var T=xt(),K=D(T);vt(K,{get isOpen(){return t(m)},get entry(){return t(u)},onClose:()=>d(m,!1),onSave:oe});var O=l(K,2),j=o(O),J=l(o(j),2);{var Q=e=>{var r=ft();r.__click=I;var i=o(r);at(i,{class:"h-6 w-6"}),a(r),g(e,r)};C(J,e=>{t(s)&&!t(m)&&!et.isOpen&&e(Q)})}a(j);var W=l(j,2);{var X=e=>{var r=bt(),i=o(r);ot(i,{class:"h-6 w-6 animate-spin text-indigo-400"}),a(r),g(e,r)},se=e=>{var r=V(),i=D(r);{var h=M=>{var Z=gt();g(M,Z)},ie=M=>{var Z=V(),Ce=D(Z);{var De=A=>{var $=mt();g(A,$)},Te=A=>{var $=ht(),ne=D($),be=l(o(ne),2);ve(be,16,()=>["created","title"],fe,(le,x)=>{var y=_t();y.__click=()=>p(x);var S=o(y),Y=o(S,!0);a(S);var ee=l(S,2);{var de=L=>{var te=V(),G=D(te);{var B=w=>{it(w,{class:"h-3 w-3"})},ce=w=>{nt(w,{class:"h-3 w-3"})};C(G,w=>{t(c)==="asc"?w(B):w(ce,!1)})}g(L,te)};C(ee,L=>{t(f)===x&&L(de)})}a(y),q(()=>{tt(y,1,`flex items-center gap-1 rounded-md px-3 py-1.5 transition-colors ${t(f)===x?"bg-indigo-500/20 text-indigo-300":"bg-zinc-800/50 text-zinc-400 hover:bg-zinc-800"}`),U(Y,x)}),g(le,y)});var ge=l(be,2),Oe=o(ge);a(ge),a(ne);var me=l(ne,2);ve(me,21,()=>t(b),fe,(le,x)=>{var y=pt(),S=o(y),Y=o(S),ee=o(Y),de=o(ee,!0);a(ee),a(Y);var L=l(Y,2),te=o(L);lt(te,()=>H(t(x).body)),a(L),a(S);var G=l(S,2),B=o(G);B.__click=()=>F(t(x));var ce=o(B);dt(ce,{class:"h-4 w-4"}),a(B);var w=l(B,2);w.__click=()=>ae(t(x).id);var je=o(w);st(je,{class:"h-4 w-4"}),a(w),a(G);var _e=l(G,2),Me=o(_e,!0);a(_e),a(y),q(Ae=>{Se(y,`background-color: ${(t(x).color||"#18181b")??""}`),U(de,t(x).title),U(Me,Ae)},[()=>new Date(t(x).created_at).toLocaleDateString()]),g(le,y)}),a(me),q(()=>U(Oe,`Total: ${t(k).length??""}`)),g(A,$)};C(Ce,A=>{t(k).length===0?A(De):A(Te,!1)},!0)}g(M,Z)};C(i,M=>{t(s)?M(ie,!1):M(h)},!0)}g(e,r)};C(W,e=>{t(_)&&t(s)!==null?e(X):e(se,!1)})}a(O),g(E,T),Ne()}Ee(["click"]);export{Ot as component};
