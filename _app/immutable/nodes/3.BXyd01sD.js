import{c as fe,a as f,f as b}from"../chunks/o5v50Yvo.js";import{p as Ie,s as D,c as qe,d as et,f as c,g as J,a as Ge,h as n,i as a,j as i,n as Me,t as pe,k as e,o as tt,m as Te}from"../chunks/5_FoE8hS.js";import{d as Je,s as S,e as at}from"../chunks/vZxgl7By.js";import{i as z}from"../chunks/CRVHY2kJ.js";import{r as I,b as nt,a as q,e as Ne,c as Be,i as Fe,s as He,d as it}from"../chunks/DtXYkt4S.js";import{s as G}from"../chunks/Bkout0r_.js";import{b as te,a as rt,P as ot,L as st}from"../chunks/yjZnqevh.js";import{A as lt,a as dt}from"../chunks/Us6NLS3s.js";var ct=b('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/70 p-2 backdrop-blur-sm md:p-4" role="dialog" aria-modal="true" tabindex="-1"><div class="flex max-h-[95vh] w-full max-w-2xl flex-col overflow-y-auto rounded-xl border border-zinc-800 bg-zinc-900 shadow-xl md:max-h-[90vh]"><div class="sticky top-0 z-10 flex items-center justify-between border-b border-zinc-800 bg-zinc-900 p-4 md:p-6"><h2 class="text-xl font-bold text-zinc-100"> </h2> <button class="text-zinc-400 transition-colors hover:text-zinc-200" aria-label="Close"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <form class="space-y-6 p-4 md:p-6"><div><label for="name" class="mb-1 block text-sm font-medium text-zinc-400">Name</label> <input type="text" id="name" required class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"/></div> <div><label for="location" class="mb-1 block text-sm font-medium text-zinc-400">Location</label> <input type="text" id="location" class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"/></div> <div class="grid grid-cols-1 gap-6 md:grid-cols-2"><div><label for="type" class="mb-1 block text-sm font-medium text-zinc-400">Type</label> <select id="type" class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"><option>Select Type</option><option>Open Call</option><option>Residency</option><option>Grant</option><option>Job Offer</option><option>Other</option></select></div> <div><label for="funds" class="mb-1 block text-sm font-medium text-zinc-400">Funds (€)</label> <input type="number" id="funds" class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"/></div></div> <div><label for="deadline" class="mb-1 block text-sm font-medium text-zinc-400">Deadline</label> <input type="date" id="deadline" class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"/></div> <div><label for="link" class="mb-1 block text-sm font-medium text-zinc-400">Link</label> <input type="url" id="link" placeholder="https://" class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"/></div> <div class="flex items-center"><input type="checkbox" id="applied" class="h-4 w-4 rounded border-zinc-600 bg-zinc-800 text-indigo-600 focus:ring-indigo-500"/> <label for="applied" class="ml-2 block text-sm font-medium text-zinc-300">Applied</label></div> <div class="sticky bottom-0 mt-6 flex justify-end gap-3 border-t border-zinc-800 bg-zinc-900 pt-4"><button type="button" class="rounded-md bg-zinc-800 px-3.5 py-2.5 text-sm font-semibold text-zinc-200 shadow-sm ring-1 ring-zinc-700 ring-inset hover:bg-zinc-700">Cancel</button> <button type="submit" class="rounded-md bg-indigo-600 px-3.5 py-2.5 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600">Save</button></div></form></div></div>');function vt(me,l){Ie(l,!0);let d=D(qe({name:"",location:"",type:null,funds:null,deadline:"",link:"",applied:!1}));et(()=>{l.isOpen&&(l.entry?c(d,{name:l.entry.name||"",location:l.entry.location||"",type:l.entry.type,funds:l.entry.funds,deadline:l.entry.deadline?new Date(l.entry.deadline).toISOString().split("T")[0]:"",link:l.entry.link||"",applied:l.entry.applied||!1},!0):c(d,{name:"",location:"",type:null,funds:null,deadline:"",link:"",applied:!1},!0))});function E(u){u.preventDefault(),l.onSave(e(d))}function O(u){u.target===u.currentTarget&&l.onClose()}function P(u){u.key==="Escape"&&l.onClose()}var g=fe(),j=J(g);{var x=u=>{var L=ct();L.__click=O,L.__keydown=P;var ae=n(L),_=n(ae),R=n(_),be=n(R,!0);a(R);var ge=i(R,2);ge.__click=function(...s){l.onClose?.apply(this,s)},a(_);var V=i(_,2),K=n(V),ne=i(n(K),2);I(ne),a(K);var U=i(K,2),ie=i(n(U),2);I(ie),a(U);var B=i(U,2),F=n(B),H=i(n(F),2),M=n(H);M.value=(M.__value=null)??"";var Q=i(M);Q.value=Q.__value=1;var W=i(Q);W.value=W.__value=2;var X=i(W);X.value=X.__value=3;var Y=i(X);Y.value=Y.__value=4;var re=i(Y);re.value=re.__value=5,a(H),a(F);var t=i(F,2),r=i(n(t),2);I(r),a(t),a(B);var o=i(B,2),p=i(n(o),2);I(p),a(o);var T=i(o,2),h=i(n(T),2);I(h),a(T);var k=i(T,2),oe=n(k);I(oe),Me(2),a(k);var se=i(k,2),xe=n(se);xe.__click=function(...s){l.onClose?.apply(this,s)},Me(2),a(se),a(V),a(ae),a(L),pe(()=>S(be,l.entry?"Edit Art Call":"New Art Call")),at("submit",V,E),te(ne,()=>e(d).name,s=>e(d).name=s),te(ie,()=>e(d).location,s=>e(d).location=s),nt(H,()=>e(d).type,s=>e(d).type=s),te(r,()=>e(d).funds,s=>e(d).funds=s),te(p,()=>e(d).deadline,s=>e(d).deadline=s),te(h,()=>e(d).link,s=>e(d).link=s),rt(oe,()=>e(d).applied,s=>e(d).applied=s),f(u,L)};z(j,u=>{l.isOpen&&u(x)})}f(me,g),Ge()}Je(["click","keydown"]);var ut=b('<button class="fixed right-8 bottom-8 z-50 rounded-full bg-indigo-600 p-4 text-white shadow-lg transition-transform hover:scale-105 hover:bg-indigo-500" aria-label="New Art Call"><!></button>'),ft=b('<div class="flex h-48 items-center justify-center"><!></div>'),pt=b('<div class="rounded-lg border border-zinc-800 bg-zinc-900/60 p-6 text-zinc-400">Sign in to view art calls.</div>'),mt=b('<div class="rounded-lg border border-zinc-800 bg-zinc-900/60 p-6 text-zinc-400">No art calls yet.</div>'),bt=b('<button><span class="capitalize"> </span> <!></button>'),gt=b('<span class="text-xs font-medium text-emerald-400">Applied</span>'),xt=b('<span class="text-xs text-zinc-500">Not applied</span>'),_t=b('<a class="rounded-md bg-indigo-500/10 px-3 py-1.5 text-xs font-medium text-indigo-400 transition-colors hover:bg-indigo-500/20 hover:text-indigo-300" target="_blank" rel="noreferrer">Visit Link &rarr;</a>'),ht=b('<li class="group relative flex flex-col justify-between rounded-lg border border-zinc-800 bg-zinc-900/60 p-4 transition-all hover:border-zinc-700 hover:bg-zinc-900/80"><div class="flex flex-col gap-3"><div class="flex items-start justify-between gap-3"><div class="min-w-0 flex-1"><h3 class="truncate text-base font-bold text-zinc-100"> </h3> <div class="mt-1 flex flex-wrap items-center gap-x-2 gap-y-1 text-xs text-zinc-400"><span class="truncate"> </span> <span class="text-zinc-600">•</span> <span> </span></div></div> <div class="flex flex-col items-end gap-1"><div> </div> <!></div></div> <div class="mt-1 flex items-center justify-between gap-4 border-t border-zinc-800/50 pt-3"><div class="flex gap-6"><div class="flex flex-col gap-0.5"><span class="text-[10px] font-bold tracking-wider text-zinc-500 uppercase">Funds</span> <span class="text-sm font-medium text-emerald-400"> </span></div> <div class="flex flex-col gap-0.5"><span class="text-[10px] font-bold tracking-wider text-zinc-500 uppercase">Deadline</span> <span class="text-sm text-zinc-300"> </span></div></div> <div class="flex items-center gap-2"><!> <button class="rounded-md p-2 text-indigo-400 transition-colors hover:bg-zinc-800 hover:text-indigo-300" aria-label="Edit"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg></button> <button class="rounded-md p-2 text-red-400 transition-colors hover:bg-zinc-800 hover:text-red-300" aria-label="Delete"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg></button></div></div></div></li>'),wt=b('<div class="mb-4 flex flex-wrap items-center gap-4 text-sm"><span class="text-zinc-500">Sort by:</span> <!></div> <ul class="grid grid-cols-1 gap-3"></ul>',1),yt=b('<!> <section class="space-y-6"><div class="flex flex-wrap items-center justify-between gap-4"><h2 class="text-lg font-bold text-zinc-100">Art Calls</h2> <!></div> <!></section>',1);function jt(me,l){Ie(l,!0);const d={1:"Open Call",2:"Residency",3:"Grant",4:"Job Offer",5:"Other"};let E=D(null),O=D(!0),P=D(qe([])),g=D(!1),j=D(null),x=D("deadline"),u=D("asc"),L=Te(()=>[...e(P)].sort((t,r)=>{const o=e(u)==="asc"?1:-1;if(e(x)==="name")return t.name.localeCompare(r.name)*o;if(e(x)==="funds")return((t.funds??0)-(r.funds??0))*o;if(e(x)==="deadline"){const p=t.deadline?new Date(t.deadline).getTime():o===1?1/0:-1/0,T=r.deadline?new Date(r.deadline).getTime():o===1?1/0:-1/0;return(p-T)*o}return 0}));function ae(t){e(x)===t?c(u,e(u)==="asc"?"desc":"asc",!0):(c(x,t,!0),c(u,"asc"))}tt(()=>{G.auth.getSession().then(({data:{session:r}})=>{c(E,r,!0),r?_():c(O,!1)});const{data:{subscription:t}}=G.auth.onAuthStateChange((r,o)=>{c(E,o,!0),o?_():c(O,!1)});return()=>t.unsubscribe()});async function _(){c(O,!0),console.log("Fetching art calls...");const{data:t,error:r}=await G.from("artCalls").select("id, created_at, name, location, type, funds, deadline, link, applied").order("deadline",{ascending:!0});!r&&t?c(P,t,!0):r&&console.error("Error fetching art calls:",r),c(O,!1)}function R(){c(j,null),c(g,!0)}function be(t){c(j,t,!0),c(g,!0)}async function ge(t){if(!await it("Are you sure you want to delete this art call?","Delete Art Call",{confirmText:"Delete",isDestructive:!0}))return;const{error:o}=await G.from("artCalls").delete().eq("id",t);o?(console.error("Error deleting art call:",o),q("Error deleting: "+o.message,"Error")):(q("Art call deleted successfully!","Success"),_())}async function V(t){const{id:r,...o}=t;if(e(j)){const{error:p}=await G.from("artCalls").update(o).eq("id",e(j).id);p?(console.error("Error updating art call:",p),q("Error updating: "+p.message,"Error")):(q("Art call updated successfully!","Success"),c(g,!1),_())}else{const{error:p}=await G.from("artCalls").insert(o);p?(console.error("Error saving art call:",p),q("Error saving: "+p.message,"Error")):(q("Art call saved successfully!","Success"),c(g,!1),_())}}const K=t=>d[t??0]??"Unknown",ne=t=>t===null?"—":`€${t}`,U=t=>t?new Date(t).toLocaleDateString():"—";function ie(t){if(!t)return{label:"Open",color:"bg-emerald-500",bg:"bg-emerald-500/10",text:"text-emerald-400"};const r=new Date(t),o=new Date;return o.setHours(0,0,0,0),r.setHours(0,0,0,0),r>=o?{label:"Open",color:"bg-emerald-500",bg:"bg-emerald-500/10",text:"text-emerald-400"}:{label:"Closed",color:"bg-red-500",bg:"bg-red-500/10",text:"text-red-400"}}var B=yt(),F=J(B);vt(F,{get isOpen(){return e(g)},get entry(){return e(j)},onClose:()=>c(g,!1),onSave:V});var H=i(F,2),M=n(H),Q=i(n(M),2);{var W=t=>{var r=ut();r.__click=R;var o=n(r);ot(o,{class:"h-6 w-6"}),a(r),f(t,r)};z(Q,t=>{e(E)&&t(W)})}a(M);var X=i(M,2);{var Y=t=>{var r=ft(),o=n(r);st(o,{class:"h-6 w-6 animate-spin text-indigo-400"}),a(r),f(t,r)},re=t=>{var r=fe(),o=J(r);{var p=h=>{var k=pt();f(h,k)},T=h=>{var k=fe(),oe=J(k);{var se=s=>{var le=mt();f(s,le)},xe=s=>{var le=wt(),_e=J(le),Pe=i(n(_e),2);Ne(Pe,16,()=>["name","funds","deadline"],Fe,(he,v)=>{var w=bt();w.__click=()=>ae(v);var N=n(w),de=n(N,!0);a(N);var Z=i(N,2);{var $=C=>{var ce=fe(),ve=J(ce);{var ee=y=>{lt(y,{class:"h-3 w-3"})},we=y=>{dt(y,{class:"h-3 w-3"})};z(ve,y=>{e(u)==="asc"?y(ee):y(we,!1)})}f(C,ce)};z(Z,C=>{e(x)===v&&C($)})}a(w),pe(()=>{Be(w,1,`flex items-center gap-1 rounded-md px-3 py-1.5 transition-colors ${e(x)===v?"bg-indigo-500/20 text-indigo-300":"bg-zinc-800/50 text-zinc-400 hover:bg-zinc-800"}`),S(de,v)}),f(he,w)}),a(_e);var ke=i(_e,2);Ne(ke,21,()=>e(L),Fe,(he,v)=>{const w=Te(()=>ie(e(v).deadline));var N=ht(),de=n(N),Z=n(de),$=n(Z),C=n($),ce=n(C,!0);a(C);var ve=i(C,2),ee=n(ve),we=n(ee,!0);a(ee);var y=i(ee,4),Re=n(y,!0);a(y),a(ve),a($);var Ce=i($,2),ue=n(Ce),Ve=n(ue,!0);a(ue);var Ke=i(ue,2);{var Ue=m=>{var A=gt();f(m,A)},Qe=m=>{var A=xt();f(m,A)};z(Ke,m=>{e(v).applied?m(Ue):m(Qe,!1)})}a(Ce),a(Z);var Ae=i(Z,2),ye=n(Ae),ze=n(ye),De=i(n(ze),2),We=n(De,!0);a(De),a(ze);var Se=i(ze,2),Ee=i(n(Se),2),Xe=n(Ee,!0);a(Ee),a(Se),a(ye);var Oe=i(ye,2),je=n(Oe);{var Ye=m=>{var A=_t();pe(()=>He(A,"href",e(v).link)),f(m,A)};z(je,m=>{e(v).link&&m(Ye)})}var Le=i(je,2);Le.__click=()=>be(e(v));var Ze=i(Le,2);Ze.__click=()=>ge(e(v).id),a(Oe),a(Ae),a(de),a(N),pe((m,A,$e)=>{He(C,"title",e(v).name),S(ce,e(v).name),S(we,e(v).location),S(Re,m),Be(ue,1,`shrink-0 rounded-full border px-2 py-0.5 text-[10px] font-medium ${e(w).bg} ${e(w).text} border-transparent text-center`),S(Ve,e(w).label),S(We,A),S(Xe,$e)},[()=>K(e(v).type),()=>ne(e(v).funds),()=>U(e(v).deadline)]),f(he,N)}),a(ke),f(s,le)};z(oe,s=>{e(P).length===0?s(se):s(xe,!1)},!0)}f(h,k)};z(o,h=>{e(E)?h(T,!1):h(p)},!0)}f(t,r)};z(X,t=>{e(O)&&e(E)!==null?t(Y):t(re,!1)})}a(H),f(me,B),Ge()}Je(["click"]);export{jt as component};
