import{c as Ge,a as v,f}from"../chunks/CQkslu6P.js";import{p as ht,v as W,w as zt,x as At,y,k as G,a as yt,z as i,A as t,B as o,D,m as e,F as St,G as Lt,o as Et,I as xt,J as X}from"../chunks/CzM_H10X.js";import{d as kt,s as j,e as $e}from"../chunks/C_B3uCM3.js";import{i as T}from"../chunks/DVrx_Uw8.js";import{e as Z,i as $,s as Le,c as jt}from"../chunks/CGOCP0_5.js";import{r as De,a as Y,b as pt,e as M,c as Ae,d as Ot,f as Bt,g as Mt}from"../chunks/BlwmmlO5.js";import{s as Se}from"../chunks/BW5xtwr9.js";import{t as Ht,f as It}from"../chunks/BL1b-Wf3.js";import{b as me,L as Nt}from"../chunks/DzRLBAai.js";import{T as ft}from"../chunks/BiMU5MKp.js";import{G as Ut,S as qt,E as Ft,L as Pt,a as Gt}from"../chunks/BYr84kHp.js";import{P as wt}from"../chunks/BC-pPyRz.js";import{S as Rt}from"../chunks/BazncEnm.js";import{A as Wt,a as Jt}from"../chunks/DafGPu0x.js";var Kt=f("<option> </option>"),Vt=f("<div></div>"),Qt=f("<option> </option>"),Xt=f('<div class="flex items-center gap-2"><button type="button" class="text-zinc-400 hover:text-zinc-200"><!></button> <input type="text" placeholder="Item description..."/> <div class="flex items-center gap-1"><div role="button" tabindex="0" class="cursor-grab p-1 text-zinc-600 hover:text-zinc-400 active:cursor-grabbing" draggable="true"><!></div> <button type="button" class="p-1 text-zinc-500 hover:text-red-400"><!></button></div></div>'),Yt=f('<div class="rounded-lg border border-zinc-800 bg-zinc-800/30 p-4"><div class="mb-3 flex items-center justify-between gap-2"><input type="text" placeholder="Checklist Title" class="w-full bg-transparent text-sm font-bold text-zinc-200 placeholder-zinc-600 focus:outline-none"/> <button type="button" class="text-zinc-600 hover:text-red-400" title="Remove Checklist"><!></button></div> <div class="space-y-2"><!> <button type="button" class="mt-2 flex items-center gap-1 text-xs text-zinc-500 hover:text-zinc-300"><!> Add Item</button></div></div>'),Zt=f('<div class="space-y-6"></div>'),$t=f('<div class="rounded-lg border border-dashed border-zinc-800 p-4 text-center"><p class="text-sm text-zinc-500">No checklists yet</p></div>'),er=f('<div class="flex items-center gap-2"><div class="grid flex-1 grid-cols-1 gap-2 md:grid-cols-2"><input type="text" placeholder="Label (optional)" class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-sm text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"/> <input type="text" placeholder="URL" class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-sm text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"/></div> <button type="button" class="p-2 text-zinc-400 hover:text-indigo-400" title="Open Link"><!></button> <button type="button" class="p-2 text-zinc-400 hover:text-red-400" title="Remove Link"><!></button></div>'),tr=f('<div class="space-y-2"></div>'),rr=f('<div class="rounded-lg border border-dashed border-zinc-800 p-4 text-center"><p class="text-sm text-zinc-500">No links yet</p></div>'),ar=f('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/70 p-2 backdrop-blur-sm md:p-4" role="dialog" aria-modal="true" tabindex="-1"><div class="flex max-h-[95vh] w-full max-w-2xl flex-col overflow-y-auto rounded-xl border border-zinc-800 bg-zinc-900 shadow-xl md:max-h-[90vh]"><div class="sticky top-0 z-10 flex items-center justify-between border-b border-zinc-800 bg-zinc-900 p-4 md:p-6"><h2 class="text-xl font-bold text-zinc-100"> </h2> <button class="text-zinc-400 transition-colors hover:text-zinc-200" aria-label="Close"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <form class="space-y-6 p-4 md:p-6"><div><label for="title" class="mb-1 block text-sm font-medium text-zinc-400">Title</label> <input type="text" id="title" required class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"/></div> <div class="grid grid-cols-1 gap-6 md:grid-cols-2"><div><label for="type" class="mb-1 block text-sm font-medium text-zinc-400">Type</label> <div class="flex items-center gap-2"><select id="type" class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"><option>Select Type</option><!></select> <!></div></div> <div><label for="status" class="mb-1 block text-sm font-medium text-zinc-400">Status</label> <select id="status" class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"></select></div></div> <div class="grid grid-cols-1 gap-6 md:grid-cols-2"><div><label for="deadline_at" class="mb-1 block text-sm font-medium text-zinc-400">Deadline</label> <input type="date" id="deadline_at" class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"/></div></div> <div><label for="body" class="mb-1 block text-sm font-medium text-zinc-400">Description</label> <textarea id="body" rows="3" class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"></textarea></div> <div class="space-y-4"><div class="flex items-center justify-between"><span class="block text-sm font-medium text-zinc-400">Checklists</span> <button type="button" class="text-xs transition-colors hover:brightness-125">+ Add Checklist</button></div> <!></div> <div class="space-y-4"><div class="flex items-center justify-between"><span class="block text-sm font-medium text-zinc-400">Links</span> <button type="button" class="text-xs transition-colors hover:brightness-125">+ Add Link</button></div> <!></div> <div class="sticky bottom-0 mt-6 flex justify-end gap-3 border-t border-zinc-800 bg-zinc-900 pt-4"><button type="button" class="rounded-md bg-zinc-800 px-3.5 py-2.5 text-sm font-semibold text-zinc-200 shadow-sm ring-1 ring-zinc-700 ring-inset hover:bg-zinc-700">Cancel</button> <button type="submit" class="rounded-md px-3.5 py-2.5 text-sm font-semibold text-white shadow-sm transition-all hover:brightness-110 focus-visible:outline-2 focus-visible:outline-offset-2">Save</button></div></form></div></div>');function ir(et,p){ht(p,!0);let r=W(zt({title:"",type:"",status:"todo",body:"",deadline_at:"",completed_at:null,color:"#000000",checklist:[],links:[]})),O=W(null);const ee=[{value:"todo",label:"To Do"},{value:"in_progress",label:"In Progress"},{value:"done",label:"Done"}];At(()=>{p.isOpen&&(p.entry?y(r,{title:p.entry.title||"",type:p.entry.type||"",status:p.entry.status||"todo",body:p.entry.body||"",deadline_at:p.entry.deadline_at||"",completed_at:p.entry.completed_at||null,color:p.entry.color||"#000000",checklist:Array.isArray(p.entry.checklist)&&p.entry.checklist.length>0?"items"in p.entry.checklist[0]?p.entry.checklist:[{id:crypto.randomUUID(),title:"Checklist",items:p.entry.checklist}]:[],links:Array.isArray(p.entry.links)?p.entry.links:[]},!0):y(r,{title:"",type:"",status:"todo",body:"",deadline_at:"",completed_at:null,color:"#000000",checklist:[],links:[]},!0))});function J(c){c.preventDefault(),e(r).status==="done"?e(r).completed_at||(e(r).completed_at=new Date().toISOString()):e(r).completed_at=null;const d={...e(r),deadline_at:e(r).deadline_at||null};p.onSave(d)}function se(c){c.target===c.currentTarget&&p.onClose()}function U(c){c.key==="Escape"&&p.onClose()}function le(){e(r).checklist=[...e(r).checklist,{id:crypto.randomUUID(),title:"New Checklist",items:[]}]}function xe(c){e(r).checklist=e(r).checklist.filter((d,k)=>k!==c)}function tt(c){const d=e(r).checklist[c];d.items=[...d.items,{text:"",completed:!1}],e(r).checklist[c]=d}function Re(c,d){const k=e(r).checklist[c];k.items=k.items.filter((H,q)=>q!==d),e(r).checklist[c]=k}function rt(c,d){const k=e(r).checklist[c];k.items[d].completed=!k.items[d].completed,e(r).checklist[c]=k}function We(c,d,k){y(O,{listIndex:d,itemIndex:k},!0),c.dataTransfer&&(c.dataTransfer.effectAllowed="move",c.dataTransfer.dropEffect="move")}function at(c,d,k){if(c.preventDefault(),!e(O)||e(O).listIndex!==d||e(O).itemIndex===k)return;const H=e(r).checklist[d],q=e(O).itemIndex,de=k,ve=H.items[q],K=[...H.items];K.splice(q,1),K.splice(de,0,ve),H.items=K,e(r).checklist[d]=H,e(O).itemIndex=de}function it(){y(O,null)}function ce(){if(e(r).type){const c=Y.getTaskType(e(r).type);c&&c.color&&(e(r).color=c.color)}}function ot(){e(r).links=[...e(r).links,{url:"",label:""}]}function nt(c){e(r).links=e(r).links.filter((d,k)=>k!==c)}function st(c){if(!c)return;let d=c;/^https?:\/\//i.test(d)||(d="https://"+d),window.open(d,"_blank","noopener,noreferrer")}var Je=Ge(),Ke=G(Je);{var lt=c=>{var d=ar();d.__click=se,d.__keydown=U;var k=i(d),H=i(k),q=i(H),de=i(q,!0);t(q);var ve=o(q,2);ve.__click=function(...n){p.onClose?.apply(this,n)},t(H);var K=o(H,2),Ee=i(K),Ve=o(i(Ee),2);De(Ve),t(Ee);var je=o(Ee,2),Oe=i(je),a=o(i(Oe),2),s=i(a);s.__change=ce;var u=i(s);u.value=u.__value="";var h=o(u);Z(h,17,()=>Y.settings.task_types,$,(n,g)=>{var _=Kt(),z=i(_,!0);t(_);var w={};D(()=>{j(z,e(g).label),w!==(w=e(g).id)&&(_.value=(_.__value=e(g).id)??"")}),v(n,_)}),t(s);var F=o(s,2);{var te=n=>{var g=Vt();let _;D(z=>{_=M(g,1,"h-8 w-8 shrink-0 rounded-full border border-zinc-600 shadow-sm",null,_,{"bg-zinc-500":e(r).color==="bg-zinc-500","bg-red-600":e(r).color==="bg-red-600","bg-orange-600":e(r).color==="bg-orange-600","bg-amber-500":e(r).color==="bg-amber-500","bg-green-600":e(r).color==="bg-green-600","bg-emerald-500":e(r).color==="bg-emerald-500","bg-teal-500":e(r).color==="bg-teal-500","bg-cyan-500":e(r).color==="bg-cyan-500","bg-blue-600":e(r).color==="bg-blue-600","bg-indigo-600":e(r).color==="bg-indigo-600","bg-violet-600":e(r).color==="bg-violet-600","bg-purple-600":e(r).color==="bg-purple-600","bg-fuchsia-600":e(r).color==="bg-fuchsia-600","bg-pink-600":e(r).color==="bg-pink-600","bg-rose-600":e(r).color==="bg-rose-600"}),Le(g,z)},[()=>e(r).color.startsWith("#")?`background-color: ${e(r).color}`:""]),v(n,g)};T(F,n=>{e(r).color&&n(te)})}t(a),t(Oe);var ue=o(Oe,2),Be=o(i(ue),2);Z(Be,21,()=>ee,$,(n,g)=>{var _=Qt(),z=i(_,!0);t(_);var w={};D(()=>{j(z,e(g).label),w!==(w=e(g).value)&&(_.value=(_.__value=e(g).value)??"")}),v(n,_)}),t(Be),t(ue),t(je);var Me=o(je,2),Qe=i(Me),V=o(i(Qe),2);De(V),t(Qe),t(Me);var re=o(Me,2),He=o(i(re),2);St(He),t(re);var ge=o(re,2),be=i(ge),he=o(i(be),2);he.__click=le,t(be);var Ie=o(be,2);{var ct=n=>{var g=Zt();Z(g,21,()=>e(r).checklist,$,(_,z,w)=>{var N=Yt(),P=i(N),E=i(P);De(E);var S=o(E,2);S.__click=()=>xe(w);var R=i(S);ft(R,{class:"h-4 w-4"}),t(S),t(P);var Q=o(P,2),ae=i(Q);Z(ae,17,()=>e(z).items,$,(ke,we,Te)=>{var Ue=Xt(),pe=i(Ue);pe.__click=()=>rt(w,Te);var ut=i(pe);{var Ye=L=>{Rt(L,{class:"h-5 w-5 text-emerald-500"})},qe=L=>{qt(L,{class:"h-5 w-5"})};T(ut,L=>{e(we).completed?L(Ye):L(qe,!1)})}t(pe);var oe=o(pe,2);De(oe);var Ce=o(oe,2),ne=i(Ce),gt=i(ne);Ut(gt,{class:"h-4 w-4"}),t(ne);var Fe=o(ne,2);Fe.__click=()=>Re(w,Te);var Ze=i(Fe);ft(Ze,{class:"h-3 w-3"}),t(Fe),t(Ce),t(Ue),D(()=>M(oe,1,`w-full rounded-md border border-zinc-700 bg-zinc-800 p-1.5 text-sm text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 ${e(we).completed?"text-zinc-500 line-through":""}`)),me(oe,()=>e(we).text,L=>e(we).text=L),$e("dragstart",ne,L=>We(L,w,Te)),$e("dragover",ne,L=>at(L,w,Te)),$e("dragend",ne,it),v(ke,Ue)});var ie=o(ae,2);ie.__click=()=>tt(w);var fe=i(ie);wt(fe,{class:"h-3 w-3"}),Lt(),t(ie),t(Q),t(N),me(E,()=>e(z).title,ke=>e(z).title=ke),v(_,N)}),t(g),v(n,g)},Xe=n=>{var g=$t();v(n,g)};T(Ie,n=>{e(r).checklist&&e(r).checklist.length>0?n(ct):n(Xe,!1)})}t(ge);var ze=o(ge,2),Ne=i(ze),ye=o(i(Ne),2);ye.__click=ot,t(Ne);var dt=o(Ne,2);{var vt=n=>{var g=tr();Z(g,21,()=>e(r).links,$,(_,z,w)=>{var N=er(),P=i(N),E=i(P);De(E);var S=o(E,2);De(S),t(P);var R=o(P,2);R.__click=()=>st(e(z).url);var Q=i(R);Ft(Q,{class:"h-4 w-4"}),t(R);var ae=o(R,2);ae.__click=()=>nt(w);var ie=i(ae);ft(ie,{class:"h-4 w-4"}),t(ae),t(N),D(()=>R.disabled=!e(z).url),me(E,()=>e(z).label,fe=>e(z).label=fe),me(S,()=>e(z).url,fe=>e(z).url=fe),v(_,N)}),t(g),v(n,g)},A=n=>{var g=rr();v(n,g)};T(dt,n=>{e(r).links&&e(r).links.length>0?n(vt):n(A,!1)})}t(ze);var l=o(ze,2),b=i(l);b.__click=function(...n){p.onClose?.apply(this,n)};var I=o(b,2);t(l),t(K),t(k),t(d),D((n,g,_)=>{j(de,p.entry?"Edit Task":"New Task"),Le(he,`color: ${n??""}`),Le(ye,`color: ${g??""}`),Le(I,`background-color: ${_??""}`)},[()=>Y.getAccentLightHex(),()=>Y.getAccentLightHex(),()=>Y.getAccentHex()]),$e("submit",K,J),me(Ve,()=>e(r).title,n=>e(r).title=n),pt(s,()=>e(r).type,n=>e(r).type=n),pt(Be,()=>e(r).status,n=>e(r).status=n),me(V,()=>e(r).deadline_at,n=>e(r).deadline_at=n),me(He,()=>e(r).body,n=>e(r).body=n),Ht(3,d,()=>It,()=>({duration:Y.getTransitionDuration()})),v(c,d)};T(Ke,c=>{p.isOpen&&c(lt)})}v(et,Je),yt()}kt(["click","keydown","change"]);var or=f('<button class="fixed right-8 bottom-8 z-50 rounded-full p-4 text-white shadow-lg transition-all hover:scale-105 hover:brightness-110" aria-label="New Task"><!></button>'),nr=f('<div class="flex h-48 items-center justify-center"><!></div>'),sr=f('<div class="rounded-lg border border-zinc-800 bg-zinc-900/60 p-6 text-zinc-400">Sign in to view tasks.</div>'),lr=f('<div class="rounded-lg border border-zinc-800 bg-zinc-900/60 p-6 text-zinc-400">No tasks yet.</div>'),cr=f('<div title="Task Color"></div>'),dr=f('<span class="text-zinc-500">•</span> <span> </span>',1),vr=f('<span class="text-zinc-500">•</span> <!> <span> </span>',1),ur=f('<span class="text-zinc-500">•</span> <!> <span> </span>',1),gr=f("<p> </p>"),br=f('<div class="flex flex-col gap-0.5"><span class="text-[10px] font-bold tracking-wider text-zinc-500 uppercase">Completed</span> <span> </span></div>'),fr=f('<li><div class="flex flex-col gap-3"><div class="flex items-start justify-between gap-3"><div class="min-w-0 flex-1"><div class="flex flex-wrap items-center gap-2"><!> <h3> </h3></div> <div class="mt-1 flex items-center gap-2 text-xs"><div> </div> <!> <!> <!></div></div></div> <!> <div class="mt-2 flex items-center justify-between gap-4 border-t border-zinc-800/50 pt-3"><div class="flex gap-4"><div class="flex flex-col gap-0.5"><span class="text-[10px] font-bold tracking-wider text-zinc-500 uppercase">Deadline</span> <span> </span></div> <!></div> <div class="flex items-center gap-2"><button class="rounded-md p-2 text-indigo-400 transition-colors hover:bg-zinc-800 hover:text-indigo-300" aria-label="Edit"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg></button> <button class="rounded-md p-2 text-red-400 transition-colors hover:bg-zinc-800 hover:text-red-300" aria-label="Delete"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg></button></div></div></div></li>'),pr=f("<option> </option>"),_r=f('<button><span class="capitalize"> </span> <!></button>'),mr=f('<div class="my-8 flex items-center gap-4"><div class="h-px flex-1 bg-zinc-800"></div> <span class="text-sm font-medium tracking-wider text-zinc-500 uppercase">Archived</span> <div class="h-px flex-1 bg-zinc-800"></div></div> <ul class="grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3"></ul>',1),xr=f('<div class="mb-4 flex flex-wrap items-center gap-4 text-sm"><div class="flex items-center gap-2"><span class="text-zinc-500">Filter:</span> <select class="cursor-pointer rounded-md border border-zinc-700 bg-zinc-800 px-3 py-1.5 text-sm text-zinc-100 shadow-sm outline-none focus:border-indigo-500 focus:ring-indigo-500"><option>All Tasks</option><!></select></div> <div class="h-4 w-px bg-zinc-800"></div> <span class="text-zinc-500">Sort by:</span> <!> <span class="ml-auto text-xs text-zinc-500"> </span></div> <ul class="grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3"></ul> <!>',1),hr=f('<!> <section class="space-y-6"><div class="flex flex-wrap items-center justify-between gap-4"><h2 class="hidden text-lg font-bold text-zinc-100 md:block">Tasks</h2> <!></div> <!></section>',1);function Mr(et,p){ht(p,!0);let r=W(null),O=W(!0),ee=W(zt([])),J=W(!1),se=W(null),U=W("deadline"),le=W("asc"),xe=W("all"),tt=X(()=>e(xe)==="all"?e(ee):e(ee).filter(a=>a.type===e(xe))),Re=X(()=>[...e(tt)].sort((a,s)=>{const u=e(le)==="asc"?1:-1;if(e(U)==="title")return(a.title||"").localeCompare(s.title||"")*u;if(e(U)==="deadline"){const h=a.deadline_at?new Date(a.deadline_at).getTime():u===1?1/0:-1/0,F=s.deadline_at?new Date(s.deadline_at).getTime():u===1?1/0:-1/0;return(h-F)*u}else if(e(U)==="completed"){const h=a.completed_at?new Date(a.completed_at).getTime():0,F=s.completed_at?new Date(s.completed_at).getTime():0;return(h-F)*u}else if(e(U)==="created"){const h=new Date(a.created_at).getTime(),F=new Date(s.created_at).getTime();return(h-F)*u}else if(e(U)==="status")return(a.status||"").localeCompare(s.status||"")*u;return 0})),rt=X(()=>e(Re).filter(a=>a.status!=="done")),We=X(()=>e(Re).filter(a=>a.status==="done")),at=X(()=>e(ee).filter(a=>a.status==="done").length);function it(a){e(U)===a?y(le,e(le)==="asc"?"desc":"asc",!0):(y(U,a,!0),y(le,"asc"))}Et(()=>{Se.auth.getSession().then(({data:{session:s}})=>{y(r,s,!0),s?ce():y(O,!1)});const{data:{subscription:a}}=Se.auth.onAuthStateChange((s,u)=>{y(r,u,!0),u?ce():y(O,!1)});return()=>a.unsubscribe()});async function ce(){y(O,!0),console.log("Fetching tasks...");const{data:a,error:s}=await Se.from("tasks").select("*").order("deadline_at",{ascending:!0});!s&&a?y(ee,a,!0):s&&console.error("Error fetching tasks:",s),y(O,!1)}function ot(){y(se,null),y(J,!0)}function nt(a){y(se,a,!0),y(J,!0)}async function st(a){if(!await Mt("Are you sure you want to delete this task?","Delete Task",{confirmText:"Delete",isDestructive:!0}))return;const{error:u}=await Se.from("tasks").delete().eq("id",a);u?(console.error("Error deleting task:",u),Ae("Error deleting: "+u.message,"Error")):(Ae("Task deleted successfully!","Success"),ce())}async function Je(a){const{id:s,...u}=a;if(e(se)){const{error:h}=await Se.from("tasks").update(u).eq("id",e(se).id);h?(console.error("Error updating task:",h),Ae("Error updating: "+h.message,"Error")):(Ae("Task updated successfully!","Success"),y(J,!1),ce())}else{const{error:h}=await Se.from("tasks").insert(u);h?(console.error("Error saving task:",h),Ae("Error saving: "+h.message,"Error")):(Ae("Task saved successfully!","Success"),y(J,!1),ce())}}const Ke=a=>a?new Date(a).toLocaleDateString():"—";function lt(a,s=50){return a?a.length>s?a.slice(0,s)+"...":a:""}function c(a){switch(a){case"todo":return{bg:"bg-zinc-500/10",text:"text-zinc-400",border:"border-zinc-500/20"};case"in_progress":return{bg:"bg-indigo-500/10",text:"text-indigo-400",border:"border-indigo-500/20"};case"done":return{bg:"bg-emerald-500/10",text:"text-emerald-400",border:"border-emerald-500/20"};case"archived":return{bg:"bg-zinc-800",text:"text-zinc-500",border:"border-zinc-700"};default:return{bg:"bg-zinc-500/10",text:"text-zinc-400",border:"border-zinc-500/20"}}}function d(a){return a?a.split("_").map(s=>s.charAt(0).toUpperCase()+s.slice(1)).join(" "):"Unknown"}function k(a){if(!a)return{total:0,completed:0};if(Array.isArray(a)&&a.length>0&&"items"in a[0]){let s=0,u=0;return a.forEach(h=>{h.items&&(s+=h.items.length,u+=h.items.filter(F=>F.completed).length)}),{total:s,completed:u}}return Array.isArray(a)&&a.length>0?{total:a.length,completed:a.filter(s=>s.completed).length}:{total:0,completed:0}}var H=hr(),q=G(H);ir(q,{get isOpen(){return e(J)},get entry(){return e(se)},onClose:()=>y(J,!1),onSave:Je});var de=o(q,2),ve=i(de),K=o(i(ve),2);{var Ee=a=>{var s=or();s.__click=ot;var u=i(s);wt(u,{class:"h-6 w-6"}),t(s),D(h=>Le(s,`background-color: ${h??""}`),[()=>Y.getAccentHex()]),v(a,s)};T(K,a=>{e(r)&&!e(J)&&!Ot.isOpen&&a(Ee)})}t(ve);var Ve=o(ve,2);{var je=a=>{var s=nr(),u=i(s);Nt(u,{class:"h-6 w-6 animate-spin text-indigo-400"}),t(s),v(a,s)},Oe=a=>{var s=Ge(),u=G(s);{var h=te=>{var ue=sr();v(te,ue)},F=te=>{var ue=Ge(),Be=G(ue);{var Me=V=>{var re=lr();v(V,re)},Qe=V=>{const re=(A,l=xt,b=xt)=>{const I=X(()=>c(l().status));var n=fr(),g=i(n),_=i(g),z=i(_),w=i(z),N=i(w);{var P=m=>{var x=cr();D((C,B)=>{M(x,1,C),Le(x,B)},[()=>`h-3 w-3 rounded-full ${b()?"opacity-50":""} ${l().color.startsWith("bg-")?l().color:""}`,()=>l().color.startsWith("bg-")?"":`background-color: ${l().color}`]),v(m,x)};T(N,m=>{l().color&&m(P)})}var E=o(N,2),S=i(E,!0);t(E),t(w);var R=o(w,2),Q=i(R),ae=i(Q,!0);t(Q);var ie=o(Q,2);{var fe=m=>{var x=dr(),C=o(G(x),2),B=i(C,!0);t(C),D(_e=>{M(C,1,jt(b()?"text-zinc-600":"text-zinc-400")),j(B,_e)},[()=>Y.getTaskType(l().type)?.label??l().type]),v(m,x)};T(ie,m=>{l().type&&m(fe)})}var ke=o(ie,2);{var we=m=>{const x=X(()=>k(l().checklist));var C=Ge(),B=G(C);{var _e=Pe=>{var _t=vr(),mt=o(G(_t),2);{let Dt=X(()=>`h-4 w-4 ${b()?"text-zinc-600":"text-zinc-400"}`);Gt(mt,{get class(){return e(Dt)}})}var bt=o(mt,2),Ct=i(bt);t(bt),D(()=>{M(bt,1,`text-xs ${b()?"text-zinc-600":"text-zinc-500"}`),j(Ct,`${e(x).completed??""}/${e(x).total??""}`)}),v(Pe,_t)};T(B,Pe=>{e(x).total>0&&Pe(_e)})}v(m,C)};T(ke,m=>{l().checklist&&m(we)})}var Te=o(ke,2);{var Ue=m=>{var x=ur(),C=o(G(x),2);{let Pe=X(()=>`h-4 w-4 ${b()?"text-zinc-600":"text-zinc-400"}`);Pt(C,{get class(){return e(Pe)}})}var B=o(C,2),_e=i(B,!0);t(B),D(()=>{M(B,1,`text-xs ${b()?"text-zinc-600":"text-zinc-500"}`),j(_e,l().links.length)}),v(m,x)};T(Te,m=>{l().links&&l().links.length>0&&m(Ue)})}t(R),t(z),t(_);var pe=o(_,2);{var ut=m=>{var x=gr(),C=i(x,!0);t(x),D(B=>{M(x,1,`text-sm ${b()?"text-zinc-600":"text-zinc-400"}`),j(C,B)},[()=>lt(l().body)]),v(m,x)};T(pe,m=>{l().body&&m(ut)})}var Ye=o(pe,2),qe=i(Ye),oe=i(qe),Ce=o(i(oe),2),ne=i(Ce,!0);t(Ce),t(oe);var gt=o(oe,2);{var Fe=m=>{var x=br(),C=o(i(x),2),B=i(C,!0);t(C),t(x),D(_e=>{M(C,1,`text-xs ${b()?"text-zinc-500":"text-emerald-400"}`),j(B,_e)},[()=>Ke(l().completed_at)]),v(m,x)};T(gt,m=>{l().completed_at&&m(Fe)})}t(qe);var Ze=o(qe,2),L=i(Ze);L.__click=()=>nt(l());var Tt=o(L,2);Tt.__click=()=>st(l().id),t(Ze),t(Ye),t(g),t(n),D((m,x)=>{M(n,1,`group relative flex flex-col justify-between rounded-lg border p-4 transition-all ${b()?"border-zinc-800/60 bg-zinc-900/30 text-zinc-500 hover:border-zinc-700/60 hover:bg-zinc-900/40":"border-zinc-800 bg-zinc-900/60 hover:border-zinc-700 hover:bg-zinc-900/80"}`),M(E,1,`truncate text-base font-bold ${b()?"text-zinc-500":"text-zinc-100"}`),Bt(E,"title",l().title),j(S,l().title),M(Q,1,`shrink-0 rounded-full px-2 py-0.5 font-medium ${e(I).bg} ${e(I).text}`),j(ae,m),M(Ce,1,`text-xs ${b()?"text-zinc-500":"text-zinc-300"}`),j(ne,x)},[()=>d(l().status),()=>Ke(l().deadline_at)]),v(A,n)};var He=xr(),ge=G(He),be=i(ge),he=o(i(be),2),Ie=i(he);Ie.value=Ie.__value="all";var ct=o(Ie);Z(ct,17,()=>Y.settings.task_types,$,(A,l)=>{var b=pr(),I=i(b,!0);t(b);var n={};D(()=>{j(I,e(l).label),n!==(n=e(l).id)&&(b.value=(b.__value=e(l).id)??"")}),v(A,b)}),t(he),t(be);var Xe=o(be,6);Z(Xe,16,()=>["title","deadline","created","status","completed"],$,(A,l)=>{var b=_r();b.__click=()=>it(l);var I=i(b),n=i(I,!0);t(I);var g=o(I,2);{var _=z=>{var w=Ge(),N=G(w);{var P=S=>{Wt(S,{class:"h-3 w-3"})},E=S=>{Jt(S,{class:"h-3 w-3"})};T(N,S=>{e(le)==="asc"?S(P):S(E,!1)})}v(z,w)};T(g,z=>{e(U)===l&&z(_)})}t(b),D(()=>{M(b,1,`flex items-center gap-1 rounded-md px-3 py-1.5 transition-colors ${e(U)===l?"bg-indigo-500/20 text-indigo-300":"bg-zinc-800/50 text-zinc-400 hover:bg-zinc-800"}`),j(n,l)}),v(A,b)});var ze=o(Xe,2),Ne=i(ze);t(ze),t(ge);var ye=o(ge,2);Z(ye,21,()=>e(rt),$,(A,l)=>{re(A,()=>e(l),()=>!1)}),t(ye);var dt=o(ye,2);{var vt=A=>{var l=mr(),b=o(G(l),2);Z(b,21,()=>e(We),$,(I,n)=>{re(I,()=>e(n),()=>!0)}),t(b),v(A,l)};T(dt,A=>{e(We).length>0&&A(vt)})}D(()=>j(Ne,`Completed ${e(at)??""} / ${e(ee).length??""}`)),pt(he,()=>e(xe),A=>y(xe,A)),v(V,He)};T(Be,V=>{e(ee).length===0?V(Me):V(Qe,!1)},!0)}v(te,ue)};T(u,te=>{e(r)?te(F,!1):te(h)},!0)}v(a,s)};T(Ve,a=>{e(O)&&e(r)!==null?a(je):a(Oe,!1)})}t(de),v(et,H),yt()}kt(["click"]);export{Mr as component};
