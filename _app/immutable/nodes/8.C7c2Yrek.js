import{c as Qt,a as d,f as u}from"../chunks/7NWlc7Su.js";import{p as Be,v as st,w as Ie,x as Xe,y as p,k as it,a as Re,z as r,A as e,B as n,F as Ze,D as M,m as t,G as $e,o as tr,I as at,J as Ge}from"../chunks/BVFz32Il.js";import{d as Ye,s as N,e as ze}from"../chunks/pKnFB2my.js";import{i as h}from"../chunks/Ds4RlZDk.js";import{e as ot,i as lt,s as ct,c as We}from"../chunks/CP7c8dVT.js";import{r as bt,a as dt,b as Ue,f as E,c as er,d as Jt,e as rr,L as ar,g as nr}from"../chunks/RPGm4AHo.js";import{s as Kt}from"../chunks/BW5xtwr9.js";import{t as ir,f as sr}from"../chunks/DbLlv7u-.js";import{b as nt,P as Ve}from"../chunks/CX8rbiYm.js";import{T as He}from"../chunks/D6KFCUkc.js";import{G as or,S as lr,E as cr,C as dr,L as vr,a as ur}from"../chunks/C2sp_6na.js";import{S as gr}from"../chunks/CbEtCGLT.js";import{L as fr}from"../chunks/CuxWYXv5.js";import{A as mr}from"../chunks/D9mXmw9u.js";import{A as br}from"../chunks/CgHzHeUi.js";var _r=u("<option> </option>"),pr=u("<div></div>"),xr=u('<div class="flex items-center gap-2"><button type="button" class="text-zinc-400 hover:text-zinc-200"><!></button> <input type="text" placeholder="Item description..."/> <div class="flex items-center gap-1"><div role="button" tabindex="0" class="cursor-grab p-1 text-zinc-600 hover:text-zinc-400 active:cursor-grabbing" draggable="true"><!></div> <button type="button" class="p-1 text-zinc-500 hover:text-red-400"><!></button></div></div>'),hr=u('<div class="rounded-lg border border-zinc-800 bg-zinc-800/30 p-4"><div class="mb-3 flex items-center justify-between gap-2"><input type="text" placeholder="Checklist Title" class="w-full bg-transparent text-sm font-bold text-zinc-200 placeholder-zinc-600 focus:outline-none"/> <button type="button" class="text-zinc-600 hover:text-red-400" title="Remove Checklist"><!></button></div> <div class="space-y-2"><!> <button type="button" class="mt-2 flex items-center gap-1 text-xs text-zinc-500 hover:text-zinc-300"><!> Add Item</button></div></div>'),zr=u('<div class="space-y-6"></div>'),wr=u('<div class="rounded-lg border border-dashed border-zinc-800 p-4 text-center"><p class="text-sm text-zinc-500">No checklists yet</p></div>'),yr=u('<div class="flex items-center gap-2"><div class="grid flex-1 grid-cols-1 gap-2 md:grid-cols-2"><input type="text" placeholder="Label (optional)" class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-sm text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"/> <input type="text" placeholder="URL" class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-sm text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"/></div> <button type="button" class="p-2 text-zinc-400 hover:text-indigo-400" title="Open Link"><!></button> <button type="button" class="p-2 text-zinc-400 hover:text-red-400" title="Remove Link"><!></button></div>'),kr=u('<div class="space-y-2"></div>'),Dr=u('<div class="rounded-lg border border-dashed border-zinc-800 p-4 text-center"><p class="text-sm text-zinc-500">No links yet</p></div>'),Cr=u('<button type="button" class="rounded-md bg-red-500/10 px-3.5 py-2.5 text-sm font-semibold text-red-400 shadow-sm ring-1 ring-red-500/20 transition-colors ring-inset hover:bg-red-500/20">Delete</button>'),Tr=u('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/70 p-2 backdrop-blur-sm md:p-4" role="dialog" aria-modal="true" tabindex="-1"><div class="flex max-h-[95vh] w-full max-w-2xl flex-col overflow-y-auto rounded-xl border border-zinc-800 bg-zinc-900 shadow-xl md:max-h-[90vh]"><div class="sticky top-0 z-10 flex items-center justify-between border-b border-zinc-800 bg-zinc-900 p-4 md:p-6"><h2 class="text-xl font-bold text-zinc-100"> </h2> <button class="text-zinc-400 transition-colors hover:text-zinc-200" aria-label="Close"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <form class="space-y-6 p-4 md:p-6"><div><label for="name" class="mb-1 block text-sm font-medium text-zinc-400">Name</label> <input type="text" id="name" required class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"/></div> <div><label for="description" class="mb-1 block text-sm font-medium text-zinc-400">Description</label> <textarea id="description" rows="3" class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"></textarea></div> <div class="grid grid-cols-1 gap-6 md:grid-cols-2"><div><label for="status" class="mb-1 block text-sm font-medium text-zinc-400">Status</label> <select id="status" class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"><option>Not Started</option><option>In Progress</option><option>Postponed</option><option>Completed</option><option>Cancelled</option></select></div> <div><label for="funds" class="mb-1 block text-sm font-medium text-zinc-400">Funds (€)</label> <input type="number" id="funds" class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"/></div></div> <div class="grid grid-cols-1 gap-6 md:grid-cols-2"><div><label for="percentage" class="mb-1 block text-sm font-medium text-zinc-400"> </label> <input type="range" id="percentage" min="0" max="100" class="h-2 w-full cursor-pointer appearance-none rounded-lg bg-zinc-700 accent-indigo-500"/></div> <div><label for="type" class="mb-1 block text-sm font-medium text-zinc-400">Type</label> <div class="flex items-center gap-2"><select id="type" class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"><option>Select Type</option><!></select> <!></div></div></div> <div class="grid grid-cols-1 gap-6 md:grid-cols-2"><div><label for="start_at" class="mb-1 block text-sm font-medium text-zinc-400">Start Date</label> <input type="date" id="start_at" class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"/></div> <div><label for="end_at" class="mb-1 block text-sm font-medium text-zinc-400">End Date</label> <input type="date" id="end_at" class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"/></div></div> <div class="space-y-4"><div class="flex items-center justify-between"><span class="block text-sm font-medium text-zinc-400">Checklists</span> <button type="button" class="text-xs transition-colors hover:brightness-125">+ Add Checklist</button></div> <!></div> <div class="space-y-4"><div class="flex items-center justify-between"><span class="block text-sm font-medium text-zinc-400">Links</span> <button type="button" class="text-xs transition-colors hover:brightness-125">+ Add Link</button></div> <!></div> <div class="sticky bottom-0 mt-6 flex justify-between gap-3 border-t border-zinc-800 bg-zinc-900 pt-4"><div><!></div> <div class="flex gap-3"><button type="button" class="rounded-md bg-zinc-800 px-3.5 py-2.5 text-sm font-semibold text-zinc-200 shadow-sm ring-1 ring-zinc-700 ring-inset hover:bg-zinc-700">Cancel</button> <button type="submit" class="rounded-md px-3.5 py-2.5 text-sm font-semibold text-white shadow-sm transition-all hover:brightness-110 focus-visible:outline-2 focus-visible:outline-offset-2">Save</button></div></div></form></div></div>');function Sr(we,g){Be(g,!0);let i=st(Ie({name:"",description:"",funds:null,status:0,type:null,percentage:0,start_at:"",end_at:"",colour:"bg-indigo-600",checklist:[],links:[]})),G=st(null);Xe(()=>{g.isOpen&&(g.entry?p(i,{name:g.entry.name||"",description:g.entry.description||"",funds:g.entry.funds,status:g.entry.status??0,type:g.entry.type??null,percentage:g.entry.percentage??0,start_at:g.entry.start_at?new Date(g.entry.start_at).toISOString().split("T")[0]:"",end_at:g.entry.end_at?new Date(g.entry.end_at).toISOString().split("T")[0]:"",colour:g.entry.colour||"bg-indigo-600",checklist:Array.isArray(g.entry.checklist)?g.entry.checklist:[],links:Array.isArray(g.entry.links)?g.entry.links:[]},!0):p(i,{name:"",description:"",funds:null,status:0,type:null,percentage:0,start_at:"",end_at:"",colour:"bg-indigo-600",checklist:[],links:[]},!0))});function wt(){if(t(i).type){const c=dt.getProjectType(t(i).type);c&&c.color&&(t(i).colour=c.color)}}function yt(c){c.preventDefault(),g.onSave(t(i))}function Z(c){c.target===c.currentTarget&&g.onClose()}function kt(c){c.key==="Escape"&&g.onClose()}function Dt(){t(i).checklist=[...t(i).checklist,{id:crypto.randomUUID(),title:"New Checklist",items:[]}]}function Ct(c){t(i).checklist=t(i).checklist.filter((f,z)=>z!==c)}function Nt(c){const f=t(i).checklist[c];f.items=[...f.items,{text:"",completed:!1}],t(i).checklist[c]=f}function Xt(c,f){const z=t(i).checklist[c];z.items=z.items.filter((V,$)=>$!==f),t(i).checklist[c]=z}function ye(c,f){const z=t(i).checklist[c];z.items[f].completed=!z.items[f].completed,t(i).checklist[c]=z}function me(c,f,z){p(G,{listIndex:f,itemIndex:z},!0),c.dataTransfer&&(c.dataTransfer.effectAllowed="move",c.dataTransfer.dropEffect="move")}function ke(c,f,z){if(c.preventDefault(),!t(G)||t(G).listIndex!==f||t(G).itemIndex===z)return;const V=t(i).checklist[f],$=t(G).itemIndex,Ft=z,Ot=V.items[$],tt=[...V.items];tt.splice($,1),tt.splice(Ft,0,Ot),V.items=tt,t(i).checklist[f]=V,t(G).itemIndex=Ft}function F(){p(G,null)}function De(){t(i).links=[...t(i).links,{url:"",label:""}]}function Tt(c){t(i).links=t(i).links.filter((f,z)=>z!==c)}function Ce(c){if(!c)return;let f=c;/^https?:\/\//i.test(f)||(f="https://"+f),window.open(f,"_blank","noopener,noreferrer")}var be=Qt(),Te=it(be);{var Se=c=>{var f=Tr();f.__click=Z,f.__keydown=kt;var z=r(f),V=r(z),$=r(V),Ft=r($,!0);e($);var Ot=n($,2);Ot.__click=function(...s){g.onClose?.apply(this,s)},e(V);var tt=n(V,2),Ht=r(tt),Ut=n(r(Ht),2);bt(Ut),e(Ht);var Zt=n(Ht,2),_e=n(r(Zt),2);Ze(_e),e(Zt);var $t=n(Zt,2),te=r($t),ee=n(r(te),2),a=r(ee);a.value=a.__value=0;var o=n(a);o.value=o.__value=1;var m=n(o);m.value=m.__value=2;var b=n(m);b.value=b.__value=3;var D=n(b);D.value=D.__value=4,e(ee),e(te);var j=n(te,2),O=n(r(j),2);bt(O),e(j),e($t);var W=n($t,2),S=r(W),re=r(S),_t=r(re);e(re);var St=n(re,2);bt(St),e(S);var qt=n(S,2),Gt=n(r(qt),2),pt=r(Gt);pt.__change=wt;var xt=r(pt);xt.value=(xt.__value=null)??"";var ae=n(xt);ot(ae,17,()=>dt.settings.project_types,lt,(s,v)=>{var _=_r(),k=r(_,!0);e(_);var L={};M(()=>{N(k,t(v).label),L!==(L=t(v).id)&&(_.value=(_.__value=t(v).id)??"")}),d(s,_)}),e(pt);var Ae=n(pt,2);{var Le=s=>{var v=pr();let _;M(k=>{_=E(v,1,"h-8 w-8 shrink-0 rounded-full border border-zinc-600 shadow-sm",null,_,{"bg-zinc-500":t(i).colour==="bg-zinc-500","bg-red-600":t(i).colour==="bg-red-600","bg-orange-600":t(i).colour==="bg-orange-600","bg-amber-500":t(i).colour==="bg-amber-500","bg-green-600":t(i).colour==="bg-green-600","bg-emerald-500":t(i).colour==="bg-emerald-500","bg-teal-500":t(i).colour==="bg-teal-500","bg-cyan-500":t(i).colour==="bg-cyan-500","bg-blue-600":t(i).colour==="bg-blue-600","bg-indigo-600":t(i).colour==="bg-indigo-600","bg-violet-600":t(i).colour==="bg-violet-600","bg-purple-600":t(i).colour==="bg-purple-600","bg-fuchsia-600":t(i).colour==="bg-fuchsia-600","bg-pink-600":t(i).colour==="bg-pink-600","bg-rose-600":t(i).colour==="bg-rose-600"}),ct(v,k)},[()=>t(i).colour.startsWith("#")?`background-color: ${t(i).colour}`:""]),d(s,v)};h(Ae,s=>{t(i).colour&&s(Le)})}e(Gt),e(qt),e(W);var ne=n(W,2),Wt=r(ne),Bt=n(r(Wt),2);bt(Bt),e(Wt);var pe=n(Wt,2),ie=n(r(pe),2);bt(ie),e(pe),e(ne);var vt=n(ne,2),se=r(vt),At=n(r(se),2);At.__click=Dt,e(se);var Pe=n(se,2);{var Ee=s=>{var v=zr();ot(v,21,()=>t(i).checklist,lt,(_,k,L)=>{var K=hr(),Q=r(K),R=r(Q);bt(R);var Y=n(R,2);Y.__click=()=>Ct(L);var X=r(Y);He(X,{class:"h-4 w-4"}),e(Y),e(Q);var It=n(Q,2),rt=r(It);ot(rt,17,()=>t(k).items,lt,(le,Lt,Pt)=>{var Rt=xr(),Et=r(Rt);Et.__click=()=>ye(L,Pt);var xe=r(Et);{var ce=x=>{gr(x,{class:"h-5 w-5 text-emerald-500"})},de=x=>{lr(x,{class:"h-5 w-5"})};h(xe,x=>{t(Lt).completed?x(ce):x(de,!1)})}e(Et);var Yt=n(Et,2);bt(Yt);var he=n(Yt,2),zt=r(he),P=r(zt);or(P,{class:"h-4 w-4"}),e(zt);var T=n(zt,2);T.__click=()=>Xt(L,Pt);var q=r(T);He(q,{class:"h-3 w-3"}),e(T),e(he),e(Rt),M(()=>E(Yt,1,`w-full rounded-md border border-zinc-700 bg-zinc-800 p-1.5 text-sm text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 ${t(Lt).completed?"text-zinc-500 line-through":""}`)),nt(Yt,()=>t(Lt).text,x=>t(Lt).text=x),ze("dragstart",zt,x=>me(x,L,Pt)),ze("dragover",zt,x=>ke(x,L,Pt)),ze("dragend",zt,F),d(le,Rt)});var ht=n(rt,2);ht.__click=()=>Nt(L);var gt=r(ht);Ve(gt,{class:"h-3 w-3"}),$e(),e(ht),e(It),e(K),nt(R,()=>t(k).title,le=>t(k).title=le),d(_,K)}),e(v),d(s,v)},Me=s=>{var v=wr();d(s,v)};h(Pe,s=>{t(i).checklist&&t(i).checklist.length>0?s(Ee):s(Me,!1)})}e(vt);var oe=n(vt,2),w=r(oe),H=n(r(w),2);H.__click=De,e(w);var B=n(w,2);{var J=s=>{var v=kr();ot(v,21,()=>t(i).links,lt,(_,k,L)=>{var K=yr(),Q=r(K),R=r(Q);bt(R);var Y=n(R,2);bt(Y),e(Q);var X=n(Q,2);X.__click=()=>Ce(t(k).url);var It=r(X);cr(It,{class:"h-4 w-4"}),e(X);var rt=n(X,2);rt.__click=()=>Tt(L);var ht=r(rt);He(ht,{class:"h-4 w-4"}),e(rt),e(K),M(()=>X.disabled=!t(k).url),nt(R,()=>t(k).label,gt=>t(k).label=gt),nt(Y,()=>t(k).url,gt=>t(k).url=gt),d(_,K)}),e(v),d(s,v)},et=s=>{var v=Dr();d(s,v)};h(B,s=>{t(i).links&&t(i).links.length>0?s(J):s(et,!1)})}e(oe);var ut=n(oe,2),U=r(ut),l=r(U);{var C=s=>{var v=Cr();v.__click=()=>g.onDelete(g.entry.id),d(s,v)};h(l,s=>{g.entry&&g.onDelete&&s(C)})}e(U);var I=n(U,2),A=r(I);A.__click=function(...s){g.onClose?.apply(this,s)};var y=n(A,2);e(I),e(ut),e(tt),e(z),e(f),M((s,v,_)=>{N(Ft,g.entry?"Edit Project":"New Project"),N(_t,`Progress (${t(i).percentage??""}%)`),ct(At,`color: ${s??""}`),ct(H,`color: ${v??""}`),ct(y,`background-color: ${_??""}`)},[()=>dt.getAccentLightHex(),()=>dt.getAccentLightHex(),()=>dt.getAccentHex()]),ze("submit",tt,yt),nt(Ut,()=>t(i).name,s=>t(i).name=s),nt(_e,()=>t(i).description,s=>t(i).description=s),Ue(ee,()=>t(i).status,s=>t(i).status=s),nt(O,()=>t(i).funds,s=>t(i).funds=s),nt(St,()=>t(i).percentage,s=>t(i).percentage=s),Ue(pt,()=>t(i).type,s=>t(i).type=s),nt(Bt,()=>t(i).start_at,s=>t(i).start_at=s),nt(ie,()=>t(i).end_at,s=>t(i).end_at=s),ir(3,f,()=>sr,()=>({duration:dt.getTransitionDuration()})),d(c,f)};h(Te,c=>{g.isOpen&&c(Se)})}d(we,be),Re()}Ye(["click","keydown","change"]);var Ar=u('<button class="fixed right-8 bottom-24 z-50 rounded-full p-4 shadow-lg/30 drop-shadow-lg backdrop-blur-md transition-all hover:scale-105 hover:brightness-110 md:right-16 md:bottom-16" aria-label="New Project"><!></button>'),Lr=u('<div class="flex h-48 items-center justify-center"><!></div>'),Pr=u('<div class="rounded-lg border border-zinc-800 bg-zinc-900/60 p-6 text-zinc-400">Sign in to view projects.</div>'),Er=u('<div class="rounded-lg border border-zinc-800 bg-zinc-900/60 p-6 text-zinc-400">No projects yet.</div>'),Mr=u("<option> </option>"),jr=u("<p> </p>"),Nr=u('<div class="flex items-center gap-2 text-xs text-zinc-500"><span> </span></div>'),Fr=u('<div class="flex items-center gap-1"><!> <span> </span></div>'),Or=u('<div class="flex items-center gap-1"><!> <span> </span></div>'),Hr=u('<div class="flex items-center gap-3 text-xs text-zinc-500"><!> <!></div>'),Ur=u('<div class="flex flex-col gap-0.5"><span class="text-[10px] font-bold tracking-wider text-zinc-500 uppercase">Dates</span> <span> </span></div>'),qr=u('<button type="button"><div class="flex flex-col gap-4 md:flex-row md:items-start md:justify-between"><div class="flex min-w-0 flex-1 flex-col gap-2"><h3> </h3> <!> <!></div> <div class="flex w-full shrink-0 flex-col gap-2 md:w-56"><div class="flex justify-end"><span> </span></div> <div class="flex items-center justify-between"><span>Progress</span> <span> </span></div> <div class="h-2 w-full overflow-hidden rounded-full bg-zinc-800"><div></div></div></div></div> <div class="flex flex-wrap items-end gap-4 border-t border-zinc-800/50 pt-3"><div class="flex items-center gap-6"><div class="flex flex-col gap-0.5"><span class="text-[10px] font-bold tracking-wider text-zinc-500 uppercase">Funds</span> <span> </span></div> <!></div></div></button>'),Gr=u('<div class="my-8 flex items-center gap-4"><div class="h-px flex-1 bg-zinc-800"></div> <span class="text-sm font-medium tracking-wider text-zinc-500 uppercase">Archived</span> <div class="h-px flex-1 bg-zinc-800"></div></div> <div class="grid grid-cols-1 gap-4"></div>',1),Wr=u('<div class="grid grid-cols-1 gap-4"></div> <!>',1),Br=u('<div class="absolute top-8 bottom-0 border-l border-dashed border-zinc-800"></div>'),Ir=u('<div class="absolute -translate-x-1/2 transform text-center"> </div>'),Rr=u('<div class="group relative h-10 w-full rounded transition-colors hover:bg-zinc-800/30"><div class="absolute top-1 flex flex-col gap-1"><div></div> <span class="px-0.5 text-[10px] font-medium whitespace-nowrap text-zinc-400"> </span></div></div>'),Yr=u('<div class="p-4 text-center text-zinc-500">No projects with dates to display.</div>'),Vr=u('<div class="w-full overflow-x-auto rounded-lg border border-zinc-800 bg-zinc-900/60 p-4"><div class="relative min-w-[800px]"><div class="pointer-events-none absolute inset-0"></div> <div class="relative z-10 mb-4 flex border-b border-zinc-800 pb-2 text-xs font-medium text-zinc-500"><div class="relative h-6 flex-1"></div></div> <div class="space-y-3"><!> <!></div></div></div>'),Jr=u('<div class="mb-4 flex flex-wrap items-center justify-between gap-4 text-sm"><div class="flex flex-wrap items-center gap-4"><div class="flex items-center gap-2"><select class="cursor-pointer rounded-md border border-zinc-700 bg-zinc-800 px-3 py-1.5 text-sm text-zinc-100 shadow-sm outline-none focus:border-indigo-500 focus:ring-indigo-500"></select> <button class="flex items-center justify-center rounded-md border border-zinc-700 bg-zinc-800 p-1.5 text-zinc-400 shadow-sm transition-colors hover:bg-zinc-700 hover:text-zinc-100" aria-label="Toggle sort order"><!></button></div></div> <div class="flex items-center gap-4"><span class="text-xs text-zinc-500"> </span> <div class="flex items-center rounded-lg bg-zinc-800/50 p-1"><button aria-label="List View"><!></button> <button aria-label="Gantt View"><!></button></div></div></div> <!>',1),Kr=u('<!> <section><div class="flex flex-wrap items-center justify-between gap-4"><h2 class="hidden text-lg font-bold text-zinc-100 md:block">Projects</h2> <!></div> <!></section>',1);function va(we,g){Be(g,!0);const i={0:"Not Started",1:"In Progress",2:"Postponed",3:"Completed",4:"Cancelled"};let G=st(null),wt=st(!0),yt=st(Ie([])),Z=st(!1),kt=st(null),Dt=st("list"),Ct=st("date"),Nt=st("desc"),Xt=at(()=>[...t(yt)].sort((a,o)=>{const m=t(Nt)==="asc"?1:-1;if(t(Ct)==="name")return a.name.localeCompare(o.name)*m;if(t(Ct)==="date"){const b=new Date(a.created_at).getTime(),D=new Date(o.created_at).getTime();return(b-D)*m}else if(t(Ct)==="progress")return((a.percentage||0)-(o.percentage||0))*m;return 0})),ye=at(()=>t(Xt).filter(a=>a.status!==3&&a.status!==4)),me=at(()=>t(Xt).filter(a=>a.status===3||a.status===4)),ke=at(()=>t(yt).filter(a=>a.status===3).length),F=at(()=>{const a=t(Xt).filter(S=>S.start_at&&S.end_at);if(a.length===0){const S=new Date;return{start:new Date(S.getFullYear(),0,1),end:new Date(S.getFullYear(),11,31),projects:[],months:[]}}const o=a.flatMap(S=>[new Date(S.start_at),new Date(S.end_at)]),m=new Date(Math.min(...o.map(S=>S.getTime()))),b=new Date(Math.max(...o.map(S=>S.getTime()))),D=new Date(m);D.setDate(D.getDate()-7);const j=new Date(b);j.setDate(j.getDate()+7);const O=[],W=new Date(D);for(W.setDate(1);W<=j;)O.push(new Date(W)),W.setMonth(W.getMonth()+1);return O.length===0&&O.push(new Date(D.getFullYear(),D.getMonth(),1)),{start:D,end:j,projects:a,months:O}});function De(a,o,m){if(!a.start_at||!a.end_at)return"";const b=m.getTime()-o.getTime(),D=new Date(a.start_at).getTime(),j=new Date(a.end_at).getTime(),O=(D-o.getTime())/b*100,W=(j-D)/b*100;return`left: ${Math.max(0,O)}%; width: ${Math.min(100,W)}%;`}tr(()=>{Kt.auth.getSession().then(({data:{session:o}})=>{p(G,o,!0),o?Tt():p(wt,!1)});const{data:{subscription:a}}=Kt.auth.onAuthStateChange((o,m)=>{p(G,m,!0),m?Tt():p(wt,!1)});return()=>a.unsubscribe()});async function Tt(){p(wt,!0);const{data:a,error:o}=await Kt.from("projects").select("*").order("created_at",{ascending:!1});!o&&a?p(yt,a,!0):o&&console.error("Error fetching projects:",o),p(wt,!1)}function Ce(){p(kt,null),p(Z,!0)}function be(a){p(kt,a,!0),p(Z,!0)}async function Te(a){if(!await er("Are you sure you want to delete this project?","Delete Project",{confirmText:"Delete",isDestructive:!0}))return;const{error:m}=await Kt.from("projects").delete().eq("id",a);m?(console.error("Error deleting project:",m),Jt("Error deleting: "+m.message,"Error")):(Jt("Project deleted successfully!","Success"),p(Z,!1),Tt())}async function Se(a){const{id:o,...m}=a;if(t(kt)){const{error:b}=await Kt.from("projects").update(m).eq("id",t(kt).id);b?(console.error("Error updating project:",b),Jt("Error updating: "+b.message,"Error")):(Jt("Project updated successfully!","Success"),p(Z,!1),Tt())}else{const{error:b}=await Kt.from("projects").insert(m);b?(console.error("Error saving project:",b),Jt("Error saving: "+b.message,"Error")):(Jt("Project saved successfully!","Success"),p(Z,!1),Tt())}}const c=a=>a===null?"—":`€${a}`,f=a=>a?new Date(a).toLocaleDateString():"—";function z(a,o=50){return a?a.length>o?a.slice(0,o)+"...":a:""}const V=a=>i[a]??"Unknown",$=a=>{switch(a){case 1:return"bg-amber-500/10 text-amber-400";case 2:return"bg-purple-500/10 text-purple-400";case 3:return"bg-emerald-500/10 text-emerald-400";case 4:return"bg-red-500/10 text-red-400";default:return"bg-zinc-800 text-zinc-400"}};function Ft(a){if(!a)return{total:0,completed:0};if(Array.isArray(a)&&a.length>0&&"items"in a[0]){let o=0,m=0;return a.forEach(b=>{b.items&&(o+=b.items.length,m+=b.items.filter(D=>D.completed).length)}),{total:o,completed:m}}return Array.isArray(a)&&a.length>0?{total:a.length,completed:a.filter(o=>o.completed).length}:{total:0,completed:0}}var Ot=Kr(),tt=it(Ot);Sr(tt,{get isOpen(){return t(Z)},get entry(){return t(kt)},onClose:()=>p(Z,!1),onSave:Se,onDelete:Te});var Ht=n(tt,2),Ut=r(Ht),Zt=n(r(Ut),2);{var _e=a=>{var o=Ar();o.__click=Ce;var m=r(o);Ve(m,{class:"h-6 w-6 text-(--accent-color)"}),e(o),M((b,D)=>ct(o,`--accent-color: ${b??""}; background-color: ${D??""}/50`),[()=>dt.getAccentLightHex(),()=>dt.getAccentHex()]),d(a,o)};h(Zt,a=>{t(G)&&!t(Z)&&!rr.isOpen&&a(_e)})}e(Ut);var $t=n(Ut,2);{var te=a=>{var o=Lr(),m=r(o);{let b=at(()=>dt.getAccentHex());ar(m,{class:"h-6 w-6 animate-spin",get style(){return`color: ${t(b)??""}`}})}e(o),d(a,o)},ee=a=>{var o=Qt(),m=it(o);{var b=j=>{var O=Pr();d(j,O)},D=j=>{var O=Qt(),W=it(O);{var S=_t=>{var St=Er();d(_t,St)},re=_t=>{var St=Jr(),qt=it(St),Gt=r(qt),pt=r(Gt),xt=r(pt);ot(xt,20,()=>["name","date","progress"],lt,(w,H)=>{var B=Mr(),J=r(B,!0);e(B);var et={};M(ut=>{N(J,ut),et!==(et=H)&&(B.value=(B.__value=H)??"")},[()=>H.charAt(0).toUpperCase()+H.slice(1)]),d(w,B)}),e(xt);var ae=n(xt,2);ae.__click=()=>p(Nt,t(Nt)==="asc"?"desc":"asc",!0);var Ae=r(ae);{var Le=w=>{mr(w,{class:"h-4 w-4"})},ne=w=>{br(w,{class:"h-4 w-4"})};h(Ae,w=>{t(Nt)==="asc"?w(Le):w(ne,!1)})}e(ae),e(pt),e(Gt);var Wt=n(Gt,2),Bt=r(Wt),pe=r(Bt);e(Bt);var ie=n(Bt,2),vt=r(ie);vt.__click=()=>p(Dt,"list");var se=r(vt);fr(se,{class:"h-4 w-4"}),e(vt);var At=n(vt,2);At.__click=()=>p(Dt,"gantt");var Pe=r(At);dr(Pe,{class:"h-4 w-4"}),e(At),e(ie),e(Wt),e(qt);var Ee=n(qt,2);{var Me=w=>{const H=(U,l=Ge,C=Ge)=>{var I=qr();I.__click=()=>be(l());var A=r(I),y=r(A),s=r(y),v=r(s,!0);e(s);var _=n(s,2);{var k=P=>{var T=jr(),q=r(T,!0);e(T),M(x=>{E(T,1,`text-sm ${C()?"text-zinc-600":"text-zinc-400"}`),N(q,x)},[()=>z(l().description)]),d(P,T)};h(_,P=>{l().description&&P(k)})}var L=n(_,2);{var K=P=>{const T=at(()=>dt.getProjectType(l().type));var q=Qt(),x=it(q);{var ft=mt=>{var Vt=Nr(),ve=r(Vt),je=r(ve,!0);e(ve),e(Vt),M(()=>{E(ve,1,`font-medium ${C()?"text-zinc-600":"text-zinc-400"}`),N(je,t(T).label)}),d(mt,Vt)};h(x,mt=>{t(T)&&mt(ft)})}d(P,q)},Q=P=>{var T=Qt(),q=it(T);{var x=ft=>{var mt=Hr(),Vt=r(mt);{var ve=Mt=>{const jt=at(()=>Ft(l().checklist));var ue=Qt(),ge=it(ue);{var Ne=fe=>{var Fe=Fr(),qe=r(Fe);{let Qe=at(()=>`h-3.5 w-3.5 ${C()?"text-zinc-600":"text-zinc-400"}`);ur(qe,{get class(){return t(Qe)}})}var Oe=n(qe,2),Ke=r(Oe);e(Oe),e(Fe),M(()=>{E(Oe,1,We(C()?"text-zinc-600":"text-zinc-500")),N(Ke,`${t(jt).completed??""}/${t(jt).total??""}`)}),d(fe,Fe)};h(ge,fe=>{t(jt).total>0&&fe(Ne)})}d(Mt,ue)};h(Vt,Mt=>{l().checklist&&Mt(ve)})}var je=n(Vt,2);{var Je=Mt=>{var jt=Or(),ue=r(jt);{let fe=at(()=>`h-3.5 w-3.5 ${C()?"text-zinc-600":"text-zinc-400"}`);vr(ue,{get class(){return t(fe)}})}var ge=n(ue,2),Ne=r(ge,!0);e(ge),e(jt),M(()=>{E(ge,1,We(C()?"text-zinc-600":"text-zinc-500")),N(Ne,l().links.length)}),d(Mt,jt)};h(je,Mt=>{l().links&&l().links.length>0&&Mt(Je)})}e(mt),d(ft,mt)};h(q,ft=>{(l().checklist||l().links&&l().links.length>0)&&ft(x)},!0)}d(P,T)};h(L,P=>{l().type?P(K):P(Q,!1)})}e(y);var R=n(y,2),Y=r(R),X=r(Y),It=r(X,!0);e(X),e(Y);var rt=n(Y,2),ht=r(rt),gt=n(ht,2),le=r(gt);e(gt),e(rt);var Lt=n(rt,2),Pt=r(Lt);let Rt;e(Lt),e(R),e(A);var Et=n(A,2),xe=r(Et),ce=r(xe),de=n(r(ce),2),Yt=r(de,!0);e(de),e(ce);var he=n(ce,2);{var zt=P=>{var T=Ur(),q=n(r(T),2),x=r(q);e(q),e(T),M((ft,mt)=>{E(q,1,`text-sm ${C()?"text-zinc-500":"text-zinc-300"}`),N(x,`${ft??""} - ${mt??""}`)},[()=>f(l().start_at),()=>f(l().end_at)]),d(P,T)};h(he,P=>{(l().start_at||l().end_at)&&P(zt)})}e(xe),e(Et),e(I),M((P,T,q,x,ft)=>{E(I,1,`group relative flex w-full cursor-pointer flex-col gap-4 rounded-lg border p-4 text-left transition-all ${C()?"border-zinc-800/60 bg-zinc-900/30 text-zinc-500 hover:border-zinc-700/60 hover:bg-zinc-900/40":"border-zinc-800 bg-zinc-900/60 hover:border-zinc-700 hover:bg-zinc-900/80"}`),E(s,1,`truncate text-base font-bold ${C()?"text-zinc-500":"text-zinc-100"}`),nr(s,"title",l().name),N(v,l().name),E(X,1,P),N(It,T),E(ht,1,`text-xs font-medium ${C()?"text-zinc-600":"text-zinc-400"}`),E(gt,1,`text-xs ${C()?"text-zinc-600":"text-zinc-500"}`),N(le,`${(l().percentage||0)??""}%`),E(Pt,1,`h-full rounded-full transition-all duration-500 ${q??""}`),Rt=ct(Pt,"",Rt,x),E(de,1,`text-sm font-medium ${C()?"text-zinc-500":"text-emerald-400"}`),N(Yt,ft)},[()=>`rounded-full px-2 py-0.5 text-xs ${$(l().status)}`,()=>V(l().status),()=>l().colour&&!l().colour.startsWith("#")?l().colour:"",()=>({width:`${(l().percentage||0)??""}%`,"background-color":l().colour&&l().colour.startsWith("#")?l().colour:"",opacity:C()?.5:1}),()=>c(l().funds)]),d(U,I)};var B=Wr(),J=it(B);ot(J,21,()=>t(ye),lt,(U,l)=>{H(U,()=>t(l),()=>!1)}),e(J);var et=n(J,2);{var ut=U=>{var l=Gr(),C=n(it(l),2);ot(C,21,()=>t(me),lt,(I,A)=>{H(I,()=>t(A),()=>!0)}),e(C),d(U,l)};h(et,U=>{t(me).length>0&&U(ut)})}d(w,B)},oe=w=>{var H=Vr(),B=r(H),J=r(B);ot(J,21,()=>t(F).months,lt,(A,y)=>{var s=Br();let v;M(_=>v=ct(s,"",v,_),[()=>({left:`${(t(y).getTime()-t(F).start.getTime())/(t(F).end.getTime()-t(F).start.getTime())*100}%`})]),d(A,s)}),e(J);var et=n(J,2),ut=r(et);ot(ut,21,()=>t(F).months,lt,(A,y)=>{var s=Ir();let v;var _=r(s,!0);e(s),M((k,L)=>{v=ct(s,"",v,k),N(_,L)},[()=>({left:`${(t(y).getTime()-t(F).start.getTime())/(t(F).end.getTime()-t(F).start.getTime())*100}%`}),()=>t(y).toLocaleDateString("en-US",{month:"long"})]),d(A,s)}),e(ut),e(et);var U=n(et,2),l=r(U);ot(l,17,()=>t(F).projects,lt,(A,y)=>{var s=Rr(),v=r(s),_=r(v);let k;var L=n(_,2),K=r(L,!0);e(L),e(v),e(s),M((Q,R,Y)=>{ct(v,Q),E(_,1,`h-2 w-full rounded-full shadow-sm transition-all hover:brightness-110 ${R??""}`),k=ct(_,"",k,Y),N(K,t(y).name)},[()=>De(t(y),t(F).start,t(F).end),()=>t(y).colour&&!t(y).colour.startsWith("#")?t(y).colour:"bg-indigo-600",()=>({"background-color":t(y).colour&&t(y).colour.startsWith("#")?t(y).colour:void 0})]),d(A,s)});var C=n(l,2);{var I=A=>{var y=Yr();d(A,y)};h(C,A=>{t(F).projects.length===0&&A(I)})}e(U),e(B),e(H),d(w,H)};h(Ee,w=>{t(Dt)==="list"?w(Me):w(oe,!1)})}M(()=>{N(pe,`Completed ${t(ke)??""} / ${t(yt).length??""}`),E(vt,1,`rounded-md p-1.5 transition-all ${t(Dt)==="list"?"bg-zinc-700 text-white shadow-sm":"text-zinc-400 hover:text-zinc-300"}`),E(At,1,`rounded-md p-1.5 transition-all ${t(Dt)==="gantt"?"bg-zinc-700 text-white shadow-sm":"text-zinc-400 hover:text-zinc-300"}`)}),Ue(xt,()=>t(Ct),w=>p(Ct,w)),d(_t,St)};h(W,_t=>{t(yt).length===0?_t(S):_t(re,!1)},!0)}d(j,O)};h(m,j=>{t(G)?j(D,!1):j(b)},!0)}d(a,o)};h($t,a=>{t(wt)&&t(G)!==null?a(te):a(ee,!1)})}e(Ht),d(we,Ot),Re()}Ye(["click"]);export{va as component};
