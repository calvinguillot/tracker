import{b as pe,d as Oe,c as oe,a as m,f as y}from"../chunks/DfBUW2EX.js";import{F as N,h as xe,b as we,T as Be,U as Le,i as ye,C as He,e as Re,V as qe,W as Fe,f as Ke,g as re,p as ke,l as k,m as Ce,z as Pe,t as l,k as L,a as Ee,A as a,B as o,D as n,G as Ve,n as e,o as Ge,K as Ie}from"../chunks/CWKX6I-G.js";import{d as De,s as Y,e as Ue}from"../chunks/CYGYm-mD.js";import{i as D}from"../chunks/dtqBgZjR.js";import{r as ze,e as be,s as se,c as We,i as me,a as Ye}from"../chunks/KZ_UlTxQ.js";import{s as O}from"../chunks/Bkout0r_.js";import{t as Je,f as Qe}from"../chunks/BPxw6sm7.js";import{b as fe}from"../chunks/BTcorzso.js";import{s as ae}from"../chunks/DK3I1aua.js";import{a as B,b as Xe,c as Ze}from"../chunks/CTvbdkQS.js";import{P as $e}from"../chunks/D54pIDuW.js";import{L as et}from"../chunks/bHIvvzCn.js";import{A as tt,a as rt}from"../chunks/DScW-YBI.js";function ot(H,d,i=!1,p=!1,C=!1){var g=H,_="";N(()=>{var h=Be;if(_===(_=d()??"")){xe&&we();return}if(h.nodes!==null&&(Le(h.nodes.start,h.nodes.end),h.nodes=null),_!==""){if(xe){ye.data;for(var v=we(),f=v;v!==null&&(v.nodeType!==He||v.data!=="");)f=v,v=Re(v);if(v===null)throw qe(),Fe;pe(ye,f),g=Ke(v);return}var b=_+"";i?b=`<svg>${b}</svg>`:p&&(b=`<math>${b}</math>`);var u=Oe(b);if((i||p)&&(u=re(u)),pe(re(u),u.lastChild),i||p)for(;re(u);)g.before(re(u));else g.before(u)}})}var at=y('<button type="button" class="h-8 w-8 rounded-full border border-zinc-700 transition-transform hover:scale-110 focus:ring-2 focus:ring-zinc-400 focus:outline-none"></button>'),st=y('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/70 p-2 backdrop-blur-sm md:p-4" role="dialog" aria-modal="true" tabindex="-1"><div class="flex max-h-[95vh] w-full max-w-2xl flex-col overflow-y-auto rounded-xl border border-zinc-800 bg-zinc-900 shadow-xl md:max-h-[90vh]"><div class="sticky top-0 z-10 flex items-center justify-between border-b border-zinc-800 bg-zinc-900 p-4 md:p-6"><h2 class="text-xl font-bold text-zinc-100"> </h2> <button class="text-zinc-400 transition-colors hover:text-zinc-200" aria-label="Close"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <form class="space-y-6 p-4 md:p-6"><div><label for="title" class="mb-1 block text-sm font-medium text-zinc-400">Title</label> <input type="text" id="title" required class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"/></div> <div><label for="body" class="mb-1 block text-sm font-medium text-zinc-400">Body</label> <textarea id="body" rows="10" class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"></textarea></div> <div><label for="color" class="mb-1 block text-sm font-medium text-zinc-400">Color</label> <div class="flex flex-wrap gap-2"></div> <input type="hidden" name="color"/></div> <div class="sticky bottom-0 mt-6 flex justify-end gap-3 border-t border-zinc-800 bg-zinc-900 pt-4"><button type="button" class="rounded-md bg-zinc-800 px-3.5 py-2.5 text-sm font-semibold text-zinc-200 shadow-sm ring-1 ring-zinc-700 ring-inset hover:bg-zinc-700">Cancel</button> <button type="submit" class="rounded-md px-3.5 py-2.5 text-sm font-semibold text-white shadow-sm transition-all hover:brightness-110 focus-visible:outline-2 focus-visible:outline-offset-2">Save</button></div></form></div></div>');function it(H,d){ke(d,!0);let i=k(Ce({title:"",body:"",color:"#18181b"}));Pe(()=>{d.isOpen&&(d.entry?l(i,{title:d.entry.title||"",body:d.entry.body||"",color:d.entry.color||"#18181b"},!0):l(i,{title:"",body:"",color:"#18181b"},!0))});function p(f){f.preventDefault(),d.onSave(e(i))}function C(f){f.target===f.currentTarget&&d.onClose()}function g(f){f.key==="Escape"&&d.onClose()}var _=oe(),h=L(_);{var v=f=>{var b=st();b.__click=C,b.__keydown=g;var u=a(b),R=a(u),q=a(R),ie=a(q,!0);o(q);var ne=n(q,2);ne.__click=function(...t){d.onClose?.apply(this,t)},o(R);var F=n(R,2),S=a(F),K=n(a(S),2);ze(K),o(S);var A=n(S,2),M=n(a(A),2);Ve(M),o(A);var P=n(A,2),V=n(a(P),2);be(V,21,()=>ae.settings.notes_types,me,(t,s)=>{var c=at();c.__click=()=>e(i).color=e(s).color??"#18181b",N(()=>{se(c,`background-color: ${e(s).color??""}; ${e(i).color===e(s).color?"border-color: white; transform: scale(1.1);":""}`),We(c,"aria-label",`Select color ${e(s).color??""}`)}),m(t,c)}),o(V);var J=n(V,2);ze(J),o(P);var Q=n(P,2),X=a(Q);X.__click=function(...t){d.onClose?.apply(this,t)};var r=n(X,2);o(Q),o(F),o(u),o(b),N(t=>{Y(ie,d.entry?"Edit Note":"New Note"),se(r,`background-color: ${t??""}`)},[()=>ae.getAccentHex()]),Ue("submit",F,p),fe(K,()=>e(i).title,t=>e(i).title=t),fe(M,()=>e(i).body,t=>e(i).body=t),fe(J,()=>e(i).color,t=>e(i).color=t),Je(3,b,()=>Qe,()=>({duration:ae.getTransitionDuration()})),m(f,b)};D(h,f=>{d.isOpen&&f(v)})}m(H,_),Ee()}De(["click","keydown"]);var nt=y('<button class="fixed right-8 bottom-8 z-50 rounded-full p-4 text-white shadow-lg transition-all hover:scale-105 hover:brightness-110" aria-label="New Note"><!></button>'),lt=y('<div class="flex h-48 items-center justify-center"><!></div>'),ct=y('<div class="rounded-lg border border-zinc-800 bg-zinc-900/60 p-6 text-zinc-400">Sign in to view notes.</div>'),dt=y('<div class="rounded-lg border border-zinc-800 bg-zinc-900/60 p-6 text-zinc-400">No notes yet.</div>'),vt=y('<button><span class="capitalize"> </span> <!></button>'),ut=y('<li class="group relative flex flex-col gap-4 rounded-lg border border-zinc-800 p-4 transition-all hover:border-zinc-700 hover:shadow-lg"><div class="flex flex-col gap-3"><h3 class="wrap-break-words text-lg font-bold text-zinc-100"> </h3> <div class="prose prose-sm max-w-none wrap-break-word text-zinc-300 prose-invert"><!></div></div> <div class="mt-auto flex items-center justify-between gap-4 border-t border-zinc-800/50 pt-3"><div class="text-xs text-zinc-400/70"> </div> <div class="flex items-center gap-2"><button class="rounded-md p-2 text-indigo-400 transition-colors hover:bg-black/20 hover:text-indigo-300" aria-label="Edit"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg></button> <button class="rounded-md p-2 text-red-400 transition-colors hover:bg-black/20 hover:text-red-300" aria-label="Delete"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg></button></div></div></li>'),ft=y('<div class="mb-4 flex flex-wrap items-center gap-4 text-sm"><span class="text-zinc-500">Sort by:</span> <!> <span class="ml-auto text-xs text-zinc-500"> </span></div> <ul class="grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3"></ul>',1),bt=y('<!> <section class="space-y-6"><div class="flex flex-wrap items-center justify-between gap-4"><h2 class="text-lg font-bold text-zinc-100">Notes</h2> <!></div> <!></section>',1);function Nt(H,d){ke(d,!0);let i=k(null),p=k(!0),C=k(Ce([])),g=k(!1),_=k(null),h=k("created"),v=k("desc"),f=Ie(()=>[...e(C)].sort((r,t)=>{const s=e(v)==="asc"?1:-1;if(e(h)==="title")return(r.title||"").localeCompare(t.title||"")*s;if(e(h)==="created"){const c=new Date(r.created_at).getTime(),le=new Date(t.created_at).getTime();return(c-le)*s}return 0}));function b(r){e(h)===r?l(v,e(v)==="asc"?"desc":"asc",!0):(l(h,r,!0),l(v,"desc"))}Ge(()=>{O.auth.getSession().then(({data:{session:t}})=>{l(i,t,!0),t?u():l(p,!1)});const{data:{subscription:r}}=O.auth.onAuthStateChange((t,s)=>{l(i,s,!0),s?u():l(p,!1)});return()=>r.unsubscribe()});async function u(){l(p,!0),console.log("Fetching notes...");const{data:r,error:t}=await O.from("notes").select("id, created_at, title, body, color").order("created_at",{ascending:!1});!t&&r?l(C,r,!0):t&&console.error("Error fetching notes:",t),l(p,!1)}function R(){l(_,null),l(g,!0)}function q(r){l(_,r,!0),l(g,!0)}async function ie(r){if(!await Ze("Are you sure you want to delete this note?","Delete Note",{confirmText:"Delete",isDestructive:!0}))return;const{error:s}=await O.from("notes").delete().eq("id",r);s?(console.error("Error deleting note:",s),B("Error deleting: "+s.message,"Error")):(B("Note deleted successfully!","Success"),u())}async function ne(r){const{id:t,...s}=r;if(e(_)){const{error:c}=await O.from("notes").update(s).eq("id",e(_).id);c?(console.error("Error updating note:",c),B("Error updating: "+c.message,"Error")):(B("Note updated successfully!","Success"),l(g,!1),u())}else{const{error:c}=await O.from("notes").insert(s);c?(console.error("Error saving note:",c),B("Error saving: "+c.message,"Error")):(B("Note saved successfully!","Success"),l(g,!1),u())}}function F(r){return r?r.replace(/\n/g,"<br>"):""}var S=bt(),K=L(S);it(K,{get isOpen(){return e(g)},get entry(){return e(_)},onClose:()=>l(g,!1),onSave:ne});var A=n(K,2),M=a(A),P=n(a(M),2);{var V=r=>{var t=nt();t.__click=R;var s=a(t);$e(s,{class:"h-6 w-6"}),o(t),N(c=>se(t,`background-color: ${c??""}`),[()=>ae.getAccentHex()]),m(r,t)};D(P,r=>{e(i)&&!e(g)&&!Xe.isOpen&&r(V)})}o(M);var J=n(M,2);{var Q=r=>{var t=lt(),s=a(t);et(s,{class:"h-6 w-6 animate-spin text-indigo-400"}),o(t),m(r,t)},X=r=>{var t=oe(),s=L(t);{var c=T=>{var Z=ct();m(T,Z)},le=T=>{var Z=oe(),Ne=L(Z);{var Se=j=>{var $=dt();m(j,$)},Ae=j=>{var $=ft(),ce=L($),ge=n(a(ce),2);be(ge,16,()=>["created","title"],me,(de,x)=>{var w=vt();w.__click=()=>b(x);var E=a(w),G=a(E,!0);o(E);var ve=n(E,2);{var ee=I=>{var U=oe(),W=L(U);{var ue=z=>{tt(z,{class:"h-3 w-3"})},te=z=>{rt(z,{class:"h-3 w-3"})};D(W,z=>{e(v)==="asc"?z(ue):z(te,!1)})}m(I,U)};D(ve,I=>{e(h)===x&&I(ee)})}o(w),N(()=>{Ye(w,1,`flex items-center gap-1 rounded-md px-3 py-1.5 transition-colors ${e(h)===x?"bg-indigo-500/20 text-indigo-300":"bg-zinc-800/50 text-zinc-400 hover:bg-zinc-800"}`),Y(G,x)}),m(de,w)});var _e=n(ge,2),Me=a(_e);o(_e),o(ce);var he=n(ce,2);be(he,21,()=>e(f),me,(de,x)=>{var w=ut(),E=a(w),G=a(E),ve=a(G,!0);o(G);var ee=n(G,2),I=a(ee);ot(I,()=>F(e(x).body)),o(ee),o(E);var U=n(E,2),W=a(U),ue=a(W,!0);o(W);var te=n(W,2),z=a(te);z.__click=()=>q(e(x));var Te=n(z,2);Te.__click=()=>ie(e(x).id),o(te),o(U),o(w),N(je=>{se(w,`background-color: ${(e(x).color||"#18181b")??""}`),Y(ve,e(x).title),Y(ue,je)},[()=>new Date(e(x).created_at).toLocaleDateString()]),m(de,w)}),o(he),N(()=>Y(Me,`Amount of notes: ${e(C).length??""}`)),m(j,$)};D(Ne,j=>{e(C).length===0?j(Se):j(Ae,!1)},!0)}m(T,Z)};D(s,T=>{e(i)?T(le,!1):T(c)},!0)}m(r,t)};D(J,r=>{e(p)&&e(i)!==null?r(Q):r(X,!1)})}o(A),m(H,S),Ee()}De(["click"]);export{Nt as component};
