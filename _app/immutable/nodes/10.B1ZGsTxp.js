import{c as ut,a as d,f as u}from"../chunks/7NWlc7Su.js";import{p as Ot,v as X,w as Ut,x as Rt,y,k as Q,a as Ft,z as r,A as t,B as o,D as C,m as e,F as Vt,G as Yt,o as Jt,I as G,J as jt}from"../chunks/BVFz32Il.js";import{d as Ht,s as O,e as vt}from"../chunks/pKnFB2my.js";import{i as D}from"../chunks/Ds4RlZDk.js";import{e as Z,i as $,s as ke,c as Kt}from"../chunks/CP7c8dVT.js";import{r as Fe,a as Y,b as gt,f as M,c as Qt,d as He,e as Xt,L as Zt,g as Mt}from"../chunks/RPGm4AHo.js";import{s as Ie}from"../chunks/BW5xtwr9.js";import{t as $t,f as er}from"../chunks/DbLlv7u-.js";import{b as we,P as It}from"../chunks/CX8rbiYm.js";import{T as Tt}from"../chunks/D6KFCUkc.js";import{G as tr,S as rr,E as ar,C as ir,L as or,a as nr}from"../chunks/C2sp_6na.js";import{S as sr}from"../chunks/CbEtCGLT.js";import{L as lr}from"../chunks/CuxWYXv5.js";import{A as cr}from"../chunks/D9mXmw9u.js";import{A as dr}from"../chunks/CgHzHeUi.js";var vr=u("<option> </option>"),ur=u("<div></div>"),gr=u("<option> </option>"),br=u('<div class="flex items-center gap-2"><button type="button" class="text-zinc-400 hover:text-zinc-200"><!></button> <input type="text" placeholder="Item description..."/> <div class="flex items-center gap-1"><div role="button" tabindex="0" class="cursor-grab p-1 text-zinc-600 hover:text-zinc-400 active:cursor-grabbing" draggable="true"><!></div> <button type="button" class="p-1 text-zinc-500 hover:text-red-400"><!></button></div></div>'),fr=u('<div class="rounded-lg border border-zinc-800 bg-zinc-800/30 p-4"><div class="mb-3 flex items-center justify-between gap-2"><input type="text" placeholder="Checklist Title" class="w-full bg-transparent text-sm font-bold text-zinc-200 placeholder-zinc-600 focus:outline-none"/> <button type="button" class="text-zinc-600 hover:text-red-400" title="Remove Checklist"><!></button></div> <div class="space-y-2"><!> <button type="button" class="mt-2 flex items-center gap-1 text-xs text-zinc-500 hover:text-zinc-300"><!> Add Item</button></div></div>'),_r=u('<div class="space-y-6"></div>'),pr=u('<div class="rounded-lg border border-dashed border-zinc-800 p-4 text-center"><p class="text-sm text-zinc-500">No checklists yet</p></div>'),mr=u('<div class="flex items-center gap-2"><div class="grid flex-1 grid-cols-1 gap-2 md:grid-cols-2"><input type="text" placeholder="Label (optional)" class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-sm text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"/> <input type="text" placeholder="URL" class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-sm text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"/></div> <button type="button" class="p-2 text-zinc-400 hover:text-indigo-400" title="Open Link"><!></button> <button type="button" class="p-2 text-zinc-400 hover:text-red-400" title="Remove Link"><!></button></div>'),xr=u('<div class="space-y-2"></div>'),hr=u('<div class="rounded-lg border border-dashed border-zinc-800 p-4 text-center"><p class="text-sm text-zinc-500">No links yet</p></div>'),zr=u('<button type="button" class="rounded-md bg-red-500/10 px-3.5 py-2.5 text-sm font-semibold text-red-400 shadow-sm ring-1 ring-red-500/20 transition-colors ring-inset hover:bg-red-500/20">Delete</button>'),yr=u('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/70 p-2 backdrop-blur-sm md:p-4" role="dialog" aria-modal="true" tabindex="-1"><div class="flex max-h-[95vh] w-full max-w-2xl flex-col overflow-y-auto rounded-xl border border-zinc-800 bg-zinc-900 shadow-xl md:max-h-[90vh]"><div class="sticky top-0 z-10 flex items-center justify-between border-b border-zinc-800 bg-zinc-900 p-4 md:p-6"><h2 class="text-xl font-bold text-zinc-100"> </h2> <button class="text-zinc-400 transition-colors hover:text-zinc-200" aria-label="Close"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <form class="space-y-6 p-4 md:p-6"><div><label for="title" class="mb-1 block text-sm font-medium text-zinc-400">Title</label> <input type="text" id="title" required class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"/></div> <div class="grid grid-cols-1 gap-6 md:grid-cols-2"><div><label for="type" class="mb-1 block text-sm font-medium text-zinc-400">Type</label> <div class="flex items-center gap-2"><select id="type" class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"><option>Select Type</option><!></select> <!></div></div> <div><label for="status" class="mb-1 block text-sm font-medium text-zinc-400">Status</label> <select id="status" class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"></select></div></div> <div class="grid grid-cols-1 gap-6 md:grid-cols-2"><div><label for="deadline_at" class="mb-1 block text-sm font-medium text-zinc-400">Deadline</label> <input type="date" id="deadline_at" class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"/></div></div> <div><label for="body" class="mb-1 block text-sm font-medium text-zinc-400">Description</label> <textarea id="body" rows="3" class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"></textarea></div> <div class="space-y-4"><div class="flex items-center justify-between"><span class="block text-sm font-medium text-zinc-400">Checklists</span> <button type="button" class="text-xs transition-colors hover:brightness-125">+ Add Checklist</button></div> <!></div> <div class="space-y-4"><div class="flex items-center justify-between"><span class="block text-sm font-medium text-zinc-400">Links</span> <button type="button" class="text-xs transition-colors hover:brightness-125">+ Add Link</button></div> <!></div> <div class="sticky bottom-0 mt-6 flex justify-between gap-3 border-t border-zinc-800 bg-zinc-900 pt-4"><div><!></div> <div class="flex gap-3"><button type="button" class="rounded-md bg-zinc-800 px-3.5 py-2.5 text-sm font-semibold text-zinc-200 shadow-sm ring-1 ring-zinc-700 ring-inset hover:bg-zinc-700">Cancel</button> <button type="submit" class="rounded-md px-3.5 py-2.5 text-sm font-semibold text-white shadow-sm transition-all hover:brightness-110 focus-visible:outline-2 focus-visible:outline-offset-2">Save</button></div></div></form></div></div>');function wr(bt,f){Ot(f,!0);let i=X(Ut({title:"",type:"",status:"todo",body:"",deadline_at:"",completed_at:null,color:"#000000",checklist:[],links:[]})),B=X(null);const ue=[{value:"todo",label:"To Do"},{value:"in_progress",label:"In Progress"},{value:"done",label:"Done"}];Rt(()=>{f.isOpen&&(f.entry?y(i,{title:f.entry.title||"",type:f.entry.type||"",status:f.entry.status||"todo",body:f.entry.body||"",deadline_at:f.entry.deadline_at||"",completed_at:f.entry.completed_at||null,color:f.entry.color||"#000000",checklist:Array.isArray(f.entry.checklist)&&f.entry.checklist.length>0?"items"in f.entry.checklist[0]?f.entry.checklist:[{id:crypto.randomUUID(),title:"Checklist",items:f.entry.checklist}]:[],links:Array.isArray(f.entry.links)?f.entry.links:[]},!0):y(i,{title:"",type:"",status:"todo",body:"",deadline_at:"",completed_at:null,color:"#000000",checklist:[],links:[]},!0))});function ee(l){l.preventDefault(),e(i).status==="done"?e(i).completed_at||(e(i).completed_at=new Date().toISOString()):e(i).completed_at=null;const g={...e(i),deadline_at:e(i).deadline_at||null};f.onSave(g)}function pe(l){l.target===l.currentTarget&&f.onClose()}function me(l){l.key==="Escape"&&f.onClose()}function ft(){e(i).checklist=[...e(i).checklist,{id:crypto.randomUUID(),title:"New Checklist",items:[]}]}function le(l){e(i).checklist=e(i).checklist.filter((g,T)=>T!==l)}function De(l){const g=e(i).checklist[l];g.items=[...g.items,{text:"",completed:!1}],e(i).checklist[l]=g}function Te(l,g){const T=e(i).checklist[l];T.items=T.items.filter((J,te)=>te!==g),e(i).checklist[l]=T}function _t(l,g){const T=e(i).checklist[l];T.items[g].completed=!T.items[g].completed,e(i).checklist[l]=T}function tt(l,g,T){y(B,{listIndex:g,itemIndex:T},!0),l.dataTransfer&&(l.dataTransfer.effectAllowed="move",l.dataTransfer.dropEffect="move")}function rt(l,g,T){if(l.preventDefault(),!e(B)||e(B).listIndex!==g||e(B).itemIndex===T)return;const J=e(i).checklist[g],te=e(B).itemIndex,Ce=T,Ae=J.items[te],re=[...J.items];re.splice(te,1),re.splice(Ce,0,Ae),J.items=re,e(i).checklist[g]=J,e(B).itemIndex=Ce}function at(){y(B,null)}function pt(){if(e(i).type){const l=Y.getTaskType(e(i).type);l&&l.color&&(e(i).color=l.color)}}function mt(){e(i).links=[...e(i).links,{url:"",label:""}]}function xt(l){e(i).links=e(i).links.filter((g,T)=>T!==l)}function xe(l){if(!l)return;let g=l;/^https?:\/\//i.test(g)||(g="https://"+g),window.open(g,"_blank","noopener,noreferrer")}var it=ut(),ot=Q(it);{var ht=l=>{var g=yr();g.__click=pe,g.__keydown=me;var T=r(g),J=r(T),te=r(J),Ce=r(te,!0);t(te);var Ae=o(te,2);Ae.__click=function(...s){f.onClose?.apply(this,s)},t(J);var re=o(J,2),Se=r(re),Le=o(r(Se),2);Fe(Le),t(Se);var Ne=o(Se,2),We=r(Ne),nt=o(r(We),2),he=r(nt);he.__change=pt;var Be=r(he);Be.value=Be.__value="";var a=o(Be);Z(a,17,()=>Y.settings.task_types,$,(s,_)=>{var k=vr(),j=r(k,!0);t(k);var H={};C(()=>{O(j,e(_).label),H!==(H=e(_).id)&&(k.value=(k.__value=e(_).id)??"")}),d(s,k)}),t(he);var n=o(he,2);{var v=s=>{var _=ur();let k;C(j=>{k=M(_,1,"h-8 w-8 shrink-0 rounded-full border border-zinc-600 shadow-sm",null,k,{"bg-zinc-500":e(i).color==="bg-zinc-500","bg-red-600":e(i).color==="bg-red-600","bg-orange-600":e(i).color==="bg-orange-600","bg-amber-500":e(i).color==="bg-amber-500","bg-green-600":e(i).color==="bg-green-600","bg-emerald-500":e(i).color==="bg-emerald-500","bg-teal-500":e(i).color==="bg-teal-500","bg-cyan-500":e(i).color==="bg-cyan-500","bg-blue-600":e(i).color==="bg-blue-600","bg-indigo-600":e(i).color==="bg-indigo-600","bg-violet-600":e(i).color==="bg-violet-600","bg-purple-600":e(i).color==="bg-purple-600","bg-fuchsia-600":e(i).color==="bg-fuchsia-600","bg-pink-600":e(i).color==="bg-pink-600","bg-rose-600":e(i).color==="bg-rose-600"}),ke(_,j)},[()=>e(i).color.startsWith("#")?`background-color: ${e(i).color}`:""]),d(s,_)};D(n,s=>{e(i).color&&s(v)})}t(nt),t(We);var b=o(We,2),E=o(r(b),2);Z(E,21,()=>ue,$,(s,_)=>{var k=gr(),j=r(k,!0);t(k);var H={};C(()=>{O(j,e(_).label),H!==(H=e(_).value)&&(k.value=(k.__value=e(_).value)??"")}),d(s,k)}),t(E),t(b),t(Ne);var W=o(Ne,2),ae=r(W),st=o(r(ae),2);Fe(st),t(ae),t(W);var qe=o(W,2),lt=o(r(qe),2);Vt(lt),t(qe);var ie=o(qe,2),ge=r(ie),Ee=o(r(ge),2);Ee.__click=ft,t(ge);var Pe=o(ge,2);{var je=s=>{var _=_r();Z(_,21,()=>e(i).checklist,$,(k,j,H)=>{var p=fr(),w=r(p),h=r(w);Fe(h);var A=o(h,2);A.__click=()=>le(H);var U=r(A);Tt(U,{class:"h-4 w-4"}),t(A),t(w);var R=o(w,2),S=r(R);Z(S,17,()=>e(j).items,$,(oe,I,ce)=>{var ne=br(),K=r(ne);K.__click=()=>_t(H,ce);var L=r(K);{var de=N=>{sr(N,{class:"h-5 w-5 text-emerald-500"})},ze=N=>{rr(N,{class:"h-5 w-5"})};D(L,N=>{e(I).completed?N(de):N(ze,!1)})}t(K);var V=o(K,2);Fe(V);var Oe=o(V,2),q=r(Oe),fe=r(q);tr(fe,{class:"h-4 w-4"}),t(q);var _e=o(q,2);_e.__click=()=>Te(H,ce);var Ue=r(_e);Tt(Ue,{class:"h-3 w-3"}),t(_e),t(Oe),t(ne),C(()=>M(V,1,`w-full rounded-md border border-zinc-700 bg-zinc-800 p-1.5 text-sm text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 ${e(I).completed?"text-zinc-500 line-through":""}`)),we(V,()=>e(I).text,N=>e(I).text=N),vt("dragstart",q,N=>tt(N,H,ce)),vt("dragover",q,N=>rt(N,H,ce)),vt("dragend",q,at),d(oe,ne)});var c=o(S,2);c.__click=()=>De(H);var m=r(c);It(m,{class:"h-3 w-3"}),Yt(),t(c),t(R),t(p),we(h,()=>e(j).title,oe=>e(j).title=oe),d(k,p)}),t(_),d(s,_)},Ge=s=>{var _=pr();d(s,_)};D(Pe,s=>{e(i).checklist&&e(i).checklist.length>0?s(je):s(Ge,!1)})}t(ie);var Re=o(ie,2),Ve=r(Re),ct=o(r(Ve),2);ct.__click=mt,t(Ve);var Ye=o(Ve,2);{var Je=s=>{var _=xr();Z(_,21,()=>e(i).links,$,(k,j,H)=>{var p=mr(),w=r(p),h=r(w);Fe(h);var A=o(h,2);Fe(A),t(w);var U=o(w,2);U.__click=()=>xe(e(j).url);var R=r(U);ar(R,{class:"h-4 w-4"}),t(U);var S=o(U,2);S.__click=()=>xt(H);var c=r(S);Tt(c,{class:"h-4 w-4"}),t(S),t(p),C(()=>U.disabled=!e(j).url),we(h,()=>e(j).label,m=>e(j).label=m),we(A,()=>e(j).url,m=>e(j).url=m),d(k,p)}),t(_),d(s,_)},Ke=s=>{var _=hr();d(s,_)};D(Ye,s=>{e(i).links&&e(i).links.length>0?s(Je):s(Ke,!1)})}t(Re);var dt=o(Re,2),Me=r(dt),Qe=r(Me);{var zt=s=>{var _=zr();_.__click=()=>f.onDelete(f.entry.id),d(s,_)};D(Qe,s=>{f.entry&&f.onDelete&&s(zt)})}t(Me);var Xe=o(Me,2),be=r(Xe);be.__click=function(...s){f.onClose?.apply(this,s)};var yt=o(be,2);t(Xe),t(dt),t(re),t(T),t(g),C((s,_,k)=>{O(Ce,f.entry?"Edit Task":"New Task"),ke(Ee,`color: ${s??""}`),ke(ct,`color: ${_??""}`),ke(yt,`background-color: ${k??""}`)},[()=>Y.getAccentLightHex(),()=>Y.getAccentLightHex(),()=>Y.getAccentHex()]),vt("submit",re,ee),we(Le,()=>e(i).title,s=>e(i).title=s),gt(he,()=>e(i).type,s=>e(i).type=s),gt(E,()=>e(i).status,s=>e(i).status=s),we(st,()=>e(i).deadline_at,s=>e(i).deadline_at=s),we(lt,()=>e(i).body,s=>e(i).body=s),$t(3,g,()=>er,()=>({duration:Y.getTransitionDuration()})),d(l,g)};D(ot,l=>{f.isOpen&&l(ht)})}d(bt,it),Ft()}Ht(["click","keydown","change"]);var kr=u('<button class="fixed right-8 bottom-24 z-50 rounded-full p-4 shadow-lg/30 drop-shadow-lg backdrop-blur-md transition-all hover:scale-105 hover:brightness-110 md:right-16 md:bottom-16" aria-label="New Task"><!></button>'),Dr=u('<div class="flex h-48 items-center justify-center"><!></div>'),Tr=u('<div class="rounded-lg border border-zinc-800 bg-zinc-900/60 p-6 text-zinc-400">Sign in to view tasks.</div>'),Cr=u('<div class="rounded-lg border border-zinc-800 bg-zinc-900/60 p-6 text-zinc-400">No tasks yet.</div>'),Ar=u("<option> </option>"),Sr=u("<option> </option>"),Lr=u('<div title="Task Color"></div>'),Er=u('<span class="text-zinc-500">•</span> <span> </span>',1),jr=u('<span class="text-zinc-500">•</span> <!> <span> </span>',1),Mr=u('<span class="text-zinc-500">•</span> <!> <span> </span>',1),Or=u("<p> </p>"),Ur=u('<div class="flex flex-col gap-0.5"><span class="text-[10px] font-bold tracking-wider text-zinc-500 uppercase">Completed</span> <span> </span></div>'),Fr=u('<button type="button"><div class="flex flex-col gap-3"><div class="flex items-start justify-between gap-3"><div class="min-w-0 flex-1"><div class="flex flex-wrap items-center gap-2"><!> <h3> </h3></div> <div class="mt-1 flex items-center gap-2 text-xs"><div> </div> <!> <!> <!></div></div></div> <!> <div class="mt-2 flex items-center gap-4 border-t border-zinc-800/50 pt-3"><div class="flex gap-4"><div class="flex flex-col gap-0.5"><span class="text-[10px] font-bold tracking-wider text-zinc-500 uppercase">Deadline</span> <span> </span></div> <!></div></div></div></button>'),Hr=u('<div class="my-8 flex items-center gap-4"><div class="h-px flex-1 bg-zinc-800"></div> <span class="text-sm font-medium tracking-wider text-zinc-500 uppercase">Archived</span> <div class="h-px flex-1 bg-zinc-800"></div></div> <div class="grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3"></div>',1),Ir=u('<div class="grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3"></div> <!>',1),Nr=u("<div></div>"),Wr=u('<span class="text-[10px] text-zinc-500 uppercase"> </span>'),Br=u('<button class="group flex flex-col gap-1 rounded border border-zinc-800 bg-zinc-900/60 p-2 text-left transition-colors hover:bg-zinc-800/80"><div class="flex items-center gap-2"><!> <span class="truncate text-xs font-medium text-zinc-300"> </span></div> <div class="flex items-center gap-2"><!></div></button>'),qr=u('<div><div class="flex items-center justify-between border-b border-zinc-800 pb-2"><span> </span> <span> </span></div> <div class="flex flex-1 flex-col gap-2"></div></div>'),Pr=u('<div class="flex flex-col gap-4 md:grid md:grid-cols-7"></div>'),Gr=u('<div class="mb-4 flex flex-wrap justify-between gap-4 text-sm"><div class="flex flex-wrap items-center gap-2"><select class="cursor-pointer rounded-md border border-zinc-700 bg-zinc-800 px-3 py-1.5 text-sm text-zinc-100 shadow-sm outline-none focus:border-indigo-500 focus:ring-indigo-500"></select> <button class="flex items-center justify-center rounded-md border border-zinc-700 bg-zinc-800 p-1.5 text-zinc-400 shadow-sm transition-colors hover:bg-zinc-700 hover:text-zinc-100" aria-label="Toggle sort order"><!></button></div> <div class="flex items-center gap-2"><select class="cursor-pointer rounded-md border border-zinc-700 bg-zinc-800 px-3 py-1.5 text-sm text-zinc-100 shadow-sm outline-none focus:border-indigo-500 focus:ring-indigo-500"><option>All Tasks</option><!></select></div> <div class="ml-auto flex items-center gap-4"><span class="text-xs text-zinc-500"> </span> <div class="flex items-center rounded-lg bg-zinc-800/50 p-1"><button aria-label="List View"><!></button> <button aria-label="Week View"><!></button></div></div></div> <!>',1),Rr=u('<!> <section><div class="flex flex-wrap items-center justify-between gap-4"><h2 class="hidden text-lg font-bold text-zinc-100 md:block">Tasks</h2> <!></div> <!></section>',1);function sa(bt,f){Ot(f,!0);let i=X(null),B=X(!0),ue=X(Ut([])),ee=X(!1),pe=X(null),me=X("list");const ft=40;let le=X("deadline"),De=X("asc"),Te=X("all"),_t=G(()=>e(Te)==="all"?e(ue):e(ue).filter(a=>a.type===e(Te))),tt=G(()=>[...e(_t)].sort((a,n)=>{const v=e(De)==="asc"?1:-1;if(e(le)==="title")return(a.title||"").localeCompare(n.title||"")*v;if(e(le)==="deadline"){const b=a.deadline_at?new Date(a.deadline_at).getTime():v===1?1/0:-1/0,E=n.deadline_at?new Date(n.deadline_at).getTime():v===1?1/0:-1/0;return(b-E)*v}else if(e(le)==="completed"){const b=a.completed_at?new Date(a.completed_at).getTime():0,E=n.completed_at?new Date(n.completed_at).getTime():0;return(b-E)*v}else if(e(le)==="created"){const b=new Date(a.created_at).getTime(),E=new Date(n.created_at).getTime();return(b-E)*v}else if(e(le)==="status")return(a.status||"").localeCompare(n.status||"")*v;return 0})),rt=G(()=>e(tt).filter(a=>a.status!=="done")),at=G(()=>e(tt).filter(a=>a.status==="done")),pt=G(()=>e(ue).filter(a=>a.status==="done").length),mt=G(()=>{const a=new Date,n=a.getDay(),v=a.getDate()-n+(n===0?-6:1),b=new Date(a);b.setDate(v),b.setHours(0,0,0,0);const E=[];for(let W=0;W<7;W++){const ae=new Date(b);ae.setDate(b.getDate()+W),E.push(ae)}return E});function xt(a){return e(rt).filter(n=>{if(!n.deadline_at)return!1;const v=new Date(n.deadline_at);return v.getFullYear()===a.getFullYear()&&v.getMonth()===a.getMonth()&&v.getDate()===a.getDate()})}Jt(()=>{Ie.auth.getSession().then(({data:{session:n}})=>{y(i,n,!0),n?xe():y(B,!1)});const{data:{subscription:a}}=Ie.auth.onAuthStateChange((n,v)=>{y(i,v,!0),v?xe():y(B,!1)});return()=>a.unsubscribe()});async function xe(){y(B,!0),console.log("Fetching tasks...");const{data:a,error:n}=await Ie.from("tasks").select("*").order("deadline_at",{ascending:!0});!n&&a?y(ue,a,!0):n&&console.error("Error fetching tasks:",n),y(B,!1)}function it(){y(pe,null),y(ee,!0)}function ot(a){y(pe,a,!0),y(ee,!0)}async function ht(a){if(!await Qt("Are you sure you want to delete this task?","Delete Task",{confirmText:"Delete",isDestructive:!0}))return;const{error:v}=await Ie.from("tasks").delete().eq("id",a);v?(console.error("Error deleting task:",v),He("Error deleting: "+v.message,"Error")):(He("Task deleted successfully!","Success"),y(ee,!1),xe())}async function l(a){const{id:n,...v}=a;if(e(pe)){const{error:b}=await Ie.from("tasks").update(v).eq("id",e(pe).id);b?(console.error("Error updating task:",b),He("Error updating: "+b.message,"Error")):(He("Task updated successfully!","Success"),y(ee,!1),xe())}else{const{error:b}=await Ie.from("tasks").insert(v);b?(console.error("Error saving task:",b),He("Error saving: "+b.message,"Error")):(He("Task saved successfully!","Success"),y(ee,!1),xe())}}const g=a=>a?new Date(a).toLocaleDateString():"—";function T(a,n=ft){return a?a.length>n?a.slice(0,n)+"...":a:""}function J(a){switch(a){case"todo":return{bg:"bg-zinc-500/10",text:"text-zinc-400",border:"border-zinc-500/20"};case"in_progress":return{bg:"bg-indigo-500/10",text:"text-indigo-400",border:"border-indigo-500/20"};case"done":return{bg:"bg-emerald-500/10",text:"text-emerald-400",border:"border-emerald-500/20"};case"archived":return{bg:"bg-zinc-800",text:"text-zinc-500",border:"border-zinc-700"};default:return{bg:"bg-zinc-500/10",text:"text-zinc-400",border:"border-zinc-500/20"}}}function te(a){return a?a.split("_").map(n=>n.charAt(0).toUpperCase()+n.slice(1)).join(" "):"Unknown"}function Ce(a){if(!a)return{total:0,completed:0};if(Array.isArray(a)&&a.length>0&&"items"in a[0]){let n=0,v=0;return a.forEach(b=>{b.items&&(n+=b.items.length,v+=b.items.filter(E=>E.completed).length)}),{total:n,completed:v}}return Array.isArray(a)&&a.length>0?{total:a.length,completed:a.filter(n=>n.completed).length}:{total:0,completed:0}}var Ae=Rr(),re=Q(Ae);wr(re,{get isOpen(){return e(ee)},get entry(){return e(pe)},onClose:()=>y(ee,!1),onSave:l,onDelete:ht});var Se=o(re,2),Le=r(Se),Ne=o(r(Le),2);{var We=a=>{var n=kr();n.__click=it;var v=r(n);It(v,{class:"h-6 w-6 text-(--accent-color)"}),t(n),C((b,E)=>ke(n,`--accent-color: ${b??""}; background-color: ${E??""}/50`),[()=>Y.getAccentLightHex(),()=>Y.getAccentHex()]),d(a,n)};D(Ne,a=>{e(i)&&!e(ee)&&!Xt.isOpen&&a(We)})}t(Le);var nt=o(Le,2);{var he=a=>{var n=Dr(),v=r(n);{let b=G(()=>Y.getAccentHex());Zt(v,{class:"h-6 w-6 animate-spin",get style(){return`color: ${e(b)??""}`}})}t(n),d(a,n)},Be=a=>{var n=ut(),v=Q(n);{var b=W=>{var ae=Tr();d(W,ae)},E=W=>{var ae=ut(),st=Q(ae);{var qe=ie=>{var ge=Cr();d(ie,ge)},lt=ie=>{var ge=Gr(),Ee=Q(ge),Pe=r(Ee),je=r(Pe);Z(je,20,()=>["title","deadline","created","status","completed"],$,(p,w)=>{var h=Ar(),A=r(h,!0);t(h);var U={};C(R=>{O(A,R),U!==(U=w)&&(h.value=(h.__value=w)??"")},[()=>w.charAt(0).toUpperCase()+w.slice(1)]),d(p,h)}),t(je);var Ge=o(je,2);Ge.__click=()=>y(De,e(De)==="asc"?"desc":"asc",!0);var Re=r(Ge);{var Ve=p=>{cr(p,{class:"h-4 w-4"})},ct=p=>{dr(p,{class:"h-4 w-4"})};D(Re,p=>{e(De)==="asc"?p(Ve):p(ct,!1)})}t(Ge),t(Pe);var Ye=o(Pe,2),Je=r(Ye),Ke=r(Je);Ke.value=Ke.__value="all";var dt=o(Ke);Z(dt,17,()=>Y.settings.task_types,$,(p,w)=>{var h=Sr(),A=r(h,!0);t(h);var U={};C(()=>{O(A,e(w).label),U!==(U=e(w).id)&&(h.value=(h.__value=e(w).id)??"")}),d(p,h)}),t(Je),t(Ye);var Me=o(Ye,2),Qe=r(Me),zt=r(Qe);t(Qe);var Xe=o(Qe,2),be=r(Xe);be.__click=()=>y(me,"list");var yt=r(be);lr(yt,{class:"h-4 w-4"}),t(be);var s=o(be,2);s.__click=()=>y(me,"week");var _=r(s);ir(_,{class:"h-4 w-4"}),t(s),t(Xe),t(Me),t(Ee);var k=o(Ee,2);{var j=p=>{const w=(S,c=jt,m=jt)=>{const oe=G(()=>J(c().status));var I=Fr();I.__click=()=>ot(c());var ce=r(I),ne=r(ce),K=r(ne),L=r(K),de=r(L);{var ze=x=>{var z=Lr();C((F,P)=>{M(z,1,F),ke(z,P)},[()=>`h-3 w-3 rounded-full ${m()?"opacity-50":""} ${c().color.startsWith("bg-")?c().color:""}`,()=>c().color.startsWith("bg-")?"":`background-color: ${c().color}`]),d(x,z)};D(de,x=>{c().color&&x(ze)})}var V=o(de,2),Oe=r(V,!0);t(V),t(L);var q=o(L,2),fe=r(q),_e=r(fe,!0);t(fe);var Ue=o(fe,2);{var N=x=>{var z=Er(),F=o(Q(z),2),P=r(F,!0);t(F),C(ye=>{M(F,1,Kt(m()?"text-zinc-600":"text-zinc-400")),O(P,ye)},[()=>Y.getTaskType(c().type)?.label??c().type]),d(x,z)};D(Ue,x=>{c().type&&x(N)})}var se=o(Ue,2);{var ve=x=>{const z=G(()=>Ce(c().checklist));var F=ut(),P=Q(F);{var ye=et=>{var Lt=jr(),Et=o(Q(Lt),2);{let Gt=G(()=>`h-4 w-4 ${m()?"text-zinc-600":"text-zinc-400"}`);nr(Et,{get class(){return e(Gt)}})}var Dt=o(Et,2),Pt=r(Dt);t(Dt),C(()=>{M(Dt,1,`text-xs ${m()?"text-zinc-600":"text-zinc-500"}`),O(Pt,`${e(z).completed??""}/${e(z).total??""}`)}),d(et,Lt)};D(P,et=>{e(z).total>0&&et(ye)})}d(x,F)};D(se,x=>{c().checklist&&x(ve)})}var Ze=o(se,2);{var $e=x=>{var z=Mr(),F=o(Q(z),2);{let et=G(()=>`h-4 w-4 ${m()?"text-zinc-600":"text-zinc-400"}`);or(F,{get class(){return e(et)}})}var P=o(F,2),ye=r(P,!0);t(P),C(()=>{M(P,1,`text-xs ${m()?"text-zinc-600":"text-zinc-500"}`),O(ye,c().links.length)}),d(x,z)};D(Ze,x=>{c().links&&c().links.length>0&&x($e)})}t(q),t(K),t(ne);var Ct=o(ne,2);{var Nt=x=>{var z=Or(),F=r(z,!0);t(z),C(P=>{M(z,1,`text-sm ${m()?"text-zinc-600":"text-zinc-400"}`),O(F,P)},[()=>T(c().body)]),d(x,z)};D(Ct,x=>{c().body&&x(Nt)})}var At=o(Ct,2),St=r(At),wt=r(St),kt=o(r(wt),2),Wt=r(kt,!0);t(kt),t(wt);var Bt=o(wt,2);{var qt=x=>{var z=Ur(),F=o(r(z),2),P=r(F,!0);t(F),t(z),C(ye=>{M(F,1,`text-xs ${m()?"text-zinc-500":"text-emerald-400"}`),O(P,ye)},[()=>g(c().completed_at)]),d(x,z)};D(Bt,x=>{c().completed_at&&x(qt)})}t(St),t(At),t(ce),t(I),C((x,z)=>{M(I,1,`group relative flex w-full cursor-pointer flex-col justify-between rounded-lg border p-4 text-left transition-all ${m()?"border-zinc-800/60 bg-zinc-900/30 text-zinc-500 hover:border-zinc-700/60 hover:bg-zinc-900/40":"border-zinc-800 bg-zinc-900/60 hover:border-zinc-700 hover:bg-zinc-900/80"}`),M(V,1,`truncate text-base font-bold ${m()?"text-zinc-500":"text-zinc-100"}`),Mt(V,"title",c().title),O(Oe,c().title),M(fe,1,`shrink-0 rounded-full px-2 py-0.5 font-medium ${e(oe).bg} ${e(oe).text}`),O(_e,x),M(kt,1,`text-xs ${m()?"text-zinc-500":"text-zinc-300"}`),O(Wt,z)},[()=>te(c().status),()=>g(c().deadline_at)]),d(S,I)};var h=Ir(),A=Q(h);Z(A,21,()=>e(rt),$,(S,c)=>{w(S,()=>e(c),()=>!1)}),t(A);var U=o(A,2);{var R=S=>{var c=Hr(),m=o(Q(c),2);Z(m,21,()=>e(at),$,(oe,I)=>{w(oe,()=>e(I),()=>!0)}),t(m),d(S,c)};D(U,S=>{e(at).length>0&&S(R)})}d(p,h)},H=p=>{var w=Pr();Z(w,21,()=>e(mt),$,(h,A)=>{const U=G(()=>xt(e(A))),R=G(()=>new Date().toDateString()===e(A).toDateString());var S=qr(),c=r(S),m=r(c),oe=r(m,!0);t(m);var I=o(m,2),ce=r(I,!0);t(I),t(c);var ne=o(c,2);Z(ne,21,()=>e(U),$,(K,L)=>{var de=Br();de.__click=()=>ot(e(L));var ze=r(de),V=r(ze);{var Oe=se=>{var ve=Nr();C((Ze,$e)=>{M(ve,1,Ze),ke(ve,$e)},[()=>`h-2 w-2 shrink-0 rounded-full ${e(L).color.startsWith("bg-")?e(L).color:""}`,()=>e(L).color.startsWith("bg-")?"":`background-color: ${e(L).color}`]),d(se,ve)};D(V,se=>{e(L).color&&se(Oe)})}var q=o(V,2),fe=r(q,!0);t(q),t(ze);var _e=o(ze,2),Ue=r(_e);{var N=se=>{var ve=Wr(),Ze=r(ve,!0);t(ve),C($e=>O(Ze,$e),[()=>Y.getTaskType(e(L).type)?.label??e(L).type]),d(se,ve)};D(Ue,se=>{e(L).type&&se(N)})}t(_e),t(de),C(()=>{Mt(q,"title",e(L).title),O(fe,e(L).title)}),d(K,de)}),t(ne),t(S),C((K,L)=>{M(S,1,`flex min-h-[200px] flex-col gap-2 rounded-lg border p-2 ${e(R)?"border-zinc-700 bg-zinc-900/40":"border-transparent"}`),M(m,1,`text-sm font-medium ${e(R)?"text-indigo-400":"text-zinc-400"}`),O(oe,K),M(I,1,`text-xs ${e(R)?"text-indigo-400":"text-zinc-600"}`),O(ce,L)},[()=>e(A).toLocaleDateString("en-US",{weekday:"short"}),()=>e(A).getDate()]),d(h,S)}),t(w),d(p,w)};D(k,p=>{e(me)==="list"?p(j):p(H,!1)})}C(()=>{O(zt,`Completed ${e(pt)??""} / ${e(ue).length??""}`),M(be,1,`rounded-md p-1.5 transition-all ${e(me)==="list"?"bg-zinc-700 text-white shadow-sm":"text-zinc-400 hover:text-zinc-300"}`),M(s,1,`rounded-md p-1.5 transition-all ${e(me)==="week"?"bg-zinc-700 text-white shadow-sm":"text-zinc-400 hover:text-zinc-300"}`)}),gt(je,()=>e(le),p=>y(le,p)),gt(Je,()=>e(Te),p=>y(Te,p)),d(ie,ge)};D(st,ie=>{e(ue).length===0?ie(qe):ie(lt,!1)},!0)}d(W,ae)};D(v,W=>{e(i)?W(E,!1):W(b)},!0)}d(a,n)};D(nt,a=>{e(B)&&e(i)!==null?a(he):a(Be,!1)})}t(Se),d(bt,Ae),Ft()}Ht(["click"]);export{sa as component};
