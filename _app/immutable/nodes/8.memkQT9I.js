import{c as ve,a as v,f as g}from"../chunks/wK1Vbmlk.js";import{g as P,p as Je,s as R,c as Qe,d as nt,f as b,a as Re,h as r,i as a,j as s,t as j,k as e,l as lt,n as Ve,o as ct,v as Ge}from"../chunks/BYhnerF1.js";import{d as We,s as E,e as dt}from"../chunks/DJuLYhV6.js";import{l as Xe,s as Ye,i as x}from"../chunks/D8lGRnAB.js";import{I as Ze,a as $e,r as le,e as je,i as Ae,b as vt,f as Ee,c as ut,d as ce,s as ft,h as pt,g as bt}from"../chunks/Bwlg0huN.js";import{s as de}from"../chunks/Bkout0r_.js";import{b as te,P as et,L as mt}from"../chunks/Kn-75_P5.js";import{A as tt,a as at}from"../chunks/CpuzINp4.js";import{T as _t}from"../chunks/CMFy1DSP.js";import{S as gt}from"../chunks/uwWB27Mv.js";import"../chunks/DU-Tk7Uy.js";function ht(W,c){const t=Xe(c,["children","$$slots","$$events","$$legacy"]);const C=[["path",{d:"M13 5h8"}],["path",{d:"M13 12h8"}],["path",{d:"M13 19h8"}],["path",{d:"m3 17 2 2 4-4"}],["path",{d:"m3 7 2 2 4-4"}]];Ze(W,Ye({name:"list-checks"},()=>t,{get iconNode(){return C},children:(A,D)=>{var w=ve(),h=P(w);$e(h,c,"default",{}),v(A,w)},$$slots:{default:!0}}))}function xt(W,c){const t=Xe(c,["children","$$slots","$$events","$$legacy"]);const C=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2"}]];Ze(W,Ye({name:"square"},()=>t,{get iconNode(){return C},children:(A,D)=>{var w=ve(),h=P(w);$e(h,c,"default",{}),v(A,w)},$$slots:{default:!0}}))}var wt=g("<option> </option>"),kt=g('<button type="button" class="text-xs text-indigo-400 hover:text-indigo-300">+ Create Checklist</button>'),yt=g('<div class="flex items-center gap-2"><button type="button" class="text-zinc-400 hover:text-zinc-200"><!></button> <input type="text" placeholder="Checklist item..."/> <div class="flex items-center gap-1"><button type="button" class="p-1 text-zinc-500 hover:text-zinc-300 disabled:opacity-30"><!></button> <button type="button" class="p-1 text-zinc-500 hover:text-zinc-300 disabled:opacity-30"><!></button> <button type="button" class="p-1 text-red-500 hover:text-red-400"><!></button></div></div>'),zt=g('<div class="space-y-2"><!> <button type="button" class="mt-2 flex items-center gap-1 text-sm text-zinc-400 hover:text-zinc-200"><!> Add Item</button></div>'),Ct=g('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/70 p-2 backdrop-blur-sm md:p-4" role="dialog" aria-modal="true" tabindex="-1"><div class="flex max-h-[95vh] w-full max-w-2xl flex-col overflow-y-auto rounded-xl border border-zinc-800 bg-zinc-900 shadow-xl md:max-h-[90vh]"><div class="sticky top-0 z-10 flex items-center justify-between border-b border-zinc-800 bg-zinc-900 p-4 md:p-6"><h2 class="text-xl font-bold text-zinc-100"> </h2> <button class="text-zinc-400 transition-colors hover:text-zinc-200" aria-label="Close"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <form class="space-y-6 p-4 md:p-6"><div><label for="title" class="mb-1 block text-sm font-medium text-zinc-400">Title</label> <input type="text" id="title" required class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"/></div> <div class="grid grid-cols-1 gap-6 md:grid-cols-2"><div><label for="type" class="mb-1 block text-sm font-medium text-zinc-400">Type</label> <input type="text" id="type" placeholder="e.g. Design, Dev, Admin" class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"/></div> <div><label for="color" class="mb-1 block text-sm font-medium text-zinc-400">Color</label> <div class="flex gap-2"><input type="color" id="color" class="h-10 w-20 cursor-pointer rounded-md border border-zinc-700 bg-zinc-800 p-1"/> <input type="text" class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" placeholder="#000000"/></div></div> <div><label for="status" class="mb-1 block text-sm font-medium text-zinc-400">Status</label> <select id="status" class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"></select></div></div> <div><label for="body" class="mb-1 block text-sm font-medium text-zinc-400">Description</label> <textarea id="body" rows="3" class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"></textarea></div> <div><div class="mb-2 flex items-center justify-between"><span class="block text-sm font-medium text-zinc-400">Checklist</span> <!></div> <!></div> <div class="grid grid-cols-1 gap-6 md:grid-cols-2"><div><label for="deadline_at" class="mb-1 block text-sm font-medium text-zinc-400">Deadline</label> <input type="date" id="deadline_at" class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"/></div></div> <div class="sticky bottom-0 mt-6 flex justify-end gap-3 border-t border-zinc-800 bg-zinc-900 pt-4"><button type="button" class="rounded-md bg-zinc-800 px-3.5 py-2.5 text-sm font-semibold text-zinc-200 shadow-sm ring-1 ring-zinc-700 ring-inset hover:bg-zinc-700">Cancel</button> <button type="submit" class="rounded-md bg-indigo-600 px-3.5 py-2.5 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600">Save</button></div></form></div></div>');function Dt(W,c){Je(c,!0);let t=R(Qe({title:"",type:"",status:"todo",body:"",deadline_at:"",completed_at:null,color:"#000000",checklist:null}));const C=[{value:"todo",label:"To Do"},{value:"in_progress",label:"In Progress"},{value:"done",label:"Done"},{value:"archived",label:"Archived"}];nt(()=>{c.isOpen&&(c.entry?b(t,{title:c.entry.title||"",type:c.entry.type||"",status:c.entry.status||"todo",body:c.entry.body||"",deadline_at:c.entry.deadline_at||"",completed_at:c.entry.completed_at||null,color:c.entry.color||"#000000",checklist:c.entry.checklist||null},!0):b(t,{title:"",type:"",status:"todo",body:"",deadline_at:"",completed_at:null,color:"#000000",checklist:null},!0))});function A(u){u.preventDefault(),e(t).status==="done"?e(t).completed_at||(e(t).completed_at=new Date().toISOString()):e(t).completed_at=null;const k={...e(t),deadline_at:e(t).deadline_at||null};c.onSave(k)}function D(u){u.target===u.currentTarget&&c.onClose()}function w(u){u.key==="Escape"&&c.onClose()}function h(){e(t).checklist=[]}function X(){e(t).checklist||(e(t).checklist=[]),e(t).checklist=[...e(t).checklist,{text:"",completed:!1}]}function Ie(u){e(t).checklist&&(e(t).checklist=e(t).checklist.filter((k,I)=>I!==u),e(t).checklist.length===0&&(e(t).checklist=null))}function Me(u){e(t).checklist&&(e(t).checklist[u].completed=!e(t).checklist[u].completed)}function K(u,k){if(!e(t).checklist)return;const I=k==="up"?u-1:u+1;if(I<0||I>=e(t).checklist.length)return;const Y=e(t).checklist[u],M=[...e(t).checklist];M.splice(u,1),M.splice(I,0,Y),e(t).checklist=M}var xe=ve(),Le=P(xe);{var Ne=u=>{var k=Ct();k.__click=D,k.__keydown=w;var I=r(k),Y=r(I),M=r(Y),we=r(M,!0);a(M);var ke=s(M,2);ke.__click=function(...o){c.onClose?.apply(this,o)},a(Y);var Z=s(Y,2),ue=r(Z),ye=s(r(ue),2);le(ye),a(ue);var fe=s(ue,2),pe=r(fe),ze=s(r(pe),2);le(ze),a(pe);var i=s(pe,2),n=s(r(i),2),l=r(n);le(l);var m=s(l,2);le(m),a(n),a(i);var L=s(i,2),N=s(r(L),2);je(N,21,()=>C,Ae,(o,p)=>{var y=wt(),T=r(y,!0);a(y);var H={};j(()=>{E(T,e(p).label),H!==(H=e(p).value)&&(y.value=(y.__value=e(p).value)??"")}),v(o,y)}),a(N),a(L),a(fe);var V=s(fe,2),Ce=s(r(V),2);lt(Ce),a(V);var be=s(V,2),me=r(be),G=s(r(me),2);{var ae=o=>{var p=kt();p.__click=h,v(o,p)};x(G,o=>{e(t).checklist||o(ae)})}a(me);var _e=s(me,2);{var De=o=>{var p=zt(),y=r(p);je(y,17,()=>e(t).checklist,Ae,(F,B,O)=>{var U=yt(),J=r(U);J.__click=()=>Me(O);var S=r(J);{var se=z=>{gt(z,{class:"h-5 w-5 text-emerald-500"})},Be=z=>{xt(z,{class:"h-5 w-5"})};x(S,z=>{e(B).completed?z(se):z(Be,!1)})}a(J);var $=s(J,2);le($);var Se=s($,2),ee=r(Se);ee.__click=()=>K(O,"up"),ee.disabled=O===0;var Oe=r(ee);tt(Oe,{class:"h-4 w-4"}),a(ee);var Q=s(ee,2);Q.__click=()=>K(O,"down");var qe=r(Q);at(qe,{class:"h-4 w-4"}),a(Q);var oe=s(Q,2);oe.__click=()=>Ie(O);var he=r(oe);_t(he,{class:"h-4 w-4"}),a(oe),a(Se),a(U),j(()=>{Ee($,1,`w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 ${e(B).completed?"text-zinc-500 line-through":""}`),Q.disabled=O===(e(t).checklist?.length??0)-1}),te($,()=>e(B).text,z=>e(B).text=z),v(F,U)});var T=s(y,2);T.__click=X;var H=r(T);et(H,{class:"h-4 w-4"}),Ve(),a(T),a(p),v(o,p)};x(_e,o=>{e(t).checklist&&o(De)})}a(be);var re=s(be,2),Te=r(re),ge=s(r(Te),2);le(ge),a(Te),a(re);var ie=s(re,2),d=r(ie);d.__click=function(...o){c.onClose?.apply(this,o)},Ve(2),a(ie),a(Z),a(I),a(k),j(()=>E(we,c.entry?"Edit Task":"New Task")),dt("submit",Z,A),te(ye,()=>e(t).title,o=>e(t).title=o),te(ze,()=>e(t).type,o=>e(t).type=o),te(l,()=>e(t).color,o=>e(t).color=o),te(m,()=>e(t).color,o=>e(t).color=o),vt(N,()=>e(t).status,o=>e(t).status=o),te(Ce,()=>e(t).body,o=>e(t).body=o),te(ge,()=>e(t).deadline_at,o=>e(t).deadline_at=o),v(u,k)};x(Le,u=>{c.isOpen&&u(Ne)})}v(W,xe),Re()}We(["click","keydown"]);var Tt=g('<button class="fixed right-8 bottom-8 z-50 rounded-full bg-indigo-600 p-4 text-white shadow-lg transition-transform hover:scale-105 hover:bg-indigo-500" aria-label="New Task"><!></button>'),St=g('<div class="flex h-48 items-center justify-center"><!></div>'),Et=g('<div class="rounded-lg border border-zinc-800 bg-zinc-900/60 p-6 text-zinc-400">Sign in to view tasks.</div>'),jt=g('<div class="rounded-lg border border-zinc-800 bg-zinc-900/60 p-6 text-zinc-400">No tasks yet.</div>'),At=g('<button><span class="capitalize"> </span> <!></button>'),It=g('<div class="h-3 w-3 rounded-full" title="Task Color"></div>'),Mt=g('<span class="text-zinc-500">•</span> <span class="text-zinc-400"> </span>',1),Lt=g('<span class="text-zinc-500">•</span> <!> <span class="text-xs text-zinc-500"> </span>',1),Nt=g('<p class="text-sm text-zinc-400 line-clamp-3"> </p>'),Bt=g('<div class="flex flex-col gap-0.5"><span class="text-[10px] font-bold tracking-wider text-zinc-500 uppercase">Completed</span> <span class="text-xs text-emerald-400"> </span></div>'),Ot=g('<li><div class="flex flex-col gap-3"><div class="flex items-start justify-between gap-3"><div class="min-w-0 flex-1"><div class="flex flex-wrap items-center gap-2"><!> <h3 class="truncate text-base font-bold text-zinc-100"> </h3></div> <div class="mt-1 flex items-center gap-2 text-xs"><div> </div> <!> <!></div></div></div> <!> <div class="mt-2 flex items-center justify-between gap-4 border-t border-zinc-800/50 pt-3"><div class="flex gap-4"><div class="flex flex-col gap-0.5"><span class="text-[10px] font-bold tracking-wider text-zinc-500 uppercase">Deadline</span> <span class="text-xs text-zinc-300"> </span></div> <!></div> <div class="flex items-center gap-2"><button class="rounded-md p-2 text-indigo-400 transition-colors hover:bg-zinc-800 hover:text-indigo-300" aria-label="Edit"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg></button> <button class="rounded-md p-2 text-red-400 transition-colors hover:bg-zinc-800 hover:text-red-300" aria-label="Delete"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg></button></div></div></div></li>'),qt=g('<div class="mb-4 flex flex-wrap items-center gap-4 text-sm"><span class="text-zinc-500">Sort by:</span> <!> <span class="ml-auto text-xs text-zinc-500"> </span></div> <ul class="grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3"></ul>',1),Pt=g('<!> <section class="space-y-6"><div class="flex flex-wrap items-center justify-between gap-4"><h2 class="text-lg font-bold text-zinc-100">Tasks</h2> <!></div> <!></section>',1);function Yt(W,c){Je(c,!0);let t=R(null),C=R(!0),A=R(Qe([])),D=R(!1),w=R(null),h=R("deadline"),X=R("asc"),Ie=Ge(()=>[...e(A)].sort((i,n)=>{const l=e(X)==="asc"?1:-1;if(e(h)==="title")return(i.title||"").localeCompare(n.title||"")*l;if(e(h)==="deadline"){const m=i.deadline_at?new Date(i.deadline_at).getTime():l===1?1/0:-1/0,L=n.deadline_at?new Date(n.deadline_at).getTime():l===1?1/0:-1/0;return(m-L)*l}else if(e(h)==="completed"){const m=i.completed_at?new Date(i.completed_at).getTime():0,L=n.completed_at?new Date(n.completed_at).getTime():0;return(m-L)*l}else if(e(h)==="created"){const m=new Date(i.created_at).getTime(),L=new Date(n.created_at).getTime();return(m-L)*l}else if(e(h)==="status")return(i.status||"").localeCompare(n.status||"")*l;return 0}));function Me(i){e(h)===i?b(X,e(X)==="asc"?"desc":"asc",!0):(b(h,i,!0),b(X,"asc"))}ct(()=>{de.auth.getSession().then(({data:{session:n}})=>{b(t,n,!0),n?K():b(C,!1)});const{data:{subscription:i}}=de.auth.onAuthStateChange((n,l)=>{b(t,l,!0),l?K():b(C,!1)});return()=>i.unsubscribe()});async function K(){b(C,!0),console.log("Fetching tasks...");const{data:i,error:n}=await de.from("tasks").select("*").order("deadline_at",{ascending:!0});!n&&i?b(A,i,!0):n&&console.error("Error fetching tasks:",n),b(C,!1)}function xe(){b(w,null),b(D,!0)}function Le(i){b(w,i,!0),b(D,!0)}async function Ne(i){if(!await bt("Are you sure you want to delete this task?","Delete Task",{confirmText:"Delete",isDestructive:!0}))return;const{error:l}=await de.from("tasks").delete().eq("id",i);l?(console.error("Error deleting task:",l),ce("Error deleting: "+l.message,"Error")):(ce("Task deleted successfully!","Success"),K())}async function u(i){const{id:n,...l}=i;if(e(w)){const{error:m}=await de.from("tasks").update(l).eq("id",e(w).id);m?(console.error("Error updating task:",m),ce("Error updating: "+m.message,"Error")):(ce("Task updated successfully!","Success"),b(D,!1),K())}else{const{error:m}=await de.from("tasks").insert(l);m?(console.error("Error saving task:",m),ce("Error saving: "+m.message,"Error")):(ce("Task saved successfully!","Success"),b(D,!1),K())}}const k=i=>i?new Date(i).toLocaleDateString():"—";function I(i){switch(i){case"todo":return{bg:"bg-zinc-500/10",text:"text-zinc-400",border:"border-zinc-500/20"};case"in_progress":return{bg:"bg-indigo-500/10",text:"text-indigo-400",border:"border-indigo-500/20"};case"done":return{bg:"bg-emerald-500/10",text:"text-emerald-400",border:"border-emerald-500/20"};case"archived":return{bg:"bg-zinc-800",text:"text-zinc-500",border:"border-zinc-700"};default:return{bg:"bg-zinc-500/10",text:"text-zinc-400",border:"border-zinc-500/20"}}}function Y(i){return i?i.split("_").map(n=>n.charAt(0).toUpperCase()+n.slice(1)).join(" "):"Unknown"}var M=Pt(),we=P(M);Dt(we,{get isOpen(){return e(D)},get entry(){return e(w)},onClose:()=>b(D,!1),onSave:u});var ke=s(we,2),Z=r(ke),ue=s(r(Z),2);{var ye=i=>{var n=Tt();n.__click=xe;var l=r(n);et(l,{class:"h-6 w-6"}),a(n),v(i,n)};x(ue,i=>{e(t)&&!e(D)&&!ut.isOpen&&i(ye)})}a(Z);var fe=s(Z,2);{var pe=i=>{var n=St(),l=r(n);mt(l,{class:"h-6 w-6 animate-spin text-indigo-400"}),a(n),v(i,n)},ze=i=>{var n=ve(),l=P(n);{var m=N=>{var V=Et();v(N,V)},L=N=>{var V=ve(),Ce=P(V);{var be=G=>{var ae=jt();v(G,ae)},me=G=>{var ae=qt(),_e=P(ae),De=s(r(_e),2);je(De,16,()=>["title","deadline","created","status","completed"],Ae,(ie,d)=>{var o=At();o.__click=()=>Me(d);var p=r(o),y=r(p,!0);a(p);var T=s(p,2);{var H=F=>{var B=ve(),O=P(B);{var U=S=>{tt(S,{class:"h-3 w-3"})},J=S=>{at(S,{class:"h-3 w-3"})};x(O,S=>{e(X)==="asc"?S(U):S(J,!1)})}v(F,B)};x(T,F=>{e(h)===d&&F(H)})}a(o),j(()=>{Ee(o,1,`flex items-center gap-1 rounded-md px-3 py-1.5 transition-colors ${e(h)===d?"bg-indigo-500/20 text-indigo-300":"bg-zinc-800/50 text-zinc-400 hover:bg-zinc-800"}`),E(y,d)}),v(ie,o)});var re=s(De,2),Te=r(re);a(re),a(_e);var ge=s(_e,2);je(ge,21,()=>e(Ie),Ae,(ie,d)=>{const o=Ge(()=>I(e(d).status));var p=Ot(),y=r(p),T=r(y),H=r(T),F=r(H),B=r(F);{var O=f=>{var _=It();j(()=>pt(_,`background-color: ${e(d).color??""}`)),v(f,_)};x(B,f=>{e(d).color&&f(O)})}var U=s(B,2),J=r(U,!0);a(U),a(F);var S=s(F,2),se=r(S),Be=r(se,!0);a(se);var $=s(se,2);{var Se=f=>{var _=Mt(),q=s(P(_),2),ne=r(q,!0);a(q),j(()=>E(ne,e(d).type)),v(f,_)};x($,f=>{e(d).type&&f(Se)})}var ee=s($,2);{var Oe=f=>{var _=Lt(),q=s(P(_),2);ht(q,{class:"h-4 w-4 text-zinc-400"});var ne=s(q,2),Pe=r(ne);a(ne),j(He=>E(Pe,`${He??""}/${e(d).checklist.length??""}`),[()=>e(d).checklist.filter(He=>He.completed).length]),v(f,_)};x(ee,f=>{e(d).checklist&&e(d).checklist.length>0&&f(Oe)})}a(S),a(H),a(T);var Q=s(T,2);{var qe=f=>{var _=Nt(),q=r(_,!0);a(_),j(()=>E(q,e(d).body)),v(f,_)};x(Q,f=>{e(d).body&&f(qe)})}var oe=s(Q,2),he=r(oe),z=r(he),Fe=s(r(z),2),rt=r(Fe,!0);a(Fe),a(z);var it=s(z,2);{var st=f=>{var _=Bt(),q=s(r(_),2),ne=r(q,!0);a(q),a(_),j(Pe=>E(ne,Pe),[()=>k(e(d).completed_at)]),v(f,_)};x(it,f=>{e(d).completed_at&&f(st)})}a(he);var Ue=s(he,2),Ke=r(Ue);Ke.__click=()=>Le(e(d));var ot=s(Ke,2);ot.__click=()=>Ne(e(d).id),a(Ue),a(oe),a(y),a(p),j((f,_)=>{Ee(p,1,`group relative flex flex-col justify-between rounded-lg border p-4 transition-all hover:bg-zinc-900/80 ${e(o).border} bg-zinc-900/40`),ft(U,"title",e(d).title),E(J,e(d).title),Ee(se,1,`shrink-0 rounded-full px-2 py-0.5 font-medium ${e(o).bg} ${e(o).text}`),E(Be,f),E(rt,_)},[()=>Y(e(d).status),()=>k(e(d).deadline_at)]),v(ie,p)}),a(ge),j(()=>E(Te,`Total: ${e(A).length??""}`)),v(G,ae)};x(Ce,G=>{e(A).length===0?G(be):G(me,!1)},!0)}v(N,V)};x(l,N=>{e(t)?N(L,!1):N(m)},!0)}v(i,n)};x(fe,i=>{e(C)&&e(t)!==null?i(pe):i(ze,!1)})}a(ke),v(W,M),Re()}We(["click"]);export{Yt as component};
