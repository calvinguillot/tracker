import{b as pe,d as Le,c as oe,a as b,f as y}from"../chunks/BqEl5C80.js";import{t as D,D as xe,F as we,G as Te,H as Be,I as ye,J as He,K as Re,L as qe,M as Fe,N as Ie,O as re,p as ke,s as k,c as Ee,d as Ke,g as l,f as B,a as Ne,h as a,i as o,j as n,l as Pe,k as e,o as Ge,v as Je}from"../chunks/DVg-wcBP.js";import{d as Ce,s as Q,e as Ve}from"../chunks/Bj2CMk_O.js";import{i as C}from"../chunks/C66CeOwb.js";import{r as ze,e as fe,b as ae,h as Ye,i as be,a as ge,d as Qe,f as L,g as Ue,j as We}from"../chunks/DZ1IOtyI.js";import{s as T}from"../chunks/Bkout0r_.js";import{b as ue,P as Xe,L as Ze}from"../chunks/CX2Dg3vE.js";import{A as $e,a as et}from"../chunks/DEyrxmCn.js";function tt(H,d,i=!1,p=!1,E=!1){var g=H,m="";D(()=>{var _=Te;if(m===(m=d()??"")){xe&&we();return}if(_.nodes!==null&&(Be(_.nodes.start,_.nodes.end),_.nodes=null),m!==""){if(xe){ye.data;for(var v=we(),f=v;v!==null&&(v.nodeType!==He||v.data!=="");)f=v,v=Re(v);if(v===null)throw qe(),Fe;pe(ye,f),g=Ie(v);return}var h=m+"";i?h=`<svg>${h}</svg>`:p&&(h=`<math>${h}</math>`);var u=Le(h);if((i||p)&&(u=re(u)),pe(re(u),u.lastChild),i||p)for(;re(u);)g.before(re(u));else g.before(u)}})}var rt=y('<button type="button" class="h-8 w-8 rounded-full border border-zinc-700 transition-transform hover:scale-110 focus:ring-2 focus:ring-zinc-400 focus:outline-none"></button>'),ot=y('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/70 p-2 backdrop-blur-sm md:p-4" role="dialog" aria-modal="true" tabindex="-1"><div class="flex max-h-[95vh] w-full max-w-2xl flex-col overflow-y-auto rounded-xl border border-zinc-800 bg-zinc-900 shadow-xl md:max-h-[90vh]"><div class="sticky top-0 z-10 flex items-center justify-between border-b border-zinc-800 bg-zinc-900 p-4 md:p-6"><h2 class="text-xl font-bold text-zinc-100"> </h2> <button class="text-zinc-400 transition-colors hover:text-zinc-200" aria-label="Close"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <form class="space-y-6 p-4 md:p-6"><div><label for="title" class="mb-1 block text-sm font-medium text-zinc-400">Title</label> <input type="text" id="title" required class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"/></div> <div><label for="body" class="mb-1 block text-sm font-medium text-zinc-400">Body</label> <textarea id="body" rows="10" class="w-full rounded-md border border-zinc-700 bg-zinc-800 p-2 text-zinc-100 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"></textarea></div> <div><label for="color" class="mb-1 block text-sm font-medium text-zinc-400">Color</label> <div class="flex flex-wrap gap-2"></div> <input type="hidden" name="color"/></div> <div class="sticky bottom-0 mt-6 flex justify-end gap-3 border-t border-zinc-800 bg-zinc-900 pt-4"><button type="button" class="rounded-md bg-zinc-800 px-3.5 py-2.5 text-sm font-semibold text-zinc-200 shadow-sm ring-1 ring-zinc-700 ring-inset hover:bg-zinc-700">Cancel</button> <button type="submit" class="rounded-md px-3.5 py-2.5 text-sm font-semibold text-white shadow-sm transition-all hover:brightness-110 focus-visible:outline-2 focus-visible:outline-offset-2">Save</button></div></form></div></div>');function at(H,d){ke(d,!0);let i=k(Ee({title:"",body:"",color:"#18181b"}));Ke(()=>{d.isOpen&&(d.entry?l(i,{title:d.entry.title||"",body:d.entry.body||"",color:d.entry.color||"#18181b"},!0):l(i,{title:"",body:"",color:"#18181b"},!0))});function p(f){f.preventDefault(),d.onSave(e(i))}function E(f){f.target===f.currentTarget&&d.onClose()}function g(f){f.key==="Escape"&&d.onClose()}var m=oe(),_=B(m);{var v=f=>{var h=ot();h.__click=E,h.__keydown=g;var u=a(h),R=a(u),q=a(R),se=a(q,!0);o(q);var ie=n(q,2);ie.__click=function(...t){d.onClose?.apply(this,t)},o(R);var F=n(R,2),S=a(F),I=n(a(S),2);ze(I),o(S);var A=n(S,2),j=n(a(A),2);Pe(j),o(A);var K=n(A,2),P=n(a(K),2);fe(P,21,()=>ge.settings.notes_types,be,(t,s)=>{var c=rt();c.__click=()=>e(i).color=e(s).color??"#18181b",D(()=>{ae(c,`background-color: ${e(s).color??""}; ${e(i).color===e(s).color?"border-color: white; transform: scale(1.1);":""}`),Ye(c,"aria-label",`Select color ${e(s).color??""}`)}),b(t,c)}),o(P);var U=n(P,2);ze(U),o(K);var W=n(K,2),X=a(W);X.__click=function(...t){d.onClose?.apply(this,t)};var r=n(X,2);o(W),o(F),o(u),o(h),D(t=>{Q(se,d.entry?"Edit Note":"New Note"),ae(r,`background-color: ${t??""}`)},[()=>ge.getAccentHex()]),Ve("submit",F,p),ue(I,()=>e(i).title,t=>e(i).title=t),ue(j,()=>e(i).body,t=>e(i).body=t),ue(U,()=>e(i).color,t=>e(i).color=t),b(f,h)};C(_,f=>{d.isOpen&&f(v)})}b(H,m),Ne()}Ce(["click","keydown"]);var st=y('<button class="fixed right-8 bottom-8 z-50 rounded-full p-4 text-white shadow-lg transition-all hover:scale-105 hover:brightness-110" aria-label="New Note"><!></button>'),it=y('<div class="flex h-48 items-center justify-center"><!></div>'),nt=y('<div class="rounded-lg border border-zinc-800 bg-zinc-900/60 p-6 text-zinc-400">Sign in to view notes.</div>'),lt=y('<div class="rounded-lg border border-zinc-800 bg-zinc-900/60 p-6 text-zinc-400">No notes yet.</div>'),ct=y('<button><span class="capitalize"> </span> <!></button>'),dt=y('<li class="group relative flex flex-col gap-4 rounded-lg border border-zinc-800 p-4 transition-all hover:border-zinc-700 hover:shadow-lg"><div class="flex flex-col gap-3"><h3 class="wrap-break-words text-lg font-bold text-zinc-100"> </h3> <div class="prose prose-sm max-w-none wrap-break-word text-zinc-300 prose-invert"><!></div></div> <div class="mt-auto flex items-center justify-between gap-4 border-t border-zinc-800/50 pt-3"><div class="text-xs text-zinc-400/70"> </div> <div class="flex items-center gap-2"><button class="rounded-md p-2 text-indigo-400 transition-colors hover:bg-black/20 hover:text-indigo-300" aria-label="Edit"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg></button> <button class="rounded-md p-2 text-red-400 transition-colors hover:bg-black/20 hover:text-red-300" aria-label="Delete"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg></button></div></div></li>'),vt=y('<div class="mb-4 flex flex-wrap items-center gap-4 text-sm"><span class="text-zinc-500">Sort by:</span> <!> <span class="ml-auto text-xs text-zinc-500"> </span></div> <ul class="grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3"></ul>',1),ut=y('<!> <section class="space-y-6"><div class="flex flex-wrap items-center justify-between gap-4"><h2 class="text-lg font-bold text-zinc-100">Notes</h2> <!></div> <!></section>',1);function wt(H,d){ke(d,!0);let i=k(null),p=k(!0),E=k(Ee([])),g=k(!1),m=k(null),_=k("created"),v=k("desc"),f=Je(()=>[...e(E)].sort((r,t)=>{const s=e(v)==="asc"?1:-1;if(e(_)==="title")return(r.title||"").localeCompare(t.title||"")*s;if(e(_)==="created"){const c=new Date(r.created_at).getTime(),ne=new Date(t.created_at).getTime();return(c-ne)*s}return 0}));function h(r){e(_)===r?l(v,e(v)==="asc"?"desc":"asc",!0):(l(_,r,!0),l(v,"desc"))}Ge(()=>{T.auth.getSession().then(({data:{session:t}})=>{l(i,t,!0),t?u():l(p,!1)});const{data:{subscription:r}}=T.auth.onAuthStateChange((t,s)=>{l(i,s,!0),s?u():l(p,!1)});return()=>r.unsubscribe()});async function u(){l(p,!0),console.log("Fetching notes...");const{data:r,error:t}=await T.from("notes").select("id, created_at, title, body, color").order("created_at",{ascending:!1});!t&&r?l(E,r,!0):t&&console.error("Error fetching notes:",t),l(p,!1)}function R(){l(m,null),l(g,!0)}function q(r){l(m,r,!0),l(g,!0)}async function se(r){if(!await We("Are you sure you want to delete this note?","Delete Note",{confirmText:"Delete",isDestructive:!0}))return;const{error:s}=await T.from("notes").delete().eq("id",r);s?(console.error("Error deleting note:",s),L("Error deleting: "+s.message,"Error")):(L("Note deleted successfully!","Success"),u())}async function ie(r){const{id:t,...s}=r;if(e(m)){const{error:c}=await T.from("notes").update(s).eq("id",e(m).id);c?(console.error("Error updating note:",c),L("Error updating: "+c.message,"Error")):(L("Note updated successfully!","Success"),l(g,!1),u())}else{const{error:c}=await T.from("notes").insert(s);c?(console.error("Error saving note:",c),L("Error saving: "+c.message,"Error")):(L("Note saved successfully!","Success"),l(g,!1),u())}}function F(r){return r?r.replace(/\n/g,"<br>"):""}var S=ut(),I=B(S);at(I,{get isOpen(){return e(g)},get entry(){return e(m)},onClose:()=>l(g,!1),onSave:ie});var A=n(I,2),j=a(A),K=n(a(j),2);{var P=r=>{var t=st();t.__click=R;var s=a(t);Xe(s,{class:"h-6 w-6"}),o(t),D(c=>ae(t,`background-color: ${c??""}`),[()=>ge.getAccentHex()]),b(r,t)};C(K,r=>{e(i)&&!e(g)&&!Qe.isOpen&&r(P)})}o(j);var U=n(j,2);{var W=r=>{var t=it(),s=a(t);Ze(s,{class:"h-6 w-6 animate-spin text-indigo-400"}),o(t),b(r,t)},X=r=>{var t=oe(),s=B(t);{var c=M=>{var Z=nt();b(M,Z)},ne=M=>{var Z=oe(),De=B(Z);{var Se=O=>{var $=lt();b(O,$)},Ae=O=>{var $=vt(),le=B($),me=n(a(le),2);fe(me,16,()=>["created","title"],be,(ce,x)=>{var w=ct();w.__click=()=>h(x);var N=a(w),G=a(N,!0);o(N);var de=n(N,2);{var ee=J=>{var V=oe(),Y=B(V);{var ve=z=>{$e(z,{class:"h-3 w-3"})},te=z=>{et(z,{class:"h-3 w-3"})};C(Y,z=>{e(v)==="asc"?z(ve):z(te,!1)})}b(J,V)};C(de,J=>{e(_)===x&&J(ee)})}o(w),D(()=>{Ue(w,1,`flex items-center gap-1 rounded-md px-3 py-1.5 transition-colors ${e(_)===x?"bg-indigo-500/20 text-indigo-300":"bg-zinc-800/50 text-zinc-400 hover:bg-zinc-800"}`),Q(G,x)}),b(ce,w)});var _e=n(me,2),je=a(_e);o(_e),o(le);var he=n(le,2);fe(he,21,()=>e(f),be,(ce,x)=>{var w=dt(),N=a(w),G=a(N),de=a(G,!0);o(G);var ee=n(G,2),J=a(ee);tt(J,()=>F(e(x).body)),o(ee),o(N);var V=n(N,2),Y=a(V),ve=a(Y,!0);o(Y);var te=n(Y,2),z=a(te);z.__click=()=>q(e(x));var Me=n(z,2);Me.__click=()=>se(e(x).id),o(te),o(V),o(w),D(Oe=>{ae(w,`background-color: ${(e(x).color||"#18181b")??""}`),Q(de,e(x).title),Q(ve,Oe)},[()=>new Date(e(x).created_at).toLocaleDateString()]),b(ce,w)}),o(he),D(()=>Q(je,`Amount of notes: ${e(E).length??""}`)),b(O,$)};C(De,O=>{e(E).length===0?O(Se):O(Ae,!1)},!0)}b(M,Z)};C(s,M=>{e(i)?M(ne,!1):M(c)},!0)}b(r,t)};C(U,r=>{e(p)&&e(i)!==null?r(W):r(X,!1)})}o(A),b(H,S),Ne()}Ce(["click"]);export{wt as component};
