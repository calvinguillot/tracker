import{c as se,a as l,f as c,t as he}from"../chunks/BqEl5C80.js";import{p as be,d as Ee,g as v,f as ne,a as ye,s as U,h as a,j as s,i as t,t as g,k as i,c as je,u as Me,o as Se,v as Oe}from"../chunks/DVg-wcBP.js";import{d as we,s as b}from"../chunks/Bj2CMk_O.js";import{i as f}from"../chunks/C66CeOwb.js";import{e as oe,i as le,h as ke,d as Te,f as G,a as Ae,b as Le,j as Be}from"../chunks/DZ1IOtyI.js";import{s as q}from"../chunks/Bkout0r_.js";import{E as Ne}from"../chunks/BUXqb3ZE.js";import{P as Pe,L as Ve}from"../chunks/CX2Dg3vE.js";var He=c('<div><h3 class="text-sm font-medium text-zinc-400">Weight</h3> <p class="text-lg text-zinc-100"> </p></div>'),Ue=c('<div class="rounded-lg border border-zinc-800 bg-zinc-800/50 p-3"><h3 class="mb-1 text-xs font-medium tracking-wider text-zinc-400 uppercase"> </h3> <p class="text-xl font-semibold text-indigo-400"> </p></div>'),qe=c('<span class="inline-flex items-center rounded-full border border-red-900/50 bg-red-900/30 px-2.5 py-0.5 text-xs font-medium text-red-400">Sickness</span>'),Ie=c('<span class="inline-flex items-center rounded-full border border-indigo-900/50 bg-indigo-900/30 px-2.5 py-0.5 text-xs font-medium text-indigo-400">Calvin Day</span>'),Ye=c('<span class="inline-flex items-center rounded-full border border-pink-900/50 bg-pink-900/30 px-2.5 py-0.5 text-xs font-medium text-pink-400">Ihana</span>'),Fe=c('<span class="inline-flex items-center rounded-full border border-green-900/50 bg-green-900/30 px-2.5 py-0.5 text-xs font-medium text-green-400">Call Family</span>'),Ke=c('<span class="inline-flex items-center rounded-full border border-blue-900/50 bg-blue-900/30 px-2.5 py-0.5 text-xs font-medium text-blue-400">Cry</span>'),We=c('<span class="inline-flex items-center rounded-full border border-red-900/50 bg-red-900/30 px-2.5 py-0.5 text-xs font-medium text-red-400">Sex</span>'),Ge=c('<div><h3 class="mb-1 text-sm font-medium text-zinc-400 capitalize"> </h3> <p class="rounded-md border border-zinc-800/50 bg-zinc-800/30 p-2 text-zinc-200"> </p></div>'),Je=c('<div class="border-t border-zinc-800 pt-4"><h3 class="mb-2 text-sm font-medium text-zinc-400">Notes</h3> <p class="rounded-lg border border-zinc-800/50 bg-zinc-800/30 p-4 whitespace-pre-wrap text-zinc-300"> </p></div>'),Qe=c('<div class="flex-1 lg:max-w-md"><div class="sticky top-24"><h3 class="mb-2 text-sm font-medium text-zinc-400">Daily Picture</h3> <div class="relative overflow-hidden rounded-lg border border-zinc-800 bg-zinc-950"><img alt="Daily entry" class="w-full object-contain"/></div></div></div>'),Re=c('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/70 p-2 backdrop-blur-sm md:p-4" role="dialog" aria-modal="true" tabindex="-1"><div class="flex max-h-[95vh] w-full max-w-6xl flex-col overflow-y-auto rounded-xl border border-zinc-800 bg-zinc-900 shadow-xl md:max-h-[90vh]"><div class="sticky top-0 z-10 flex items-center justify-between border-b border-zinc-800 bg-zinc-900 p-4 md:p-6"><h2 class="text-xl font-bold text-zinc-100">Entry Details</h2> <button class="text-zinc-400 transition-colors hover:text-zinc-200" aria-label="Close"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <div class="flex flex-col gap-6 p-4 md:p-6 lg:flex-row"><div class="flex-1 space-y-6"><div><h3 class="text-sm font-medium text-zinc-400">Date</h3> <p class="text-lg text-zinc-100"> </p></div> <!> <div class="grid grid-cols-2 gap-4 sm:grid-cols-3"></div> <div class="flex flex-wrap gap-2"><!> <!> <!> <!> <!> <!></div> <div class="grid grid-cols-1 gap-6 sm:grid-cols-2"></div> <!></div> <!></div></div></div>');function Xe(ue,n){be(n,!0);let O=U(null);Ee(()=>{n.isOpen&&n.entry?.image?w(n.entry.image):v(O,null)});async function w(h){const{data:y,error:J}=await q.storage.from("dailyPicture").createSignedUrl(h,3600);y&&v(O,y.signedUrl,!0)}function I(h){h.target===h.currentTarget&&n.onClose()}function k(h){h.key==="Escape"&&n.onClose()}var M=se(),T=ne(M);{var A=h=>{var y=Re();y.__click=I,y.__keydown=k;var J=a(y),Q=a(J),fe=s(a(Q),2);fe.__click=function(...e){n.onClose?.apply(this,e)},t(Q);var R=s(Q,2),L=a(R),B=a(L),de=s(a(B),2),xe=a(de,!0);t(de),t(B);var X=s(B,2);{var _e=e=>{var r=He(),u=s(a(r),2),m=a(u);t(u),t(r),g(()=>b(m,`${n.entry.weight??""} kg`)),l(e,r)};f(X,e=>{n.entry.weight&&e(_e)})}var Z=s(X,2);oe(Z,20,()=>["mood","energy","physical","sleep","meals"],le,(e,r)=>{var u=se(),m=ne(u);{var V=E=>{var j=Ue(),_=a(j),S=a(_,!0);t(_);var H=s(_,2),re=a(H,!0);t(H),t(j),g(()=>{b(S,r),b(re,n.entry[r])}),l(E,j)};f(m,E=>{n.entry[r]!==null&&n.entry[r]!==void 0&&E(V)})}l(e,u)}),t(Z);var Y=s(Z,2),ce=a(Y);{var o=e=>{var r=qe();l(e,r)};f(ce,e=>{n.entry.sickness&&e(o)})}var d=s(ce,2);{var x=e=>{var r=Ie();l(e,r)};f(d,e=>{n.entry.calvin_day&&e(x)})}var z=s(d,2);{var pe=e=>{var r=Ye();l(e,r)};f(z,e=>{n.entry.ihana&&e(pe)})}var C=s(z,2);{var N=e=>{var r=Fe();l(e,r)};f(C,e=>{n.entry.call_family&&e(N)})}var $=s(C,2);{var ee=e=>{var r=Ke();l(e,r)};f($,e=>{n.entry.cry&&e(ee)})}var ve=s($,2);{var me=e=>{var r=We();l(e,r)};f(ve,e=>{n.entry.sex&&e(me)})}t(Y);var F=s(Y,2);oe(F,20,()=>["work_type","study_type","culture_type","art_type","music_type","exercise_type","leisure_type"],le,(e,r)=>{var u=se(),m=ne(u);{var V=E=>{var j=Ge(),_=a(j),S=a(_,!0);t(_);var H=s(_,2),re=a(H,!0);t(H),t(j),g(ge=>{b(S,ge),b(re,n.entry[r])},[()=>r.replace("_type","")]),l(E,j)};f(m,E=>{n.entry[r]&&E(V)})}l(e,u)}),t(F);var te=s(F,2);{var p=e=>{var r=Je(),u=s(a(r),2),m=a(u,!0);t(u),t(r),g(()=>b(m,n.entry.notes)),l(e,r)};f(te,e=>{n.entry.notes&&e(p)})}t(L);var D=s(L,2);{var P=e=>{var r=Qe(),u=a(r),m=s(a(u),2),V=a(m);t(m),t(u),t(r),g(()=>ke(V,"src",i(O))),l(e,r)};f(D,e=>{i(O)&&e(P)})}t(R),t(J),t(y),g(()=>b(xe,n.entry.created_at)),l(h,y)};f(T,h=>{n.isOpen&&n.entry&&h(A)})}l(ue,M),ye()}we(["click","keydown"]);var Ze=c('<button class="fixed right-8 bottom-8 z-50 rounded-full p-4 text-white shadow-lg transition-all hover:scale-105 hover:brightness-110" aria-label="New Entry"><!></button>'),$e=c('<div class="flex h-64 items-center justify-center"><!></div>'),et=c('<th class="hidden px-6 py-3 text-left text-xs font-medium tracking-wider text-zinc-400 uppercase md:table-cell"> </th>'),tt=c('<td class="hidden max-w-xs truncate px-6 py-4 text-sm whitespace-nowrap text-zinc-400 md:table-cell"><!></td>'),rt=c('<tr class="transition-colors hover:bg-zinc-800/50"><td class="sticky left-0 z-10 bg-zinc-900 px-6 py-4 font-medium whitespace-nowrap text-zinc-200"> </td><td class="sticky left-[100px] z-10 space-x-2 border-r border-zinc-800 bg-zinc-900 px-6 py-4 whitespace-nowrap shadow-[4px_0_8px_-4px_rgba(0,0,0,0.3)]"><button class="text-zinc-400 transition-colors hover:text-zinc-200" aria-label="View Details"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path></svg></button> <button class="text-indigo-400 transition-colors hover:text-indigo-300" aria-label="Edit"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg></button> <button class="text-red-400 transition-colors hover:text-red-300" aria-label="Delete"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg></button></td><!></tr>'),at=c('<div class="overflow-x-auto rounded-lg border border-zinc-800 shadow"><table class="min-w-full divide-y divide-zinc-800"><thead class="bg-zinc-800"><tr><th class="sticky left-0 z-10 bg-zinc-800 px-6 py-3 text-left text-xs font-medium tracking-wider text-zinc-400 uppercase">Date</th><th class="sticky left-[100px] z-10 bg-zinc-800 px-6 py-3 text-left text-xs font-medium tracking-wider text-zinc-400 uppercase">Actions</th><!></tr></thead><tbody class="divide-y divide-zinc-800 bg-zinc-900"></tbody></table></div>'),it=c('<p class="text-center text-zinc-500">Please sign in to view tracking data.</p>'),st=c('<div><div class="mb-6 flex items-center justify-between"><h2 class="text-lg font-bold text-zinc-100">Daily</h2> <!></div> <!> <!> <!></div>');function xt(ue,n){be(n,!0);let O=U(je(Me(()=>n.data.dailyTracking))),w=U(!1),I=U(!1),k=U(null),M=U(null),T=U(!0);Se(()=>{q.auth.getSession().then(({data:{session:d}})=>{v(M,d,!0),d?A():v(T,!1)});const{data:{subscription:o}}=q.auth.onAuthStateChange((d,x)=>{v(M,x,!0),x?A():v(T,!1)});return()=>o.unsubscribe()});async function A(){v(T,!0);const{data:o,error:d}=await q.from("dailyTracking").select().order("created_at",{ascending:!1});!d&&o&&v(O,o,!0),v(T,!1)}function h(){v(k,null),v(w,!0)}function y(o){v(k,o,!0),v(w,!0)}function J(o){v(k,o,!0),v(I,!0)}async function Q(o){if(!await Be("Are you sure you want to delete this entry?","Delete Entry",{confirmText:"Delete",isDestructive:!0}))return;const{error:x}=await q.from("dailyTracking").delete().eq("id",o);x?G(x.message,"Error"):(G("Entry deleted successfully","Success"),A())}async function fe(o){if(i(k)){const{id:d,...x}=o,{error:z}=await q.from("dailyTracking").update(x).eq("id",i(k).id);z?G(z.message,"Error"):(G("Entry updated successfully","Success"),v(w,!1),A())}else{const{error:d}=await q.from("dailyTracking").insert(o);d?G(d.message,"Error"):(G("Entry created successfully","Success"),v(w,!1),A())}}const R=["mood","energy","physical","sleep","meals","weight","sickness","work_type","study_type","culture_type","art_type","music_type","exercise_type","leisure_type","calvin_day","ihana","call_family","cry","sex","notes","image"];var L=st(),B=a(L),de=s(a(B),2);{var xe=o=>{var d=Ze();d.__click=h;var x=a(d);Pe(x,{class:"h-6 w-6"}),t(d),g(z=>Le(d,`background-color: ${z??""}`),[()=>Ae.getAccentHex()]),l(o,d)};f(de,o=>{i(M)&&!i(w)&&!i(I)&&!Te.isOpen&&o(xe)})}t(B);var X=s(B,2);{var _e=o=>{var d=$e(),x=a(d);Ve(x,{class:"h-8 w-8 animate-spin text-indigo-500"}),t(d),l(o,d)},Z=o=>{var d=se(),x=ne(d);{var z=C=>{var N=at(),$=a(N),ee=a($),ve=a(ee),me=s(a(ve),2);oe(me,17,()=>R,le,(te,p)=>{var D=et(),P=a(D,!0);t(D),g(e=>b(P,e),[()=>i(p).replace("_"," ")]),l(te,D)}),t(ve),t(ee);var F=s(ee);oe(F,21,()=>i(O),le,(te,p)=>{var D=rt(),P=a(D),e=a(P,!0);t(P);var r=s(P),u=a(r);u.__click=()=>J(i(p));var m=s(u,2);m.__click=()=>y(i(p));var V=s(m,2);V.__click=()=>Q(i(p).id),t(r);var E=s(r);oe(E,17,()=>R,le,(j,_)=>{var S=tt(),H=a(S);{var re=K=>{var ae=he();g(()=>b(ae,i(p)[i(_)]?"Yes":"No")),l(K,ae)},ge=K=>{var ae=se(),ze=ne(ae);{var Ce=W=>{var ie=he();g(()=>b(ie,i(p)[i(_)]?"Yes":"No")),l(W,ie)},De=W=>{var ie=he();g(()=>b(ie,i(p)[i(_)]??"-")),l(W,ie)};f(ze,W=>{i(_)==="image"?W(Ce):W(De,!1)},!0)}l(K,ae)};f(H,K=>{typeof i(p)[i(_)]=="boolean"?K(re):K(ge,!1)})}t(S),g(()=>ke(S,"title",i(p)[i(_)])),l(j,S)}),t(D),g(()=>b(e,i(p).created_at)),l(te,D)}),t(F),t($),t(N),l(C,N)},pe=C=>{var N=it();l(C,N)};f(x,C=>{i(M)?C(z):C(pe,!1)},!0)}l(o,d)};f(X,o=>{i(T)?o(_e):o(Z,!1)})}var Y=s(X,2);{let o=Oe(()=>i(M)?.user?.id);Ne(Y,{get isOpen(){return i(w)},get entry(){return i(k)},get userId(){return i(o)},onClose:()=>v(w,!1),onSave:fe})}var ce=s(Y,2);Xe(ce,{get isOpen(){return i(I)},get entry(){return i(k)},onClose:()=>v(I,!1)}),t(L),l(ue,L),ye()}we(["click"]);export{xt as component};
